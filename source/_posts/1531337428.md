---
layout: post
title: "QT 绘制波形图、频谱图、瀑布图、星座图、眼图、语图"
date: "2023-05-29T01:09:49.535Z"
---
QT 绘制波形图、频谱图、瀑布图、星座图、眼图、语图
==========================

最近在学中频信号处理的一些东西，顺便用 QT 写了一个小工具，可以显示信号的时域波形图、幅度谱、功率谱、二次方谱、四次方谱、八次方谱、瞬时包络、瞬时频率、瞬时相位、非线性瞬时相位、瞬时幅度直方图、瞬时频率直方图、瞬时相位直方图、眼图、星座图、语谱图、瀑布图。

说明
--

最近在学中频信号处理的一些东西，顺便用 QT 写了一个小工具，可以显示信号的时域波形图、幅度谱、功率谱、二次方谱、四次方谱、八次方谱、瞬时包络、瞬时频率、瞬时相位、非线性瞬时相位、瞬时幅度直方图、瞬时频率直方图、瞬时相位直方图、眼图、星座图、语谱图、瀑布图。

目录

*   [说明](#说明)
*   [1\. 实现思路](#1-实现思路)
*   [2\. 时域波形图](#2-时域波形图)
*   [3\. 幅度谱](#3-幅度谱)
*   [4\. 功率谱](#4-功率谱)
*   [5\. 二次方谱](#5-二次方谱)
*   [6\. 四次方谱](#6-四次方谱)
*   [7\. 八次方谱](#7-八次方谱)
*   [8\. 瞬时包络](#8-瞬时包络)
*   [9\. 瞬时频率](#9-瞬时频率)
*   [10\. 瞬时相位](#10-瞬时相位)
*   [11\. 非线性瞬时相位](#11-非线性瞬时相位)
*   [12\. 瞬时幅度直方图](#12-瞬时幅度直方图)
*   [13\. 瞬时频率直方图](#13-瞬时频率直方图)
*   [14\. 瞬时相位直方图](#14-瞬时相位直方图)
*   [15\. 眼图](#15-眼图)
*   [16\. 星座图](#16-星座图)
*   [17\. 语谱图](#17-语谱图)
*   [18\. 瀑布图](#18-瀑布图)

  

1\. 实现思路
--------

工具为纯 C++ 开发，包括频谱计算以及图像可视化。这里简述下实现思路，使用到了以下第三方库：

*   [QCustomPlot 绘图库](https://www.qcustomplot.com/)。
*   [FFTW 傅氏变换库](http://www.fftw.org/)。
*   [FreeGlut 工具包](https://freeglut.sourceforge.net/index.php)。

频谱计算部分，通过调用 FFTW 的 C++ 接口，同时开启 OpenMP 多核支持，可以获得很快的计算速度，比 MATLAB 还快，工具中的**所有频谱都是在点击按钮时现算的**。在我的电脑上（8 核 Intel i7-6700HQ CPU @ 2.60GHz），实测对 33554432 长度（2 的 25 次方）的双精度浮点数组进行傅里叶变换，两种方式的耗时如下：

*   MATLAB 的 `fft` 函数耗时 629 毫秒。
*   C++ 调用 FFTW 接口并开启 OpenMP 多核支持，耗时 390 毫秒。

图像可视化部分，使用 QCustomPlot 完成图像绘制，并结合 FreeGlut 工具开启 OpenGL 支持，绘图质量及响应速度也得到了较好的提升，大数据显示并进行交互时不会出现卡顿。为了进一步提升速度，还修改了 QCustomPlot 的部分源码，将数据更新接口暴露出来，使用 `memcpy()` 直接对原始绘图数据所在的内存块进行操作，提升数据更新的速度。主界面如下：

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img-blog-young.oss-cn-qingdao.aliyuncs.com/img/202305281519231.png!cnblogs_watermark)

  

2\. 时域波形图
---------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。波形显示时做了贝塞尔平滑处理。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183051457-197744483.gif)

  

3\. 幅度谱
-------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183208953-731332126.gif)

  

4\. 功率谱
-------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183235332-407605155.gif)

  

5\. 二次方谱
--------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183653620-1041581970.gif)

  

6\. 四次方谱
--------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183706511-1244626651.gif)

  

7\. 八次方谱
--------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183719596-802467299.gif)

  

8\. 瞬时包络
--------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183736382-1274607234.gif)

  

9\. 瞬时频率
--------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183754286-541281933.gif)

  

10\. 瞬时相位
---------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183811644-1316712704.gif)

  

11\. 非线性瞬时相位
------------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183823880-245210102.gif)

  

12\. 瞬时幅度直方图
------------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183836950-1347823258.gif)

  

13\. 瞬时频率直方图
------------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183851421-1759137775.gif)

  

14\. 瞬时相位直方图
------------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183907702-2107375946.gif)

  

15\. 眼图
-------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，基带信号，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183920978-1144474207.gif)

  

16\. 星座图
--------

测试信号：8PSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，载波频率 71104 Hz，文件大小 64 MB。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183934680-179745395.gif)

  

17\. 语谱图
--------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。从计算到显示总耗时不超过 1 秒。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528183948253-1767668141.gif)

  

18\. 瀑布图
--------

测试信号：2FSK 调制，调制速率 8888 Baud/s，采样率 284416 Hz，信号频率 62216 Hz 与 79992Hz，文件大小 64 MB。谱线为实时计算。由于 GIF 上传大小限制为 5 MB，录制为 GIF 时做了质量损失。

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528184006041-1994942870.gif)

![Oh Shit!-图片走丢了-打个广告-欢迎来博客园关注“木三百川”](https://img2023.cnblogs.com/blog/2893515/202305/2893515-20230528184027084-68143146.gif)

**本文作者：**[木三百川](https://www.cnblogs.com/young520/)

**本文链接：**[https://www.cnblogs.com/young520/p/17438635.html](https://www.cnblogs.com/young520/p/17438635.html)

**版权声明：**本文系博主原创文章，著作权归作者所有。商业转载请联系作者获得授权，非商业转载请附上出处链接。遵循 [署名-非商业性使用-相同方式共享 4.0 国际版 (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-nd/4.0/ "BY-NC-SA") 版权协议。