---
layout: post
title: "指针与引用"
date: "2023-05-28T01:16:48.839Z"
---
指针与引用
=====

指针与引用
=====

本文讲解编程语言中指针(Pointer)与引用(Reference)的概念, 并且对比了常见语言中这两个概念的区别.

C++
---

指针和引用在C++中是非常重要的概念, 初学者很容易在指针和引用的概念上混淆(因为这两者太像了).

如何理解两者的本质:

*   **指针的本质**: 存储地址的变量(实体)
*   **引用的本质**: 变量的别名

_但在汇编层面指针和引用是一样的,只是编译器对两者做了区分,引用可以看作是更加安全的指针,进行了许多限制,**大部分情况应该优先使用引用**。_

下面列个表格,对比这两者的区别

*   &的二义性: 既是引用的定义, 也是取地址符

指针 ( \*a=&v;)

引用 ( &a=v;)

可以多级 (type \*\*a)

√

×

可以不用初始化

√

×

可以指向 NULL

√

×

可以改变

√

×

有自己独立的地址

√

×

sizeof(a)

len( \*)

len()

自增运算

地址++

变量值++

成员访问

\->

.

const（右）

\* const (指针不可变)

& const (未定义)

const（左）

const \* (指向对象不可变)

const & (引用对象不可变)

*   指针的引用 ( \*&r = p;)
*   引用的指针 ( \*p = &r;)

**使用场景**

> 优先使用引用，必要时用指针
> 
> *   指针的操作权限更多, 容易带来危险操作

**指针的使用场景**

*   实现链表或者树之类的数据结构
*   传递函数参数 (避免copy引起的开销)

**引用的使用场景**

*   传递函数参数 (避免copy引起的开销, 且不需要检查引用是否为NULL)

此外还有函数指针,这里不谈了 (C++的内容实在是繁杂)

Go
--

Golang中也有指针类型, 但没有引用.

而且Go的指针也与C++中的指针有很多不同之处:

*   指针值不支持数学运算 (避免指针对内存的任意操作)
*   不同类型的指针无法直接赋值
*   局部变量的指针可以被"安全"的返回

这里需要介绍一些关于Go中的函数参数传递的知识.

*   Go中只有值传递 (指针类型一样)
    
*   如果需要在函数中修改参数值, 可以使用指针
    
*   引用类型变量存储的是地址, 因此可以在参数中修改原值
    
    > Go的变量包括值类型和引用类型, 引用类型只有slice, channel 和 map 三种, 引用类型的特点是变量存储的是地址, 因此传引用类型到函数中修改会影响原值.
    

Python
------

Python没有引用, 也没有显式的指针, 只有对象引用, 这和其内存管理方式密切相关.

Python是通过"引用计数"自动管理内存的, 程序中的每个对象的引用个数都会被记录, 当引用个数为0时会被垃圾回收机制回收, 既不需要分配, 也不用担心回收.

Python中一切皆对象, 对象是一个三元组 (Id, Type, Value), 变量和对象之间的关系为引用, 变量更像是指针.

Python的对象类型分为可变(mutable)和不可变(immutable). 可变类型包括 list, dict, set, bytearray, user-defined classes, 这些类型在函数内部修改会影响原值.

这里又会引出浅拷贝和深拷贝的区别. 浅拷贝只复制了对象的引用, 本质共享同一个对象; 深拷贝则是创建了对象的副本, 修改不会影响原值.

Java
----

Java的数据类型分为基本类型(byte, short, int, long, double, float, char, boolean)和引用类型.

Java中没有指针, 但引用本质上就是"指针", Java引用存储实际就是对象的地址, 引用存储在栈区, 而对象存储在堆区. 区别在于Java引用对指针进行了封装, 使其无法直接操作内存.

Java引用和C++引用存在区别, Java引用有自己的内存 (和C++指针比较像), 存储地址, 而C++引用只是别名.

参考
--

[C++中指针与引用的区别 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/140966943)

[C++中，引用和指针的区别是什么？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/37608201/answer/1601079930)

[C++中“引用”的底层实现 - hoodlum1980 - 博客园 (cnblogs.com)](https://www.cnblogs.com/hoodlum1980/archive/2012/06/19/2554270.html)

[Go 语言没有引用类型，指针也与众不同 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/400246499)

[go 值类型与引用类型\_欧阳惜竹的博客-CSDN博客](https://blog.csdn.net/qq_37886086/article/details/115326358)

[Python学习系列之值类型与引用类型\_answer3lin的博客-CSDN博客](https://blog.csdn.net/answer3lin/article/details/86430074)

[Java真的没有“指针”吗？ - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/131612029)