---
layout: post
title: "windows CMDå‘½ä»¤çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹"
date: "2023-07-22T01:11:58.969Z"
---
windows CMDå‘½ä»¤çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹
=========================

windows CMDå‘½ä»¤çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•åŠæ³¨æ„äº‹é¡¹
-------------------------

è½¬è½½è¯·è‘—åå‡ºå¤„:[https://www.cnblogs.com/funnyzpc/p/17572397.html](https://www.cnblogs.com/funnyzpc/p/17572397.html)

### ä¸€.æ‰§è¡Œè·¯å¾„æˆ–å‚æ•°å¸¦ä¸­æ–‡ã€ç©ºæ ¼ã€ç‰¹æ®Šå­—ç¬¦ã€æ•°å­—é—®é¢˜

é¦–å…ˆè¯´ä¸è®ºæ˜¯æ‰§è¡Œè·¯å¾„è¿˜æ˜¯è„šæœ¬å‚æ•°å‡ä¸èƒ½åŒ…å«æˆ–ä½¿ç”¨è¿™å››ç±»å­—ç¬¦\[`ä¸­æ–‡`ã€`ç©ºæ ¼`ã€`ç‰¹æ®Šå­—ç¬¦`ã€`æ•°å­—`\]

**æ‰§è¡Œè·¯å¾„è¿˜æ˜¯å˜é‡æ˜¯ä¸€å®šä¸å¯ä»¥ä»¥æ•°å­—å¼€å¤´çš„,å˜é‡ä¹Ÿä¸å»ºè®®ä½¿ç”¨çº¯æ•°å­—**,ä¾‹å¦‚:  
åœ¨cmdçª—å£å®šä¹‰å¹¶æ‰§è¡Œ:

    E:\self\mee_full\blogs\bin\tmp>set 234=hello
    E:\self\mee_full\blogs\bin\tmp>call echo %234%
    hello
    

çœ‹èµ·æ¥æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å°†å‘½ä»¤å†™åœ¨cmdæ–‡ä»¶å†…çœ‹ä¸€ä¸‹ï¼š

*   å®šä¹‰`exec.cmd`æ–‡ä»¶å†…å®¹

    set 234=hello
    call echo %234%
    

*   æ‰§è¡Œ`exec.cmd`

    E:\self\mee_full\blogs\bin\tmp>exec.cmd
    E:\self\mee_full\blogs\bin\tmp>set 234=hello
    E:\self\mee_full\blogs\bin\tmp>call echo 34
    34
    
    

å¯çœ‹åˆ°è¾“å‡ºçš„æ˜¯`34`,è¿™æ˜æ˜¾æ˜¯é”™è¯¯çš„,è¿™ç§æƒ…å†µä¸€å®šè¦å…·ä½“å®è·µæ‰ä¼šæ˜ç™½ï¼Œä¸€å®šè¦ç•™æ„~

**å¦‚æœè·¯å¾„ä¸­å‡ºç°ç©ºæ ¼æˆ–è€…ä¸­æ–‡ä¸€å®šå»ºè®®æ‚¨ç”¨åŒå¼•å·(è‹±æ–‡è¾“å…¥æ³•ä¸‹çš„)åŒ…èµ·æ¥** : **/ç›®å½•1/ç›®å½•2/å‘½ä»¤**

*   å¦‚ä¸‹ä¾‹:

     
    E:\self\mee_full\blogs\bin\å“ˆäº†\tmp>E:\self\mee_full\blogs\bin\tmp\zip -r ../qq.zip ./files
    'E:\self\mee_full\blogs\bin\å“ˆäº†' ä¸æ˜¯å†…éƒ¨æˆ–å¤–éƒ¨å‘½ä»¤ï¼Œä¹Ÿä¸æ˜¯å¯è¿è¡Œçš„ç¨‹åº
    æˆ–æ‰¹å¤„ç†æ–‡ä»¶ã€‚
    
    E:\self\mee_full\blogs\bin\tmp>
    

**ä½¿ç”¨åŒå¼•å·åŒ…èµ·æ¥å°±æ²¡é—®é¢˜äº†ï¼š**

    E:\self\mee_full\blogs\bin\å“ˆäº†\tmp>
    E:\self\mee_full\blogs\bin\å“ˆäº†\tmp>"E:\self\mee_full\blogs\bin\tmp\zip" -r ../qq.zip ./files
    updating: files/DateUtil.java (172 bytes security) (deflated 70%)
    updating: files/DelayTask.java (172 bytes security) (deflated 48%)
    updating: files/excel/ (260 bytes security) (stored 0%)
    updating: files/excel/CellBaseType.java (172 bytes security) (deflated 64%)
    updating: files/excel/CellFmt.java (172 bytes security) (deflated 67%)
    updating: files/excel/ExcelDataReflectUtil.java (172 bytes security) (deflated 73%)
    updating: files/excel/ExcelReadUtil.java (172 bytes security) (deflated 85%)
    updating: files/excel/ExcelWriteUtil.java (172 bytes security) (deflated 81%)
    updating: files/excel/PoiCellProcess.java (172 bytes security) (deflated 84%)
    updating: files/excel/PoiCellStyleProcess.java (172 bytes security) (deflated 74%)
    
    

### äºŒ.è„šæœ¬æ–‡ä»¶å‘½ä»¤è¿ç»­æ‰§è¡Œæ¢è¡Œé—®é¢˜

è¿ç»­æ‰§è¡Œé—®é¢˜ä¹‹å‰ä¹Ÿä¸€ç›´å›°æ‰°ç€æˆ‘ï¼Œåæ¥ä¸æ–­å®è·µå€’æœ‰äº†äº›å¿ƒå¾—~

åƒ `if exist` è¿™ç±»å¼€å¤´çš„åˆ¤æ–­å‘½ä»¤åˆ™ä¸å­˜åœ¨å¤šæ¡å‘½ä»¤è¿ç»­æ‰§è¡Œæ¢è¡Œåœæ­¢é—®é¢˜.

å¯¹äºåƒ`echo`ã€`dir`ã€`zip`ã€`mvn`ã€`java`ç­‰ç­‰è¿™ç±»å‘½ä»¤,å»ºè®®å‘½ä»¤å‰åŠ ä¸€ä¸ª`call`å³å¯~

example:

    E:\self\mee_full\blogs\bin\tmp>
    E:\self\mee_full\blogs\bin\tmp>call echo hello
    hello
    
    E:\self\mee_full\blogs\bin\tmp>call dir
    é©±åŠ¨å™¨ E ä¸­çš„å·æ˜¯ DATA
    å·çš„åºåˆ—å·æ˜¯ DA15-004D
    
    E:\self\mee_full\blogs\bin\tmp çš„ç›®å½•
    
    2023/07/20  14:47    <DIR>          .
    2023/07/20  14:47    <DIR>          ..
    2018/12/01  23:15            69,120 bzip2.dll
    2023/07/20  14:48                34 exec.cmd
    2023/07/20  11:07    <DIR>          files
    2018/12/01  23:15           237,056 zip.exe
                  3 ä¸ªæ–‡ä»¶        306,210 å­—èŠ‚
                  3 ä¸ªç›®å½• 925,669,171,200 å¯ç”¨å­—èŠ‚
    
    

å°¤å…¶æ˜¯å‘½ä»¤æ”¾åœ¨`cmd`æˆ–`bat`æ–‡ä»¶å†…æ—¶ä¸€å®šè¦ä½¿ç”¨`call`

### ä¸‰.å˜é‡å®šä¹‰åŠå¼•ç”¨é—®é¢˜

å˜é‡è¢«å¼•ç”¨çš„å‰ææ˜¯ä¸€å®šè¦è¢«å®šä¹‰ï¼Œä¸è®ºæ˜¯æ¥è‡ªäºå‘½ä»¤è¡Œè¿˜æ˜¯æ¥è‡ªäº`set`å‘½ä»¤å®šä¹‰çš„ï¼Œéƒ½éœ€è¦æœ‰!

é¦–å…ˆè¯´å¦‚ä½•å®šä¹‰å§~

**1.åœ¨æ‰§è¡Œè„šæœ¬æ–‡ä»¶å‘½ä»¤è¡Œå®šä¹‰**

æ¯”å¦‚è¿™æ ·

    E:\self\mee_full\blogs\bin\tmp>exec.cmd aa bb cc
    E:\self\mee_full\blogs\bin\tmp>exec.bat aa bb cc
    

åœ¨`exec`è„šæœ¬æ–‡ä»¶å†…æ¥æ”¶è¿™ä¸‰ä¸ªå‚æ•°(`aa`,`bb`,`cc`)éœ€ä½¿ç”¨å‚æ•°ç´¢å¼•è·å¾—:

    set VALUE1=%1% // aa
    set VALUE2=%2% // bb
    set VALUE3=%3% // cc
    

ä¸Šé¢æ˜¯å®šä¹‰äº†æ¥æ”¶å˜é‡çš„ï¼Œå®é™…ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æ¥æ”¶å˜é‡~

**2.åœ¨cmdæ‰§è¡Œå‘½ä»¤è¡Œ(è£¸å‘½ä»¤)æˆ–è„šæœ¬æ–‡ä»¶å†…**

å£°æ˜: `set aa=hello`

ä½¿ç”¨: `echo %aa%` or `call echo %aa%`

example:

    E:\self\mee_full\blogs\bin\tmp>set aa=hello
    E:\self\mee_full\blogs\bin\tmp>echo %aa%
    hello
    
    

æ³¨æ„:å®šä¹‰çš„å˜é‡åå¼ºçƒˆå»ºè®®ä½¿ç”¨å¤§å†™ï¼Œä½¿ç”¨æ—¶æ›´æ˜“åˆ†è¾¨!

### å››.æ‰¹é‡å‹ç¼©æ–‡ä»¶é—®é¢˜

windowså¹¶æœªå†…ç½®`zip`ç›¸å…³å‘½ä»¤å·¥å…·ï¼Œä¸è®ºæ˜¯`cmd`è¿˜æ˜¯`powershell`éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥è¿™å°±éœ€è¦æˆ‘ä»¬è‡ªè¡Œå®‰è£…zipç›¸å…³å·¥å…·ã€‚  
windowsä¸‹å¯ä»¥å®ç°zipç›¸å…³åŠŸèƒ½çš„å·¥å…·å¤§æ¦‚æœ‰è¿™ä¿©ï¼Œè¿™æ˜¯æˆ‘ç”¨åˆ°è¿‡çš„ï¼š

1.**ä½¿ç”¨`7z`**

è¿™ä¸ªå·¥å…·ååˆ†å¥½ç”¨ï¼Œæ—¢å¯ä»¥GUIæ“ä½œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ“ä½œ,ä½¿ç”¨å‘½ä»¤è¡Œåˆ™ä¸ºï¼š

    %---- è‹¥ 7z.exe å®‰è£…åœ¨è¿™ä¸ªåœ°æ–¹ ---%
    C:\Program Files\7-Zip\7z.exe
    
    %---- åˆ™å…·ä½“æ‰§è¡Œå‘½ä»¤ ---%
    "C:\Program Files\7-Zip\7z"  a å‹ç¼©åçš„æ–‡ä»¶.zip æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶
    

`7z`è¯·è‡ªè¡Œæœç´ ä¸‹è½½,è¿™é‡Œä¸æä¾›å“ˆ~

2.**ä½¿ç”¨`bzip2`**

è¿™æ˜¯ä¸ªå‘½ä»¤è¡Œç”¨çš„`bzip2`å·¥å…·ã€‚  
å…·ä½“ä½¿ç”¨å¦‚ä¸‹:

    %----è‹¥ 7z.exe å®‰è£…åœ¨è¿™ä¸ªåœ°æ–¹ ---%
    D:\zips\zip.exe
    
     %---- æ‰§è¡Œçš„å‘½ä»¤ ---%
     D:\zips\zip -r å‹ç¼©åçš„æ–‡ä»¶.zip æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶
    

`bzip2`å·¥å…·åœ¨[autoDeploy](https://github.com/funnyzpc/autoDeploy)å†…æœ‰æä¾›ï¼Œä¹Ÿå¯ä»¥å»[bzipå®˜ç½‘](http://www.bzip.org)ä¸‹è½½

### äº”.å‘½ä»¤æ¢è¡Œé—®é¢˜

è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆç®€å•ï¼Œå‘½ä»¤è¡Œå°¾ç”¨ `^` å°±å¥½

exampleï¼š

    call  å‘½ä»¤ç¬¬ä¸€éƒ¨åˆ† ^
      å‘½ä»¤ç¬¬äºŒéƒ¨åˆ†
    

### å…­.å¿½ç•¥æ‰§è¡ŒåŠå¤šæ¡å‘½ä»¤æ‰§è¡Œé—®é¢˜

å¤šæ¡å‘½ä»¤ä¸€èˆ¬ç”¨è¿™ä¸‰ç±»æ“ä½œç¬¦åˆ†å‰² **`&` `&&` `||`**

*   **`&`** æ“ä½œç¬¦
    
    `å‘½ä»¤1 & å‘½ä»¤2`
    

å…ˆæ‰§è¡Œ`å‘½ä»¤1`å†æ‰§è¡Œ`å‘½ä»¤2`ï¼Œ`å‘½ä»¤1`ä¸è®ºæ‰§è¡ŒæˆåŠŸä¸å¦éƒ½ä¼šæ‰§è¡Œ`å‘½ä»¤2`,è¿™æ ·å°±èµ·åˆ°äº†å¿½ç•¥é”™è¯¯å‘½ä»¤è¡Œ

*   **`&&`** æ“ä½œç¬¦
    
    `å‘½ä»¤1 && å‘½ä»¤2`
    

å…ˆæ‰§è¡Œ`å‘½ä»¤1`å†æ‰§è¡Œ`å‘½ä»¤2`ï¼Œ`å‘½ä»¤1`æ‰§è¡ŒæˆåŠŸæ‰ä¼šæ‰§è¡Œ`å‘½ä»¤2`,å‘½ä»¤æœ‰å‰åä¾èµ–ä¼šç”¨åˆ°æ­¤æ“ä½œç¬¦

example:

    xcopy hello.txt D:\  /s /e /y && (echo ok ) || (echo error)
    

å› ä¸ºæœ‰çš„å‘½ä»¤ä¼šè¿”å›æ“ä½œçŠ¶æ€(æˆåŠŸ/å¤±è´¥),`&&`ä¹Ÿå¯æ¥æ”¶è¿™ä¸€çŠ¶æ€å¹¶åˆ¤æ–­

*   **`|`** æ“ä½œç¬¦
    
    `å‘½ä»¤1 | å‘½ä»¤2`
    

ç®¡é“æ“ä½œç¬¦,`å‘½ä»¤1`æ˜¯`å‘½ä»¤2`çš„æ“ä½œå¯¹è±¡,ä¾‹å¦‚:

    E:\self\mee_full\blogs\tmp\files>echo hello youth | findstr "y"
    hello youth
    

*   **`||`** æ“ä½œç¬¦
    
    `å‘½ä»¤1 || å‘½ä»¤2`
    

å°±æ˜¯`å‘½ä»¤1`å‡ºé”™ã€è¿è¡Œä¸æˆåŠŸæ‰æ‰§è¡Œ`å‘½ä»¤2`

### \*å•æ¡æ‰¹é‡æ‰§è¡Œè„šæœ¬æ ·ä¾‹

    @echo off
    
    %chcp 65001%
    
    %-----å¿…è¦å‚æ•°(éœ€è¦å¡«çš„!)-----%
    %é¡¹ç›®ç›®å½•%
    set PROJECT_DIR=D:\workspace\mee-web
    %å·¥å…·7zå®‰è£…ç›®å½•%
    set ZIP_EXEC_PATH="C:\Program Files\7-Zip\7z"
    %å‹ç¼©æ–‡ä»¶åŒ…åç§°%
    set FILE_NAME=mee-web.zip
    
    %æœåŠ¡å™¨IP%
    set SSH_IP=192.168.76.60
    %æœåŠ¡å™¨ç«¯å£%
    set SSH_PORT=22
    %æœåŠ¡å™¨ç™»å½•ç”¨æˆ·%
    set SSH_USER=root
    %æœåŠ¡å™¨ç™»å½•å¯†ç %
    set SSH_PASSWORD=root@1233
    %æœåŠ¡å™¨å·¥ä½œç›®å½•%
    set SSH_DIR=/home/nginx/tmp
    %å…¶ä»–å˜é‡(ä¸ç”¨åŠ¨),è¾“å‡ºå½“å‰è·¯å¾„% 
    set BAT_PATH=%cd%
    
    %-----æ‰“åŒ…&æ„å»º-----%
    call cd %PROJECT_DIR% ^
        & rd/s/q dist ^
        & del /a/f/q %FILE_NAME% ^
        & npm run build:uat --scripts-prepend-node-path=auto ^
        && %ZIP_EXEC_PATH%  a %FILE_NAME% ./dist/** ^
        && echo upload file to server... ^
        && cd %BAT_PATH% ^
        && %BAT_PATH%\bin\pscp  -P %SSH_PORT% -pw %SSH_PASSWORD% %PROJECT_DIR%\%FILE_NAME% %SSH_USER%@%SSH_IP%:%SSH_DIR% ^
        && echo invoke server command... ^
        && %BAT_PATH%\bin\plink -pw %SSH_PASSWORD% -P %SSH_PORT%  %SSH_USER%@%SSH_IP% "cd %SSH_DIR% && unzip -o %FILE_NAME% && rm -rf %FILE_NAME%" ^
        && echo success! ^
        && pause
    
    

### \*å•è¡Œæ‰§è¡Œè„šæœ¬æ ·ä¾‹

    @echo off
    
    %chcp 65001%
    
    %-----å¿…è¦å‚æ•°(éœ€è¦å¡«çš„!)-----%
    %é¡¹ç›®ç›®å½•%
    set PROJECT_DIR=D:\workspace\mee-web
    %å·¥å…·7zå®‰è£…ç›®å½•%
    set ZIP_EXEC_PATH="C:\Program Files\7-Zip\7z"
    %å‹ç¼©æ–‡ä»¶åŒ…åç§°%
    set FILE_NAME=mee-web.zip
    
    %æœåŠ¡å™¨IP%
    set SSH_IP=192.168.10.1
    %æœåŠ¡å™¨ç«¯å£%
    set SSH_PORT=22
    %æœåŠ¡å™¨ç™»å½•ç”¨æˆ·%
    set SSH_USER=root
    %æœåŠ¡å™¨ç™»å½•å¯†ç %
    set SSH_PASSWORD=root@1233
    %æœåŠ¡å™¨å·¥ä½œç›®å½•%
    set SSH_DIR=/home/nginx/tmp
    %å…¶ä»–å˜é‡(ä¸ç”¨åŠ¨),è¾“å‡ºå½“å‰è·¯å¾„% 
    set BAT_PATH=%cd%
    
    %-----æ‰“åŒ…-----%
    call cd %PROJECT_DIR% 
    if exist dist rd/s/q dist
    if exist %FILE_NAME% del /a/f/q %FILE_NAME% 
    call npm run build:uat --scripts-prepend-node-path=auto
    call %ZIP_EXEC_PATH%  a %FILE_NAME% ./dist/**
    call dir
    
    %-----æ„å»º-----%
    call echo upload file to server...
    call cd %BAT_PATH%
    call %BAT_PATH%\bin\pscp  -P %SSH_PORT% -pw %SSH_PASSWORD% %PROJECT_DIR%\%FILE_NAME% %SSH_USER%@%SSH_IP%:%SSH_DIR%
    call echo invoke server command...
    call %BAT_PATH%\bin\plink -pw %SSH_PASSWORD% -P %SSH_PORT%  %SSH_USER%@%SSH_IP% "cd %SSH_DIR% && unzip -o %FILE_NAME% && rm -rf %FILE_NAME%"
    
    %auther by shadow%
    call echo success!
    
    pause
    
    

ä»¥ä¸Šæ‰€æœ‰æ ·ä¾‹åŠç”¨åˆ°çš„å‘½ä»¤è¡Œå·¥å…·å‡åœ¨æ­¤[https://github.com/funnyzpc/autoDeploy](https://github.com/funnyzpc/autoDeploy)æœ‰æä¾›(`7z`é™¤å¤–)ğŸˆ

funnyzpc@gmail.com