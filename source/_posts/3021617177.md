---
layout: post
title: "ã€ŒAntVã€L7åœ°ç†å¯è§†åŒ–ï¼šä»å…¥é—¨åˆ°å®è·µ"
date: "2023-06-13T01:16:11.022Z"
---
ã€ŒAntVã€L7åœ°ç†å¯è§†åŒ–ï¼šä»å…¥é—¨åˆ°å®è·µ
====================

![ã€ŒAntVã€L7åœ°ç†å¯è§†åŒ–ï¼šä»å…¥é—¨åˆ°å®è·µ](https://img2023.cnblogs.com/blog/2393708/202306/2393708-20230613003357389-549080297.png) è¿™æ˜¯ä¸€ç¯‡ç”±æµ…å…¥æ·±çš„AntV L7çš„å­¦ä¹ ç¬”è®°æ€»ç»“

1\. å‰è¨€
------

è¿™æ˜¯ä¸€ç¯‡ç”±æµ…å…¥æ·±çš„AntV L7çš„å­¦ä¹ ç¬”è®°æ€»ç»“ï¼Œè®°è¿°äº†ä»äº†è§£åˆ°ä½¿ç”¨çš„ä¸€äº›è¿‡ç¨‹

æœ¬æ–‡æ‰€ä½¿ç”¨çš„æ•°æ®ï¼ˆåŒ…æ‹¬æ•°æ®å¤„ç†è¿‡ç¨‹ï¼‰å’Œä»£ç å‡æœ‰è¯¦ç»†æè¿°ï¼Œæ‰€æœ‰æ¡ˆä¾‹å‡å¯å¤ç°ï¼Œç”šè‡³å¤§éƒ¨åˆ†ä»£ç å¯ç›´æ¥ä½¿ç”¨

å¦‚æœå–œæ¬¢åˆ†é¡µé˜…è¯»ï¼Œå¯ä»¥å‚è€ƒä¸‹åˆ—ç›®å½•ï¼š

*   [ã€ŒAntVã€L7 å¿«é€Ÿå…¥é—¨ç¤ºä¾‹ - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17444013.html)
*   [ã€ŒAntVã€Vue3ä¸TSæ¡†æ¶ä¸‹ä½¿ç”¨L7 - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17446525.html)
*   [ã€ŒAntVã€å…¨çƒAQIæ•°æ®è·å–ä¸L7å¯è§†åŒ– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17468072.html)
*   [ã€ŒAntVã€è·¯ç½‘æ•°æ®è·å–ä¸L7å¯è§†åŒ– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17468646.html)
*   [ã€ŒAntVã€æ™¯ç‚¹è½¨è¿¹æ•°æ®è·å–ä¸L7å¯è§†åŒ– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17468743.html)
*   [ã€ŒAntVã€åŸºäºä¼—æºè½¨è¿¹æ•°æ®çš„ä¸‰ç»´è·¯ç½‘ç”Ÿæˆä¸L7å¯è§†åŒ– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17471910.html)

å› ç¬”è€…æ°´å¹³æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œæ•¬è¯·æŒ‡æ­£

2\. æ¦‚è¿°
------

L7 åœ°ç†ç©ºé—´æ•°æ®å¯è§†åˆ†æå¼•æ“æ˜¯ä¸€ç§åŸºäº WebGL æŠ€æœ¯çš„åœ°ç†ç©ºé—´æ•°æ®å¯è§†åŒ–å¼•æ“ï¼Œå¯ä»¥ç”¨äºå®ç°å„ç§åœ°ç†ç©ºé—´æ•°æ®å¯è§†åŒ–åº”ç”¨ã€‚L7 å¼•æ“æ”¯æŒå¤šç§æ•°æ®æºå’Œæ•°æ®æ ¼å¼ï¼ŒåŒ…æ‹¬ GeoJSONã€CSVç­‰ï¼Œå¯ä»¥å¿«é€ŸåŠ è½½å’Œæ¸²æŸ“å¤§è§„æ¨¡åœ°ç†ç©ºé—´æ•°æ®ã€‚L7 å¼•æ“è¿˜æä¾›äº†ä¸°å¯Œçš„å¯è§†åŒ–æ•ˆæœå’Œäº¤äº’åŠŸèƒ½ï¼ŒåŒ…æ‹¬çƒ­åŠ›å›¾ã€ç­‰é«˜çº¿å›¾ã€é¼ æ ‡äº¤äº’ç­‰ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£å’Œåˆ†æåœ°ç†ç©ºé—´æ•°æ®

L7 å®˜ç½‘ï¼š[èš‚èšåœ°ç†ç©ºé—´æ•°æ®å¯è§†åŒ– | AntV (antgroup.com)](https://l7.antv.antgroup.com/)

L7 GitHub ä»“åº“ï¼š[antvis/L7: ğŸŒ Large-scale WebGL-powered Geospatial Data Visualization analysis engine (github.com)](https://github.com/antvis/L7)

L7 å®˜æ–¹æ•™ç¨‹ï¼š[ç®€ä»‹ | L7 (antgroup.com)](https://l7.antv.antgroup.com/tutorial/l7)

L7 å®˜æ–¹ç¤ºä¾‹ï¼š[æ‰€æœ‰å›¾è¡¨ | L7 (antgroup.com)](https://l7.antv.antgroup.com/examples)

L7 APIæ–‡æ¡£ï¼š[åœºæ™¯ Scene | L7 (antgroup.com)](https://l7.antv.antgroup.com/api/scene)

3\. å¿«é€Ÿå…¥é—¨
--------

### 3.1 å…¥é—¨ç¤ºä¾‹

L7çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ä½¿ç”¨WebGLç»˜åˆ¶åœ°å›¾æ•°æ®ï¼Œæ­¤å¤„ä¸»è¦æè¿°çš„æ˜¯L7ä½œä¸ºå‰ç«¯GISåº“åŸºç¡€åŠŸèƒ½ä½¿ç”¨

é€šè¿‡CDNçš„æ–¹å¼å¯ä»¥å¿«é€Ÿå¼•å…¥L7ï¼š

    <script src = 'https://unpkg.com/@antv/l7'></script>
    

é€šè¿‡NPMçš„æ–¹å¼å¼•å…¥L7å¯å‚è€ƒï¼š

    npm install @antv/l7
    

ç®€å•èµ·è§ï¼Œä¸‹é¢ä½¿ç”¨CDNæ–¹å¼å¼•å…¥

#### 3.1.1 åŠ è½½åœ°å›¾

åŠ è½½åœ°å›¾ï¼š

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            style: 'dark',
            center: [110.770672, 34.159869]
          }),
        });
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530160526639](https://s2.loli.net/2023/05/30/CnQ3EMAd5HqiZkt.png)

L7å†…ç½®äº†é«˜å¾·åº•å›¾APIï¼Œæµ‹è¯•ç¯å¢ƒä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨

#### 3.1.2 åŠ è½½åº•å›¾

é€šå¸¸ï¼Œä½¿ç”¨æ …æ ¼ç“¦ç‰‡ä½œä¸ºåº•å›¾ï¼Œ`L7` çš„æ …æ ¼å›¾å±‚æ”¯æŒåŠ è½½ `TMS`ã€`WMS`ã€`WMTS` ç­‰å¤šç§æ ¼å¼çš„å›¾ç‰‡ç“¦ç‰‡

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.Map({
            center: [110.770672, 34.159869],
            zoom: 4
          }),
        });
    
        const url1 =
          'https://t0.tianditu.gov.cn/img_w/wmts?tk=b72aa81ac2b3cae941d1eb213499e15e&';
        const layer1 = new L7.RasterLayer({
          zIndex: 1,
        }).source(url1, {
          parser: {
            type: 'rasterTile',
            tileSize: 256,
            wmtsOptions: {
              layer: 'img',
              tileMatrixset: 'w',
              format: 'tiles',
            },
          },
        });
    
        scene.on('loaded', () => {
          scene.addLayer(layer1);
        });
      </script>
    </body>
    
    </html>
    

*   æ³¨æ„ï¼šL7ç›®å‰åªæ”¯æŒ 3857 åæ ‡ç³»

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530164635434](https://s2.loli.net/2023/05/30/DcxwjZ98WtVIbNM.png)

#### 3.1.3 åŠ è½½çŸ¢é‡æ•°æ®

L7æ”¯æŒ `GeoJSON`æ•°æ®

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 10,
            style: 'dark'
          })
        });
        scene.on('loaded', () => {
          fetch(
            'https://gw.alipayobjects.com/os/basement_prod/0d2f0113-f48b-4db9-8adc-a3937243d5a3.json'
          )
            .then(res => res.json())
            .then(data => {
              const layer = new L7.LineLayer({})
                .source(data)
              scene.addLayer(layer);
            });
        });
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530174539998](https://s2.loli.net/2023/05/30/oqOgsBEYwxtfkmA.png)

#### 3.1.4 Markeræ ‡æ³¨

Markeræ ‡æ³¨æ˜¯åœ°å›¾ä¸Šç”¨æ¥æ ‡è®°ä¿¡æ¯çš„å¸¸ç”¨ç»„ä»¶

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            style: 'light',
            center: [110.770672, 34.159869]
          }),
        });
    
        const marker = new L7.Marker({
          color: '#f00'
        }).setLnglat([110.770672, 34.159869]);
        
        scene.addMarker(marker);
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530170134233](https://s2.loli.net/2023/05/30/edHvPBZ2rLuEFzw.png)

#### 3.1.5 Popupå¼¹çª—

Popupå¼¹çª—æ˜¯åœ°å›¾ä¸Šç”¨æ¥æ˜¾ç¤ºä¿¡æ¯çš„å¸¸ç”¨ç»„ä»¶

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            style: 'light',
            center: [110.770672, 34.159869]
          }),
        });
    
        const popup = new L7.Popup({
          title: 'è‡ªå®šä¹‰æ ‡é¢˜',
          html: '<p>Popup ç¤ºä¾‹çš„è‡ªå®šä¹‰å†…å®¹</p>',
          lngLat: {
            lng: 110.770672,
            lat: 34.159869,
          },
        });
    
        scene.addPopup(popup);
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530165325005](https://s2.loli.net/2023/05/30/8Nx7zKSy4LG1sub.png)

#### 3.1.6 äº‹ä»¶ç›‘å¬

L7æ”¯æŒäº‹ä»¶é¼ æ ‡ç‚¹å‡»ã€åŒå‡»ç­‰äº‹ä»¶ç›‘å¬

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            style: 'light',
            center: [110.770672, 34.159869]
          }),
        });
    
        setTimeout(() => {
          scene.on('click', (e) => {
            console.log(e) // é¼ æ ‡å·¦é”®ç‚¹å‡»äº‹ä»¶
            const marker = new L7.Marker({
              color: '#f00'
            }).setLnglat([e.lnglat.lng, e.lnglat.lat]);
            scene.addMarker(marker);
          });
        }, 1000);
        // scene.on('click', (e) => {console.log(e)}); // ç›´æ¥ç›‘å¬clickäº‹ä»¶ä¼šæŠ¥é”™
    
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530173837195](https://s2.loli.net/2023/05/30/ZbAx2J3SYzTvcX4.png)

#### 3.1.7 åœ°å›¾æ§ä»¶

åœ¨ä½¿ç”¨åœ°å›¾æ—¶ï¼Œå¸¸å¸¸éœ€è¦ä½¿ç”¨ç¼©æ”¾ã€æ¯”ä¾‹å°ºç­‰æ§ä»¶

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 10,
            style: 'light'
          })
        });
        
        scene.on('loaded', () => {
          const zoom = new L7.Zoom();
          scene.addControl(zoom);
          const scale = new L7.Scale();
          scene.addControl(scale);
        });
    
      </script>
    </body>
    
    </html>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230530175039617](https://s2.loli.net/2023/05/30/E1NXWMndQmBkv63.png)

#### 3.1.8 åŸºç¡€åŠŸèƒ½å°ç»“

ç»¼ä¸ŠåŸºç¡€åŠŸèƒ½æ¡ˆä¾‹ï¼Œä¸éš¾å‘ç°L7æ»¡è¶³GISå‰ç«¯åº“çš„åŸºæœ¬è¦æ±‚ï¼Œå’Œç»å…¸çš„GISå‰ç«¯åº“ï¼ˆå¦‚ï¼ŒLeafletç­‰ï¼‰ç›¸æ¯”ï¼Œè¿˜å…·æœ‰å¼€ç®±å³ç”¨ã€APIå‹å¥½ã€ç»˜åˆ¶æ•ˆæœå¥½ç­‰ä¼˜åŠ¿

### 3.2 æ•´ä½“æ¶æ„

L7çš„æ•´ä½“æ¶æ„å¤§è‡´æ€»ç»“å¦‚ä¸‹ï¼š

graph LR; Mapåœ°å›¾åº•å›¾ --> Scene é«˜å¾·Gaode --> Mapåœ°å›¾åº•å›¾ Mapbox --> Mapåœ°å›¾åº•å›¾ Layer --> Scene ç»„ä»¶Component --> Scene Control --> ç»„ä»¶Component Popup --> ç»„ä»¶Component Markeræ ‡æ³¨ --> ç»„ä»¶Component çº¿å›¾å±‚LineLayer --> Layer ç‚¹å›¾å±‚PointLayer --> Layer é¢å›¾å±‚PolygonLayer --> Layer çƒ­åŠ›å›¾å±‚HeatMapLayer --> Layer å…¶ä»–å›¾å±‚Other --> Layer æ•°æ®æºSource --> é¢å›¾å±‚PolygonLayer é…ç½®é¡¹Options --> é¢å›¾å±‚PolygonLayer æ ·å¼Style --> é¢å›¾å±‚PolygonLayer åŠ¨ç”»Animate --> é¢å›¾å±‚PolygonLayer

4\. ä½¿ç”¨å‰ç«¯æ¡†æ¶
----------

Vueæ˜¯å¸¸ç”¨çš„å‰ç«¯æ¡†æ¶ï¼ŒTypeScriptï¼ˆç®€ç§°TSï¼‰ æ˜¯ JavaScript çš„è¶…é›†ï¼Œå¯ä»¥æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§

ä¸‹é¢è®°è¿°åŸºäºViteã€Vue3å’ŒTypeScriptæ­å»ºL7å¼€å‘ç¯å¢ƒå¹¶ç¤ºä¾‹

### 4.1 ç¯å¢ƒå®‰è£…

è¿™é‡Œä½¿ç”¨Vue å®˜æ–¹çš„é¡¹ç›®è„šæ‰‹æ¶å·¥å…·åˆ›å»ºVueå¼€å‘ç¯å¢ƒï¼ˆå…¶ä»–æ–¹å¼ä¹Ÿå¯ï¼Œå¦‚ç›´æ¥ä½¿ç”¨Viteåˆ›å»ºï¼‰

åœ¨CMDï¼ˆæˆ–Shellï¼‰ä¸­ï¼Œåˆ‡æ¢åˆ°å­˜æ”¾ä»£ç çš„ç›®å½•ï¼Œå¹¶æ‰§è¡Œï¼š

    npm init vue@latest
    

æ¥ç€é€‰æ‹©ä¸€ç³»åˆ—åˆ›å»ºé€‰é¡¹ï¼Œé€šå¸¸é»˜è®¤å³å¯ï¼š

    Need to install the following packages:
      create-vue@3.6.4
    Ok to proceed? (y) y
    
    Vue.js - The Progressive JavaScript Framework
    
    âˆš Project name: ... L7Test
    âˆš Package name: ... l7test
    âˆš Add TypeScript? ... No / Yes
    âˆš Add JSX Support? ... No / Yes
    âˆš Add Vue Router for Single Page Application development? ... No / Yes
    âˆš Add Pinia for state management? ... No / Yes
    âˆš Add Vitest for Unit Testing? ... No / Yes
    âˆš Add an End-to-End Testing Solution? Â» No
    âˆš Add ESLint for code quality? ... No / Yes
    
    Scaffolding project in E:\Code\test\L7Test...
    
    Done. Now run:
    
      cd L7Test
      npm install
      npm run dev
    

ç„¶åæ ¹æ®æç¤ºä¾æ¬¡æ‰§è¡Œå‘½ä»¤ï¼š

    cd L7Test
    

    npm install
    

    npm run dev
    

ä¸€ä¸ªVueæ¨¡æ¿å°±æ­å»ºå®Œæˆï¼š

![image-20230531151709156](https://s2.loli.net/2023/05/31/VrWhNxyRIwdQ97u.png)

ä½¿ç”¨VS Codeï¼ˆå…¶ä»–ä¹Ÿå¯ï¼‰æ‰“å¼€åˆšåˆšåˆ›å»ºçš„é¡¹ç›®ï¼Œåˆ é™¤æ‰`src/components`ä¸‹çš„é»˜è®¤æ–‡ä»¶ï¼Œå¹¶æ¸…é™¤`App.vue`çš„é»˜è®¤å†…å®¹ï¼š

![image-20230531152523748](https://s2.loli.net/2023/05/31/hgRPZDKEy6JLiOz.png)

åœ¨Terminalï¼ˆCMDæˆ–Shellä¹Ÿå¯ï¼‰ä¸­å®‰è£…L7ï¼š

    npm install @antv/l7
    

åœ¨`App.vue`ä¸­ç¼–å†™ä»£ç åŠ è½½L7åœ°å›¾ï¼š

    <script setup lang="ts">
    import { Scene } from "@antv/l7";
    import { GaodeMap } from "@antv/l7-maps";
    
    const scene = new Scene({
      id: "map",
      map: new GaodeMap({
        center: [120.19382669582967, 30.258134],
        pitch: 0,
        style: "dark",
        zoom: 10,
      }),
    });
    </script>
    
    <template>
      <div id="map"></div>
    </template>
    
    <style scoped>
    #map {
      height: 100%;
      width: 100%;
    }
    </style>
    

*   æ³¨ï¼šL7ä½¿ç”¨TSç¼–å†™ï¼Œä½¿ç”¨TSæœ‰è‰¯å¥½çš„ä»£ç æç¤ºå’Œæ£€æµ‹åŠŸèƒ½

ç»“æœå¦‚ä¸‹ï¼š

![image-20230531153526626](https://s2.loli.net/2023/05/31/WLD2aNVjdQ3HnXE.png)

è‡³æ­¤ç¯å¢ƒå®‰è£…å®Œæˆ

### 4.2 ç¤ºä¾‹

å®˜æ–¹ç¤ºä¾‹ï¼š[æ‰€æœ‰å›¾è¡¨ | L7 (antgroup.com)](https://l7.antv.antgroup.com/examples)ï¼ŒåŸºæœ¬æ¼”ç¤ºäº†ç»å¤§éƒ¨åˆ†çš„å›¾è¡¨,å¹¶ä¸”ç¤ºä¾‹ä»£ç å’Œä¸Šè¿°`App.vue`ä¸­çš„`script`æ ‡ç­¾ä¸‹å·®ä¸å¤š,å¯ä»¥ç›´æ¥å¤åˆ¶ä½¿ç”¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20230531155340073](https://s2.loli.net/2023/05/31/TIUW6uJipXf8Mr1.png)

ç›´æ¥å°†ç¤ºä¾‹ä¸­çš„ä»£ç å¤åˆ¶åˆ°`App.vue`çš„`script`ä¸­å³å¯è¿è¡Œï¼š

    <script setup lang="ts">
    import { Scene, PointLayer } from '@antv/l7';
    import { GaodeMap } from '@antv/l7-maps';
    
    const scene = new Scene({
      id: 'map',
      map: new GaodeMap({
        style: 'dark',
        center: [ 121.417463, 31.215175 ],
        zoom: 11
      })
    });
    scene.on('loaded', () => {
      fetch('https://gw.alipayobjects.com/os/rmsportal/BElVQFEFvpAKzddxFZxJ.txt')
        .then(res => res.text())
        .then(data => {
          const pointLayer = new PointLayer({})
            .source(data, {
              parser: {
                type: 'csv',
                y: 'lat',
                x: 'lng'
              }
            })
            .size(0.5)
            .color('#080298');
    
          scene.addLayer(pointLayer);
        });
    });
    </script>
    
    <template>
      <div id="map"></div>
    </template>
    
    <style scoped>
    #map {
      height: 100%;
      width: 100%;
    }
    </style>
    

ç»“æœå¦‚ä¸‹ï¼š

![image-20230531155445187](https://s2.loli.net/2023/05/31/mEjW9xCuMTpB2LR.png)

å…·ä½“å‡½æ•°APIçš„ä½¿ç”¨ï¼Œå¯ä»¥æŸ¥é˜…APIæ‰‹å†Œï¼š[åœºæ™¯ Scene | L7 (antgroup.com)](https://l7.antv.antgroup.com/api/scene)

å®˜ç½‘ç¤ºä¾‹å›¾è¡¨,å‡å¯ç”¨ä¸Šè¿°æ–¹å¼ç§»æ¤åˆ°é¡¹ç›®ä¸­ä½¿ç”¨

5\. æ¡ˆä¾‹ç»ƒä¹ 
--------

### 5.1 æ¡ˆä¾‹ä¸€ï¼šå…¨çƒAQIæ•°æ®è·å–ä¸L7å¯è§†åŒ–

ä¸‹é¢è®°è¿°ä½¿ç”¨L7å¯¹å…¨çƒAQIæ•°æ®è¿›è¡Œå¯è§†åŒ–

#### 5.1.1 æ•°æ®è·å–

å…¨çƒAQIæ•°æ®å¯ä»è¿™ä¸ªç½‘ç«™è·å–ï¼š[World's Air Pollution: Real-time Air Quality Index (waqi.info)](https://waqi.info/)

è¿›å…¥è¿™ä¸ªç½‘ç«™åæ‰“å¼€æ§åˆ¶å°ï¼Œåˆ·æ–°ç½‘é¡µé‡æ–°åŠ è½½ï¼Œæ‰¾åˆ°`000.json`

![image-20230607020325097](https://s2.loli.net/2023/06/07/6VJLtglhyI8WKUN.png)

åœ¨`000.json`ä¸Šå³é”®å¹¶`åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€`ï¼š

![image-20230607020832260](https://s2.loli.net/2023/06/07/rqT16dNMh3X2zuB.png)

åœ¨æ–°æ ‡ç­¾é¡µä¸­å³é”®å¹¶`å¦å­˜ä¸º`ï¼š

![image-20230607020938442](https://s2.loli.net/2023/06/07/SyBtjoYz1DrsAlc.png)

å³å¯è·å¾—JSONæ•°æ®

#### 5.1.2 L7å¯è§†åŒ–

å¯å‚è€ƒå®˜æ–¹æ•£ç‚¹å›¾æ ·ä¾‹ï¼š[ç®€å•ç‚¹ | L7 (antgroup.com)](https://l7.antv.antgroup.com/examples/point/simple/#simple)

##### 5.1.2.1 åŠ è½½åº•å›¾

åŠ è½½é«˜å¾·åœ°å›¾

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 2,
            style: 'light'
          })
        });
      </script>
    </body>
    
    </html>
    

![image-20230607021829593](https://s2.loli.net/2023/06/07/4U9vcFyjI1R8OoM.png)

##### 5.1.2.2 åŠ è½½æ•°æ®å¹¶è§£æ

æ ¹æ®æ•°æ®å†…å®¹ï¼Œå°†ç»çº¬åº¦æ•°ç»„è½¬ç½®ä»¥ç¬¦åˆL7çš„æ•°æ®æ ¼å¼ï¼š

    scene.on('loaded', () => {
        fetch('./000.json')
            .then(res => res.json())
            .then(data => {
            data = data.stations
            data.forEach(item => {
                item.g.reverse()
            })
            console.log(data);
        })
    });
    

![image-20230607022227609](https://s2.loli.net/2023/06/07/JTcqnmdQBVGZl8U.png)

##### 5.1.2.3 ç»˜åˆ¶æ ·å¼

ç»˜åˆ¶ç‚¹å›¾å±‚ï¼Œå¹¶è®¾ç½®æ ·å¼ï¼š

    const layer = new L7.PointLayer()
        .source(data, {
            parser: {
                type: 'json',
                coordinates: 'g'
            }
        })
        .shape('circle')
        .color('a', (value) => {
            // å¤§äº0å°äº50çš„ç»¿è‰²
            if (value > 0 && value < 50) {
                return '#00ff00'
            } else if (value > 50 && value < 100) {
                // å¤§äº50å°äº100çš„è“è‰²
                return '#0000ff'
            } else if (value > 100) {
                // å¤§äº100çš„çº¢è‰²
                return '#ff0000'
            }
        })
        .size('a', (value) => {
            // æ ¹æ®valueå€¼è®¾ç½®ç‚¹çš„å¤§å°
            let a = value / 100 + 2;
            return a;
        })
        .active(true);
    scene.addLayer(layer);
    

![image-20230607022542999](https://s2.loli.net/2023/06/07/dwNL4vtOW19Gphb.png)

##### 5.1.2.4 å®Œæ•´ä»£ç 

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 2,
            style: 'light'
          })
        });
    
        scene.on('loaded', () => {
          fetch('./000.json')
            .then(res => res.json())
            .then(data => {
              data = data.stations
              data.forEach(item => {
                item.g.reverse()
              })
              // console.log(data);
              const layer = new L7.PointLayer()
                .source(data, {
                  parser: {
                    type: 'json',
                    coordinates: 'g'
                  }
                })
                .shape('circle')
                .color('a', (value) => {
                    // å¤§äº0å°äº50çš„ç»¿è‰²
                  if (value > 0 && value < 50) {
                    return '#00ff00'
                  } else if (value > 50 && value < 100) {
                    // å¤§äº50å°äº100çš„è“è‰²
                    return '#0000ff'
                  } else if (value > 100) {
                    // å¤§äº100çš„çº¢è‰²
                    return '#ff0000'
                  }
                })
                .size('a', (value) => {
                  // æ ¹æ®valueå€¼è®¾ç½®ç‚¹çš„å¤§å°
                  let a = value / 100 + 2;
                  return a;
                })
                .active(true);
              scene.addLayer(layer);
            });
        });
      </script>
    </body>
    
    </html>
    

### 5.2 æ¡ˆä¾‹äºŒï¼šè·¯ç½‘æ•°æ®è·å–ä¸L7å¯è§†åŒ–

ä¸‹é¢è®°è¿°ä½¿ç”¨L7å¯¹è·¯ç½‘æ•°æ®è¿›è¡Œå¯è§†åŒ–

#### 5.2.1 æ•°æ®è·å–

è·¯ç½‘æ•°æ®å¯ä»¥ä»ä»¥ä¸‹ç½‘ç«™ä¸‹è½½ï¼Œæ•°æ®æ¥æºè‡ªOSMï¼š[Index of /extracts (openstreetmap.fr)](http://download.openstreetmap.fr/extracts/)

å…¶ä¸­ï¼Œä¸­å›½çš„è·¯ç½‘æ•°æ®å¯ä»¥ä»è¿™ä¸ªä¸‹è½½ï¼š[Index of /extracts/asia/china (openstreetmap.fr)](http://download.openstreetmap.fr/extracts/asia/china/)

ç¬”è€…è¿™é‡Œä¸‹è½½ä¸Šæµ·çš„æ•°æ®ï¼š[http://download.openstreetmap.fr/extracts/asia/china/shanghai.osm.pbf](http://download.openstreetmap.fr/extracts/asia/china/shanghai.osm.pbf)

ä¸‹è½½å¥½ä»¥åå¯ä»¥ç›´æ¥æ‹–å…¥QGISä¸­ï¼š

![image-20230608025426654](https://s2.loli.net/2023/06/08/YuxG6insl8BUREH.png)

*   æ³¨ï¼šè¿™é‡ŒåŠ è½½äº†`Lines`ï¼Œæ•°æ®é‡è¾ƒå¤§ï¼Œç»˜åˆ¶å¡é¡¿ã€‚ä¸”è·¯ç½‘è´¨é‡ä¹Ÿæ¬ ä½³

åœ¨å›¾å±‚ä¸Šå³é”®é€‰æ‹©`å¯¼å‡º`ï¼š

![image-20230608025441930](https://s2.loli.net/2023/06/08/gR5DTBeZYMjCuXS.png)

å¯¼å‡ºä¸º`GeoJSON`ï¼š

![image-20230608025517171](https://s2.loli.net/2023/06/08/bOVKgSAifqL5U41.png)

å¯¼å‡ºçš„æ•°æ®å°ºå¯¸ä¸º84 MBï¼Œè‡³æ­¤æ•°æ®è·å–å®Œæˆ

#### 5.2.2 L7å¯è§†åŒ–

å¯å‚è€ƒå®˜æ–¹è·¯ç½‘å›¾æ ·ä¾‹ï¼š[è·¯å¾„åœ°å›¾ | L7 (antgroup.com)](https://l7.antv.antgroup.com/zh/examples/line/path/#shanghai_bus)

##### 5.2.2.1 åŠ è½½åº•å›¾

åŠ è½½é«˜å¾·åœ°å›¾

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 2,
            style: 'light'
          })
        });
      </script>
    </body>
    
    </html>
    

![image-20230608024834829](https://s2.loli.net/2023/06/08/FEUDahysrKSRPBt.png)

##### 5.2.2.2 åŠ è½½æ•°æ®å¹¶è§£æ

åŠ è½½æ•°æ®ï¼ŒL7å¯¹äºGeoJSONæ— éœ€é¢å¤–è®¾ç½®è§£æå™¨ï¼š

    scene.on('loaded', () => {
        fetch('./lines.geojson')
            .then(res => res.json())
            .then(data => {
            console.log(data);
        })
    });
    

![image-20230608033901544](https://s2.loli.net/2023/06/08/Zmy65cjhRrU83JX.png)

##### 5.2.2.3 ç»˜åˆ¶æ ·å¼

ç»˜åˆ¶çº¿å›¾å±‚ï¼Œå¹¶è®¾ç½®æ ·å¼ï¼š

    const layer = new L7.LineLayer({
        zIndex: 2,
    })
        .source(data)
        .size(0.5)
        .active(true)
        .color('highway', (type) => {
            switch (type) {
                case "bridleway"  :
                    return '#c81841';
                case "bus_guideway" :
                    return '#39a0cc';
                case "bus_stop"  :
                    return '#0d70cc';
                case "busway"  :
                    return '#d385dd';
                case "construction"  :
                    return '#30e5dc';
                case "corridor"  :
                    return '#ca6166';
                case "cycleway"  :
                    return '#c94534';
                case "elevator"  :
                    return '#c3ee79';
                case "footway"  :
                    return '#df7f53';
                case "living_street" :
                    return '#0d2dce';
                case "motorway"  :
                    return '#c8659f';
                case "motorway_link" :
                    return '#15d066';
                case "path"  :
                    return '#cab646';
                case "pedestrian" :
                    return '#2ddb95';
                case "planned" :
                    return '#36cd25';
                case "platform" :
                    return '#d99b1f';
                case "primary"  :
                    return '#75cc53';
                case "primary_link" :
                    return '#e31eb2';
                case "proposed"  :
                    return '#4e2bec';
                case "raceway"  :
                    return '#c8721c';
                case "residential" :
                    return '#6ced77';
                case "road"  :
                    return '#57e079';
                case "secondary" :
                    return '#2063e9';
                case "secondary_link" :
                    return '#7aec1d';
                case "service"  :
                    return '#58d9ed';
                case "services"  :
                    return '#1fe3b9';
                case "steps"  :
                    return '#e010d2';
                case "tertiary"  :
                    return '#adca37';
                case "tertiary_link"  :
                    return '#d0d32e';
                case "track"  :
                    return '#e04684';
                case "trunk"  :
                    return '#b232e4';
                case "trunk_link"  :
                    return '#822dcd';
                case "unclassified"  :
                    return '#a686de';
                case "null"  :
                    return '#1f1bef';
                case ""  :
                    return '#beb297';
                default:
                    return '#beb297';
            }
        });
    scene.addLayer(layer);
    });
    

![image-20230608033429972](https://s2.loli.net/2023/06/08/YfcEQ2KaWynCmzG.png)

##### 5.2.2.4 å®Œæ•´ä»£ç 

å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.GaodeMap({
            center: [116.3956, 39.9392],
            zoom: 2,
            style: 'dark'
          })
        });
    
        scene.on('loaded', () => {
          fetch('./lines.geojson')
            .then(res => res.json())
            .then(data => {
              const layer = new L7.LineLayer({
                zIndex: 2,
              })
                .source(data)
                .size(0.5)
                .active(true)
                .color('highway', (type) => {
                  switch (type) {
                    case "bridleway"  :
                      return '#c81841';
                    case "bus_guideway" :
                      return '#39a0cc';
                    case "bus_stop"  :
                      return '#0d70cc';
                    case "busway"  :
                      return '#d385dd';
                    case "construction"  :
                      return '#30e5dc';
                    case "corridor"  :
                      return '#ca6166';
                    case "cycleway"  :
                      return '#c94534';
                    case "elevator"  :
                      return '#c3ee79';
                    case "footway"  :
                      return '#df7f53';
                    case "living_street" :
                      return '#0d2dce';
                    case "motorway"  :
                      return '#c8659f';
                    case "motorway_link" :
                      return '#15d066';
                    case "path"  :
                      return '#cab646';
                    case "pedestrian" :
                      return '#2ddb95';
                    case "planned" :
                      return '#36cd25';
                    case "platform" :
                      return '#d99b1f';
                    case "primary"  :
                      return '#75cc53';
                    case "primary_link" :
                      return '#e31eb2';
                    case "proposed"  :
                      return '#4e2bec';
                    case "raceway"  :
                      return '#c8721c';
                    case "residential" :
                      return '#6ced77';
                    case "road"  :
                      return '#57e079';
                    case "secondary" :
                      return '#2063e9';
                    case "secondary_link" :
                      return '#7aec1d';
                    case "service"  :
                      return '#58d9ed';
                    case "services"  :
                      return '#1fe3b9';
                    case "steps"  :
                      return '#e010d2';
                    case "tertiary"  :
                      return '#adca37';
                    case "tertiary_link"  :
                      return '#d0d32e';
                    case "track"  :
                      return '#e04684';
                    case "trunk"  :
                      return '#b232e4';
                    case "trunk_link"  :
                      return '#822dcd';
                    case "unclassified"  :
                      return '#a686de';
                    case "null"  :
                      return '#1f1bef';
                    case ""  :
                      return '#beb297';
                    default:
                      return '#beb297';
                  }
                });
              scene.addLayer(layer);
            });
        });
    
      </script>
    </body>
    
    </html>
    

6\. ç»¼åˆæ¡ˆä¾‹ï¼šåŸºäºä¼—æºè½¨è¿¹æ•°æ®çš„ä¸‰ç»´è·¯ç½‘ç”Ÿæˆä¸L7å¯è§†åŒ–
------------------------------

ä¸‹é¢è®°è¿°ä½¿ç”¨L7å¯¹é•¿æ²™å²³éº“å±±æ™¯ç‚¹æ¸¸å®¢è½¨è¿¹æ•°æ®è¿›è¡Œå¯è§†åŒ–å¹¶æ„å»ºä¸‰ç»´è·¯ç½‘çš„ç»¼åˆæ¡ˆä¾‹

### 6.1 æ•°æ®è·å–

è·¯ç½‘æ•°æ®å¯ä»¥ä»ä»¥ä¸‹ç½‘ç«™ä¸‹è½½ï¼Œæ•°æ®æ¥æºè‡ªå…­åªè„šï¼š[å…­åªè„š\_GPSè½¨è¿¹è®°å½•\_æˆ·å¤–è‡ªåŠ©æ¸¸\_è‡ªåŠ©æ¸¸çº¿è·¯ (foooooot.com)](http://www.foooooot.com/)

å…·ä½“çš„è½¨è¿¹è·å–æ•™ç¨‹å¯ä»¥å‚è€ƒï¼š[GPSåœ°å›¾ç”Ÿæˆ03ä¹‹æ•°æ®è·å– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/16177208.html)

ä¸‹è½½å¥½ä»¥åå¯ä»¥åœ¨QGISä¸­åˆ©ç”¨åŠ è½½XYæ–‡ä»¶çš„æ–¹å¼åŠ è½½all.csvæ–‡ä»¶ï¼Œå¹¶è®¾ç½®OSMåº•å›¾ï¼Œé¢„è§ˆGPSè½¨è¿¹ï¼š

![å›¾ç‰‡.png](https://img2022.cnblogs.com/blog/2393708/202204/2393708-20220422010254982-240536139.png)

*   æ³¨ï¼šæ•°æ®é‡è¾ƒå¤§ï¼Œç»˜åˆ¶å¡é¡¿

æ•°æ®æ–‡ä»¶å°ºå¯¸ä¸º47.2 Mï¼Œæœ‰892152æ¡è½¨è¿¹æ•°æ®ï¼Œè‡³æ­¤æ•°æ®è·å–å®Œæˆ

æ•°æ®æ–‡ä»¶å†…å®¹ç¤ºä¾‹ä¸ºï¼š

    id,lng,lat,ele,track,time
    0,112.938652777778,28.1828777777778,52.5862003780718,1448263,1511330079
    1,112.936425,28.1837833333333,63.8200589970501,1448263,1511330738
    2,112.936280555556,28.1837833333333,64.1105651105651,1448263,1511330800
    3,112.93595,28.18385,65.3336643495531,1448263,1511331332
    4,112.935691666667,28.1839333333333,66.9243986254296,1448263,1511331794
    5,112.932275,28.1840388888889,80.1450980392157,1448263,1511335690
    6,112.929519444444,28.1849583333333,179.382636655949,1448263,1511336583
    7,112.929244444444,28.1849777777778,185.630363036304,1448263,1511336714
    8,112.928458333333,28.1860111111111,228.579710144928,1448263,1511337087
    9,112.931161111111,28.1911555555556,285.57196969697,1448263,1511339434
    10,112.931288888889,28.1910944444444,288.503448275862,1448263,1511339460
    ......
    

### 6.2 L7å¯è§†åŒ–

å¯å‚è€ƒå®˜æ–¹äº®åº¦å›¾æ ·ä¾‹ï¼š[äº®åº¦å›¾ | L7 (antgroup.com)](https://l7.antv.antgroup.com/examples/point/dot#normal)

#### 6.2.1 åŠ è½½åº•å›¾

åŠ è½½Mapboxåœ°å›¾

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
      <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
      <script src='https://unpkg.com/@antv/l7'></script>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.Mapbox({
            style: 'dark',
            center: [112.9448, 28.1708],
            zoom: 12,
            token: 'pk.eyJ1IjoieWFuZ2ppYW4iLCJhIjoiY2phaG1neno0MXFkNDMzbWhwNWw0bWM4aiJ9.CFmrh0LVWAbmVeed-Xr7wA'
          }),
        });
          
      </script>
    </body>
    
    </html>
    

![image-20230609025100248](https://s2.loli.net/2023/06/09/ZT8WGzL5lvQuCy2.png)

#### 6.2.2 åŠ è½½æ•°æ®å¹¶è§£æ

åŠ è½½æ•°æ®ï¼ŒL7å†…ç½®CSVæ ¼å¼è§£æå™¨ï¼Œåªéœ€æŒ‡å®šå­—æ®µåå³å¯ï¼š

    scene.on('loaded', () => {
        fetch('./all.csv')
            .then(res => res.text())
            .then(data => {
            const pointLayer = new L7.PointLayer({})
            .source(data, {
                parser: {
                    type: 'csv',
                    y: 'lat',
                    x: 'lng'
                }
            })
    
            scene.addLayer(pointLayer);
        });
    });
    

![image-20230609025533852](https://s2.loli.net/2023/06/09/S12FcjtU3krbhyo.png)

#### 6.2.3 ç»˜åˆ¶æ ·å¼

ç»˜åˆ¶ç‚¹å›¾å±‚ï¼Œå¹¶è®¾ç½®æ ·å¼ï¼š

    scene.on('loaded', () => {
        fetch('./all.csv')
            .then(res => res.text())
            .then(data => {
            const pointLayer = new L7.PointLayer({})
            .source(data, {
                parser: {
                    type: 'csv',
                    y: 'lat',
                    x: 'lng'
                }
            })
            .size(0.5)
            .color('#080298');
    
            scene.addLayer(pointLayer);
        });
    });
    

![image-20230609025659772](https://s2.loli.net/2023/06/09/VDaoH2lTL6qfprk.png)

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºä¸»è¦çš„è·¯çº¿ï¼Œå³é«˜äº®éƒ¨åˆ†

#### 6.2.4 è·¯ç½‘å åŠ 

ä»¥ä¸‹å¯¹æ™¯ç‚¹åŠé™„è¿‘çš„è·¯ç½‘æ•°æ®å¯è§†åŒ–

è·¯ç½‘æ•°æ®è·å–ä¸å¯è§†åŒ–æ­¥éª¤å¯å‚è€ƒï¼š[ã€ŒAntVã€è·¯ç½‘æ•°æ®è·å–ä¸L7å¯è§†åŒ– - å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’ - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/jiujiubashiyi/p/17468646.html)

![image-20230609030907412](https://s2.loli.net/2023/06/09/BkjufK6Oom8EV91.png)

å åŠ å›¾å±‚ï¼š

![image-20230609031947991](https://s2.loli.net/2023/06/09/OdTejPWmitS5MHL.png)

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ™¯åŒºçš„è½¨è¿¹ä¿¡æ¯æ¯”è·¯ç½‘ä¿¡æ¯æ›´ä¸ºå®Œå–„å’Œç›´è§‚

#### 6.2.5 è·¯ç½‘æå–

ä»ä¸Šå›¾ä¸éš¾çœ‹å‡ºï¼Œè™½ç„¶æœ‰çš„åœ°æ–¹åœ¨è·¯ç½‘ä¸Šä¸æ˜¾ç¤ºï¼Œè¿™äº›é“è·¯å¯èƒ½åªæ˜¯æ™¯åŒºå°é“ï¼Œä½†å®ƒç¡®å®ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„é“è·¯ï¼Œå°¤å…¶æ˜¯å¯¹äºè¡Œäººã€æ—…è¡Œè€…è€Œè¨€

å½“è¶³å¤Ÿæ•°é‡çš„è½¨è¿¹ç‚¹æ˜¾ç¤ºåœ¨ä¸€èµ·æ—¶ï¼Œè¿™äº›äº®åº¦å›¾ä¼¼ä¹å°±æ˜¯è·¯ç½‘å›¾ï¼Œæ›´è¿›ä¸€æ­¥çš„ï¼Œå¯ä»¥ä»è¿™äº›è½¨è¿¹æ•°æ®ä¸­æå–å»è·¯ç½‘

è¿™é‡Œä¸åšå…·ä½“ç ”ç©¶é˜è¿°ï¼Œå¯ä»¥å‚è€ƒä¸‹åˆ—æ–‡ç« ï¼š

*   [(PDF) åŸºäºä¼—æºè½¨è¿¹æ•°æ®çš„è¡Œäººè·¯ç½‘æå– (researchgate.net)](https://www.researchgate.net/publication/352159252_jiyuzhongyuanguijishujudexingrenluwangtiqu)
*   [(PDF) Pedestrian network generation based on crowdsourced tracking data (researchgate.net)](https://www.researchgate.net/publication/337868238_Pedestrian_network_generation_based_on_crowdsourced_tracking_data)
*   [Map Inference in the Face of Noise and Disparity](https://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.423.2134)
*   ......

è¿™é‡Œä½¿ç”¨çš„æ˜¯ã€ŠMap Inference in the Face of Noise and Disparityã€‹ä¸­æ‰€æå‡ºçš„ç®—æ³•è¿›è¡Œæå–è·¯ç½‘ï¼Œå¹¶æå–GPSè½¨è¿¹æ•°æ®ä¸­çš„ä¸‰ç»´ä¿¡æ¯ï¼Œæ„å»ºä¸ºä¸‰ç»´è·¯ç½‘

ã€ŠMap Inference in the Face of Noise and Disparityã€‹ä¸­æ‰€æå‡ºçš„ç®—æ³•æºç å¯ä»¥åœ¨ä»¥ä¸‹åœ°å€ä¸‹è½½ï¼š

*   [haidaoxiaofei/mapinference-gis12-upgrade (github.com)](https://github.com/haidaoxiaofei/mapinference-gis12-upgrade)
*   [qcri/gpsmap: Real time map creation and update using gps data (github.com)](https://github.com/qcri/gpsmap/tree/master/gis12_mapinference)

å¦å¤–ï¼Œè¿˜æœ‰å¤šç§è·¯ç½‘æå–ç®—æ³•ï¼Œå¯ä»¥åœ¨ä¸‹åˆ—ç½‘ç«™ä¸­æŸ¥çœ‹å¹¶ä½¿ç”¨ï¼š

*   [pfoser/mapconstruction: Map Construction Algorithms (github.com)](https://github.com/pfoser/mapconstruction)

#### 6.2.6 äºŒç»´è·¯ç½‘å¯è§†åŒ–

ç»è¿‡ä¸€ç³»åˆ—çš„æ•°æ®é¢„å¤„ç†ã€è·¯ç½‘æå–ã€æ•°æ®åå¤„ç†ï¼Œä»ä¸Šè¿°çš„è½¨è¿¹æ•°æ®å¾—åˆ°äº†ä»¥ä¸‹è·¯ç½‘æ•°æ®ï¼š

![image-20230610023340968](https://s2.loli.net/2023/06/10/wYnxievHAmBJzOV.png)

å…¶ä¸­ï¼Œæµ·æ‹”æ¸å˜è‰²å¸¦ç”±ä½åˆ°é«˜ä¸ºï¼š![image-20230610023425852](https://s2.loli.net/2023/06/10/p9UywFnQZJWg1VE.png)

ç”±å›¾ä¸­å¯ä»¥çœ‹å‡ºå²³éº“å±±æ™¯ç‚¹è·¯ç½‘æ•°æ®çš„ç›¸å¯¹é«˜åº¦

ç»˜åˆ¶çš„ä»£ç å¦‚ä¸‹ï¼š

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
      <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.Mapbox({
            style: 'dark',
            center: [112.9448, 28.1708],
            zoom: 12,
            token: 'pk.eyJ1IjoieWFuZ2ppYW4iLCJhIjoiY2phaG1neno0MXFkNDMzbWhwNWw0bWM4aiJ9.CFmrh0LVWAbmVeed-Xr7wA'
          })
        });
    
        scene.on('loaded', () => {
          fetch('./Yuelushan.geojson')
            .then(res => res.json())
            .then(data => {
              const layer = new L7.LineLayer({
                zIndex: 2,
              })
                .source(data)
                .size(0.5)
                .active(true)
                .color('z1', ['#0b8040', '#f2b90c', '#751304', '#8c644c', '#b8b8b8']);
              scene.addLayer(layer);
            });
        });
    
      </script>
    </body>
    

#### 6.2.7 ä¸‰ç»´è·¯ç½‘å¯è§†åŒ–

è·¯ç½‘æ•°æ®çš„æ ¼å¼å¦‚ä¸‹ï¼š

    {
      "type": "FeatureCollection",
      "name": "Yuelushan",
      "crs": {
        "type": "name",
        "properties": {
          "name": "urn:ogc:def:crs:OGC:1.3:CRS84"
        }
      },
      "features": [
        {
          "type": "Feature",
          "properties": {
            "id": 0,
            "z1": 74.72296906,
            "z2": 74.72296906
          },
          "geometry": {
            "type": "MultiLineString",
            "coordinates": [
              [
                [
                  112.918952568856085,
                  28.182139289691705,
                  74.72296906
                ],
                [
                  112.918964283127451,
                  28.182139382193309,
                  74.72296906
                ]
              ]
            ]
          }
        },
        ......
    

ç”±ç¤ºä¾‹æ•°æ®å¯çŸ¥ï¼Œæ¯ä¸ªç‚¹åæ ‡æ˜¯ç”±ç»çº¬åº¦å’Œé«˜ç¨‹ç»„æˆï¼Œè€ŒL7é»˜è®¤æ”¯æŒè·¯ç½‘æ•°æ®é«˜ç¨‹æ˜¾ç¤ºï¼š

![åŠ¨ç”»2](https://img2023.cnblogs.com/blog/2393708/202306/2393708-20230610203330892-1373242473.gif)

#### 6.2.8 å¡åº¦ä¿¡æ¯å›¾

åˆ©ç”¨é«˜ç¨‹ä¿¡æ¯ï¼Œå¯ä»¥åˆ¶ä½œå‡ºå¡åº¦ä¿¡æ¯å›¾

![image-20230610025330643](https://s2.loli.net/2023/06/10/Pf8Xl7KYMeFJrD6.png)

åˆ©ç”¨å¡åº¦ä¿¡æ¯ï¼Œå¯ä»¥å¸®åŠ©è¡Œäººé€‰æ‹©é“è·¯ï¼Œå®ç°ä»£ç å¦‚ä¸‹ï¼š

    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Document</title>
      <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
      <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
      <script src='https://unpkg.com/@antv/l7'></script>
      <style>
        body,
        #map {
          height: 100vh;
          width: 100vw;
          margin: 0;
        }
      </style>
    </head>
    
    <body>
      <div id="map"></div>
      <script>
        const scene = new L7.Scene({
          id: 'map',
          map: new L7.Mapbox({
            style: 'dark',
            center: [112.9448, 28.1708],
            zoom: 12,
            token: 'pk.eyJ1IjoieWFuZ2ppYW4iLCJhIjoiY2phaG1neno0MXFkNDMzbWhwNWw0bWM4aiJ9.CFmrh0LVWAbmVeed-Xr7wA'
          })
        });
    
        scene.on('loaded', () => {
          fetch('./Yuelushan.geojson')
            .then(res => res.json())
            .then(data => {
              data.features.forEach(element => {
                element.properties.slope = Math.abs(element.properties.z1 - element.properties.z2);
              });
              const layer = new L7.LineLayer({
                zIndex: 2,
              })
                .source(data)
                .size(1)
                .active(true)
                .color('slope', ['#0b8040', '#f2b90c', '#751304', '#8c644c', '#b8b8b8']);
              scene.addLayer(layer);
            });
        });
    
      </script>
    </body>
    

æ³¨ï¼šæ­¤å¤„å¡åº¦è®¡ç®—å¹¶ä¸å‡†ç¡®ï¼Œåªæ˜¯å¤§è‡´ç¤ºæ„

7\. æ€»ç»“ä¸æ„Ÿæ‚Ÿ
---------

ç¬”è€…ä½¿ç”¨è¿‡å¤šä¸ªWebç«¯çš„GISå¼€æºåº“ï¼ŒåŒ…æ‹¬OpenLayersã€Leafletã€Mapboxã€Cesiumç­‰ï¼Œä¹Ÿä½¿ç”¨è¿‡EChartsç­‰å›¾è¡¨åº“ï¼Œç›¸è¾ƒè€Œè¨€ï¼ŒL7å¼€ç®±å³ç”¨çš„ç‰¹ç‚¹ååˆ†çªå‡ºï¼ŒåŸºäºWebGLçš„æ¸²æŸ“æ–¹å¼åœ¨é¢å¯¹åœ°ç†å¤§æ•°æ®æ—¶ä¹Ÿèƒ½è·å¾—ä¸é”™çš„ä½“éªŒï¼Œç”šè‡³åœ¨ä¸Šè¿°çš„æ¡ˆä¾‹ä¸­ï¼Œç»˜åˆ¶è½¨è¿¹æ•°æ®çš„æµç•…æ„Ÿæ¯”C++å†™çš„æ¡Œé¢ç«¯è½¯ä»¶çš„QGISæ›´å¥½

ä¸è¶³ä¹‹å¤„æ˜¯ï¼Œå’Œè€ç‰Œçš„GISå¼€æºåº“ç›¸æ¯”ï¼Œä¸“ä¸šæ€§å’Œå¯é…ç½®æ€§è¿˜æ˜¯æœ‰æ‰€æ¬ ç¼ºï¼Œä¸‰ç»´æ–¹é¢ä¹Ÿæœ‰å¾…å®Œå–„ã€‚å½“ç„¶ï¼Œç›®å‰çœ‹æ¥ï¼ŒL7çš„ä¸»è¦åº”ç”¨åœºæ™¯çš„åœ°ç†æ•°æ®å¯è§†åŒ–ï¼Œå¦‚æœæ˜¯ä¾§é‡åœ°ç†å¯è§†åŒ–çš„é¡¹ç›®ä¸åº”ç”¨åœºæ™¯ï¼ŒL7æ˜¯ä¸ªéå¸¸ä¸é”™çš„é€‰æ‹©

8\. å‚è€ƒèµ„æ–™
--------

\[1\] [ç®€ä»‹ | L7 (antgroup.com)](https://l7.antv.antgroup.com/tutorial/l7)

\[2\] [æ‰€æœ‰å›¾è¡¨ | L7 (antgroup.com)](https://l7.antv.antgroup.com/examples)

\[3\] [åœºæ™¯ Scene | L7 (antgroup.com)](https://l7.antv.antgroup.com/api/scene)

\[4\] [Map Inference in the Face of Noise and Disparity](https://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.423.2134)

\[5\] [haidaoxiaofei/mapinference-gis12-upgrade (github.com)](https://github.com/haidaoxiaofei/mapinference-gis12-upgrade)

ä½œè€…ï¼š[å½“æ—¶æ˜æœˆåœ¨æ›¾ç…§å½©äº‘å½’](https://www.cnblogs.com/jiujiubashiyi/)

å‡ºå¤„ï¼š[https://www.cnblogs.com/jiujiubashiyi/p/17476433.html](https://www.cnblogs.com/jiujiubashiyi/p/17476433.html)