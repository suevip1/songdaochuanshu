---
layout: post
title: "uniapp-chatgptè·¨ç«¯ä»¿ChatGPTå®ä¾‹|uniapp+vue3+piniaå¤šç«¯èŠå¤©æ¨¡æ¿"
date: "2023-06-27T01:25:02.006Z"
---
uniapp-chatgptè·¨ç«¯ä»¿ChatGPTå®ä¾‹|uniapp+vue3+piniaå¤šç«¯èŠå¤©æ¨¡æ¿
==================================================

åŸºäºuniapp+vite4+piniaè·¨å¤šç«¯å®ç°chatgptä¼šè¯æ¨¡æ¿_Uniapp-ChatGPT_ã€‚

**uni-chatgpt** ä½¿ç”¨uni-app+vite4+vue3+pinia+uview-plusç­‰æŠ€æœ¯æ„å»ºå¤šç«¯ä»¿åˆ¶ChatGPTæ‰‹æœºç«¯APPä¼šè¯åº”ç”¨æ¨¡æ¿ã€‚æ”¯æŒç¼–è¯‘åˆ°h5+å°ç¨‹åº+APPç«¯ï¼Œæ”¯æŒæ¸²æŸ“markdownè¯­æ³•åŠä»£ç é«˜äº®ã€è§£å†³è½¯é”®ç›˜æ’‘èµ·å¸ƒå±€é—®é¢˜ã€‚

### **â—† æ•ˆæœé¢„è§ˆ**

ç¼–è¯‘ \[**H5+å°ç¨‹åº+Appç«¯**\] æ•ˆæœå¦‚ä¸‹

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626220009709-190534706.png)

### **â—† æŠ€æœ¯æ ˆ**

*   ç¼–è¾‘å™¨ï¼šHbuilderX 3.8.4
*   æ¡†æ¶æŠ€æœ¯ï¼šUniapp+Vite4+Vue3+Pinia
*   UIç»„ä»¶åº“ï¼šuView-plus^3.1.31
*   markdownæ¸²æŸ“ï¼šmarkdown-it
*   ä»£ç é«˜äº®ï¼šhighlight.js
*   æœ¬åœ°ç¼“å­˜ï¼špinia-plugin-unistorage
*   å¼¹æ¡†ç»„ä»¶ï¼šua-popupï¼ˆåŸºäºuniappå°è£…è·¨ç«¯å¼¹å±‚ç»„ä»¶ï¼‰
*   è‡ªå®šä¹‰ç»„ä»¶ï¼šå¯¼èˆªæ¡ua-navbar+èœå•æ ua-tabbar
*   æ”¯æŒç¼–è¯‘ï¼šå°ç¨‹åº+H5+APPç«¯

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626221432232-1433433569.gif)

### **â—† åŠŸèƒ½ç‰¹æ€§**

1.  æ²‰æµ¸å¼è‡ªå®šä¹‰é¡¶éƒ¨å¯¼èˆªæ¡+åº•éƒ¨tabbar
2.  æ”¯æŒh5+å°ç¨‹åº+Appç«¯æ¸²æŸ“markdownè¯­æ³•åŠä»£ç é«˜äº®
3.  åŸºäºpiniaå…¨å±€çŠ¶æ€ç®¡ç†
4.  åŸºäºuview-plusè·¨ç«¯vue3ç»„ä»¶åº“
5.  æ”¯æŒä¼šè¯æœ¬åœ°ç¼“å­˜

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626222819758-1299533088.gif)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626222834567-1814547999.gif)

### **â—† é¡¹ç›®ç»“æ„ç›®å½•**

åŸºäºhbuilderxåˆ›å»ºçš„é¡¹ç›®ï¼Œæ•´ä¸ªé¡¹ç›®é¡µé¢å…¨éƒ¨é‡‡ç”¨uniapp vue3è¯­æ³•ç¼–ç å¼€å‘ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626223345173-1678782657.png)

å¦‚æœå¯¹uniappç»“åˆvue3åˆ›å»ºå¤šç«¯é¡¹ç›®æ„Ÿå…´è¶£ï¼Œå¯ä»¥å»çœ‹çœ‹ä¹‹å‰çš„åˆ†äº«æ–‡ç« ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/17487018.html](https://www.cnblogs.com/xiaoyan2017/p/17487018.html)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626224214356-754360739.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234340899-1610090652.gif)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234617784-772527835.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234636608-49436982.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234657170-1284741277.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234712496-1058887524.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626234757397-602604291.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235023891-519765106.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235039420-824376585.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235125450-1831674083.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235212827-791068277.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235324364-1160524490.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235421004-345199977.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235435487-1062117455.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230626235450486-1149153904.png)

### **â—† Uniappè‡ªå®šä¹‰å¤šç«¯Navbar+Tabbarç»„ä»¶**

é¡¹ç›®ä¸­é¡¶éƒ¨navbarå’Œåº•éƒ¨tabbarå‡æ˜¯è‡ªå®šä¹‰ç»„ä»¶å®ç°åŠŸèƒ½ï¼Œä¿è¯æ•´ä½“é£æ ¼ç»Ÿä¸€åè°ƒã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000222731-100119445.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000316110-1244186344.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000438078-1851127047.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000503546-1770757103.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000550324-2036179977.png)

å¦‚ä¸‹å›¾ï¼šåœ¨componentsç›®å½•ä¸‹æ–°å»ºç»„ä»¶ã€‚æ”¯æŒeasycomæ¨¡å¼ï¼Œæ— éœ€å¼•å…¥ï¼Œç›´æ¥å¯ä»¥ä½¿ç”¨ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627000746528-933532786.png)

<ua-navbar back\="false" custom :title\="title" size\="40rpx" center fixed :bgcolor\="bgcolor"\>
    <template #left\>
        <view @click\="showSidebar=true"\><text class\="iconfont ve-icon-menuon"\></text\></view\>
    </template\>
    <template #right\>
        <text class\="iconfont ve-icon-plus fs-36" @click\="handleNewChat"\></text\>
    </template\>
</ua-navbar\>

è‡³äºå¦‚ä½•å®ç°ç»„ä»¶åŠŸèƒ½ï¼Œè¿™é‡Œå°±ä¸åšè¯¦ç»†ä»‹ç»äº†ï¼Œå¤§å®¶å¯ä»¥å»çœ‹çœ‹ä¹‹å‰çš„åˆ†äº«æ–‡ç« ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/14978408.html](https://www.cnblogs.com/xiaoyan2017/p/14978408.html)

å¦å¤–Navbarå’ŒTabbarç»„ä»¶çš„vue2ç‰ˆæœ¬å·²ç»å‘å¸ƒåˆ°äº†æ’ä»¶å¸‚åœºï¼Œå¦‚æœå¤§å®¶æœ‰éœ€è¦å¯ä»¥å»ä¸‹è½½ï¼Œä¸€æ¬¡æ€§æ‹¿èµ°ä½¿ç”¨ã€‚

[https://ext.dcloud.net.cn/plugin?id=5592](https://ext.dcloud.net.cn/plugin?id=5592)  
[https://ext.dcloud.net.cn/plugin?id=5593](https://ext.dcloud.net.cn/plugin?id=5593)

### **â—† ä¸»å…¥å£main.jsé…ç½®**

åœ¨main.jsä¸­ä½¿ç”¨**vue3è¯­æ³•**ï¼Œå¼•å…¥piniaçŠ¶æ€ç®¡ç†ã€uview-plusç»„ä»¶åº“ã€‚

/\*\*
 \* ä¸»å…¥å£é…ç½®
  \*/

import App from './App'
import { createSSRApp } from 'vue'

// å¼•å…¥piniaçŠ¶æ€ç®¡ç†
import pinia from '@/store'

// å¼•å…¥uview-plusç»„ä»¶åº“
import uviewplus from '@/uview-plus'

export function createApp() {
    const app \= createSSRApp(App)
    app.use(pinia)
    app.use(uviewplus)
    return {
        app,
        pinia
    }
}

### **â—† App.vueæ¨¡æ¿é…ç½®**

åœ¨app.vueä¸­ä½¿ç”¨vue3 setupè¯­æ³•ï¼Œè·å–æ‰‹æœºç³»ç»ŸçŠ¶æ€æ é«˜åº¦ã€‚

<script setup>
    import { provide } from 'vue'
    import { onLaunch, onShow, onHide, onPageNotFound } from '@dcloudio/uni-app'
    
    onLaunch(() \=> {
        console.log('App Launch')
        
        // éšè—tabBar
        uni.hideTabBar()
        // åˆå§‹åŒ–
        initSysInfo()
    })
    
    onShow(() \=> {
        console.log('App Show')
    })
    
    onHide(() \=> {
        console.log('App Hide')
    })
    
    onPageNotFound((e) \=> {
        console.warn('Router Error>>', \` No match path "${e.path}" \`);
        uni.redirectTo({
            url: '/pages/404/index'
        })
    })
    
    const initSysInfo \= () => {
        uni.getSystemInfo({
            success: (e) \=> {
                // è·å–æ‰‹æœºçŠ¶æ€æ é«˜åº¦
                let statusBar = e.statusBarHeight
                let customBar
                
                // #ifndef MP
                customBar = statusBar + (e.platform == 'android' ? 50 : 45)
                // #endif
                
                // #ifdef MP-WEIXIN
                // è·å–èƒ¶å›ŠæŒ‰é’®çš„å¸ƒå±€ä½ç½®ä¿¡æ¯
                let menu = wx.getMenuButtonBoundingClientRect()
                // å¯¼èˆªæ é«˜åº¦ = èƒ¶å›Šä¸‹è·ç¦» + èƒ¶å›Šä¸Šè·ç¦» - çŠ¶æ€æ é«˜åº¦
                customBar = menu.bottom + menu.top - statusBar
                // #endif
                
                // #ifdef MP-ALIPAY
                customBar = statusBar + e.titleBarHeight
                // #endif
                
                // ç›®å‰globalDataåœ¨vue3 setupæ”¯æŒæ€§ä¸å¥½ï¼Œæ”¹ä¸ºprovide/injectæ–¹å¼
                provide('globalData', {
                    statusBarH: statusBar,
                    customBarH: customBar,
                    platform: e.platform
                })
            }
        })
    }
</script>

ç”±äºåº•éƒ¨tabbaré‡‡ç”¨è‡ªå®šä¹‰ç»„ä»¶ï¼Œæ‰€ä»¥åœ¨onLaunchä¸­ç»™éšè—æ‰ç³»ç»ŸtabbaråŠŸèƒ½ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627003721509-1469167450.png)

å¦‚ä¸Šå›¾ï¼šåœ¨vue3 setupä¸­globalDataæœ‰å…¼å®¹æ€§é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨äº†provide/injectæ›¿ä»£æ–¹æ¡ˆã€‚

### **â—† uniapp vue3æ¸²æŸ“markdownè¯­æ³•+ä»£ç é«˜äº®**

uni-chatgptèƒ½å¾ˆå¥½çš„å…¼å®¹é€‚é…Â **h5+å°ç¨‹åº+Appç«¯**Â è§£æmarkdownè¯­æ³•åŠä»£ç é«˜äº®æ˜¾ç¤ºã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627004606258-312937200.jpg)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627004627111-725339449.jpg)

è‡³äºå¦‚ä½•åœ¨uniappä¸­å®ç°è§£æmarkdownè¯­æ³•æ¨¡æ¿ä»¥åŠè§£å†³é”®ç›˜æ’‘èµ·é¡µé¢å¸ƒå±€é—®é¢˜ï¼Œå¤§å®¶å¯ä»¥å»çœ‹çœ‹ä¹‹å‰çš„è¿™ç¯‡æ–‡ç« ã€‚

[https://www.cnblogs.com/xiaoyan2017/p/17502105.html](https://www.cnblogs.com/xiaoyan2017/p/17502105.html)

### **â—† uniappå¤šåŠŸèƒ½Inputè¾“å…¥ç¼–è¾‘æ¡†**

ä¸ºäº†æ•´ä½“é£æ ¼ä¸€è‡´ï¼Œä¼šè¯ç¼–è¾‘æ¡†é‡‡ç”¨è‡ªå®šä¹‰ç»„ä»¶å®ç°åŠŸèƒ½ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627005226891-1454107158.png)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627005305155-1922649685.png)

ç›®å‰å…¼å®¹h5+å°ç¨‹åº+Appç«¯ï¼Œæ”¯æŒinputå•è¡Œæ–‡æœ¬ã€textareaå¤šè¡Œæ–‡æœ¬ï¼Œå¯è‡ªé€‚åº”é«˜åº¦ï¼Œè‡ªå®šä¹‰å‰ç¼€/åç¼€æ’æ§½åŠå¯†ç è¾“å…¥ç­‰åŠŸèƒ½ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627011224518-1516348240.png)

<template\>
    <div
        class\="ve\_\_input"
        :class\="\[
            preClass,
            isClass,
            sizeClass,
            {'is-disabled': isDisabled},
            {'is-resizable': type == 'textarea' && !autosize},
            {'ve\_\_input--group': $slots.prepend || $slots.append},
            {'ve\_\_input--group\_\_prepend': $slots.prepend},
            {'ve\_\_input--group\_\_append': $slots.append}
        \]"
    \>
            <!-- å‰ç½®æ’æ§½(prepend slot) \-->
            <div v-if\="$slots.prepend" class\="ve\_\_input--prepend"\><slot name\="prepend" /></div\>

            <div class\="ve\_\_input-wrapper"\>
                <!-- è¾“å…¥æ¡†å‰ç¼€ \-->
                <div v-if\="$slots.prefix || prefixIcon" class\="ve\_\_input--prefix"\>
                    <span class\="ve\_\_input--prefix\_\_inner"\>
                        <slot name\="prefix" />
                        <i v-if\="prefixIcon" class\="iconfont" :class\="prefixIcon"\></i\>
                    </span\>
                </div\>

                <template v-if\="type != 'textarea'"\>
                    <input
                        class\="ve\_\_input-inner"
                        ref\="inputRef"
                        :type\="showPassword ? (passwordVisible ? 'text' : 'password') : type"
                        :value\="modelValue"
                        :name\="name"
                        :maxlength\="maxlength"
                        :readonly\="readonly"
                        :disabled\="isDisabled"
                        :placeholder\="placeholder"
                        :cursor-spacing\="15"
                        :focus\="autofocus"
                        @focus\="handleFocus"
                        @blur\="handleBlur"
                        @input\="handleInput"
                        @change\="handleChange"
                        @keydown\="handleKeydown"
                    />
                </template\>
                <template v-else\>
                    <textarea
                        class\="ve\_\_input-inner ve\_\_textarea-inner"
                        ref\="textareaRef"
                        :value\="modelValue"
                        :maxlength\="maxlength"
                        :readonly\="readonly"
                        :disabled\="isDisabled"
                        :placeholder\="placeholder"
                        :show-confirm-bar\="false"
                        :adjust-position\="false"
                        :cursor-spacing\="15"
                        :focus\="autofocus"
                        :auto-height\="isTrue(autosize) || isObject(autosize)"
                        :style\="textareaStyle"
                        @focus\="handleFocus"
                        @blur\="handleBlur"
                        @input\="handleInput"
                        @change\="handleChange"
                        @keydown\="handleKeydown"
                    />
                </template\>

                <!-- è¾“å…¥æ¡†åç¼€ \-->
                <div v-if\="showSuffixVisible" class\="ve\_\_input--suffix" @click\="handleSearch" @mousedown.prevent\>
                    <span class\="ve\_\_input--suffix\_\_inner"\>
                        <!-- åç¼€ \-->
                        <template v-if\="!showClear || !showPwdVisible"\>
                            <slot name\="suffix" />
                            <i v-if\="suffixIcon" class\="iconfont" :class\="suffixIcon"\></i\>
                        </template\>
                        <!-- æ¸…é™¤ \-->
                        <i v-if\="showClear" class\="iconfont ve-icon-close-circle ve\_\_input-clear" @click\="handleClear" @mousedown.prevent\></i\>
                        <!-- å¯†ç å¯è§ \-->
                        <i v-if\="showPwdVisible" class\="iconfont ve-icon-hide ve\_\_input-password" :class\="{'ve-icon-eye1': passwordVisible}" @click\="handlePwdVisible" @mousedown.prevent @mouseup.prevent\></i\>
                        <!-- é™åˆ¶å­—æ•° \-->
                        <em v-if\="showLimitWordVisible" class\="ve\_\_input-limitword"\>{{inputLength}} / {{maxlength}}</em\>
                    </span\>
                </div\>
            </div\>

            <!-- åç½®æ’æ§½(append slot) \-->
            <div v-if\="$slots.append" class\="ve\_\_input--append" @click\="handleSearch" @mousedown.prevent\><slot name\="append" /></div\>
    </div\>
</template\>

<template\>
    <view class\="ugpt\_\_editor"\>
        <view class\="ugpt\_\_editor-inner flexbox"\>
            <u-button class\="btn" shape\="circle" @click\="handleUploadImage"\><text class\="iconfont ve-icon-image fs-32"\></text\></u-button\>
            <u-button class\="btn" shape\="circle" @click\="showPopover=true"\><text class\="iconfont ve-icon-yuyin1 fs-32"\></text\></u-button\>
            <ua-input
                class\="flex1"
                v-model\="editorText"
                type\="textarea"
                :autosize\="{maxRows: 6}"
                clearable
                placeholder\="Prompt..."
                @clear\="handleClear"
            />
            <u-button type\="success" shape\="circle" :disabled\="!editorText" @click\="handleSubmit" style\="transform: scale(.8);width: auto;"\><text class\="iconfont ve-icon-send-o"\></text\></u-button\>
        </view\>
    </view\>
</template\>

### **â—† uniappé…ç½®vite.config.js**

ä½¿ç”¨hbuilderxæ„å»ºçš„uniappé¡¹ç›®åŒæ ·æ”¯æŒ.envæ–‡ä»¶åŠvite.config.jsé…ç½®ã€‚æ”¯æŒä¿®æ”¹é»˜è®¤è¿è¡Œç«¯å£ã€‚

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627012044557-1301066233.png)

import { defineConfig, loadEnv } from 'vite'
import uni from '@dcloudio/vite-plugin-uni'
import { resolve } from 'path'
import { parseEnv } from './utils/env'

// https://vitejs.dev/config/
export default defineConfig(({ command, mode }) => {
    const viteEnv \= loadEnv(mode, \_\_dirname)
    const env \= parseEnv(viteEnv)

    return {
        plugins: \[
            uni()
        \],
        
        define: {
            // è‡ªå®šä¹‰ç¯å¢ƒå˜é‡
            'process.env.VITE\_APPNAME': JSON.stringify('uniapp-chatgpt'),
            'process.env.VITE\_ENV': env
        },

        // base: '/',
        // mode: 'development', // Default: 'development' for serve, 'production' for build

        /\*æ„å»ºé€‰é¡¹\*/
        esbuild: {
            // æ‰“åŒ…å»é™¤ console.log å’Œ debugger
            drop: env.VITE\_DROP\_CONSOLE && command === 'build' ? \["console", "debugger"\] : \[\]
        },

        /\*å¼€å‘æœåŠ¡å™¨é€‰é¡¹\*/
        server: {
            // ç«¯å£
            port: env.VITE\_PORT,
            // è¿è¡Œæ—¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
            open: env.VITE\_OPEN,
            // ä»£ç†é…ç½®
            proxy: {
                // ...
            }
        }
    }
})

OKï¼ŒåŸºäºuniapp+vue3æ„å»ºè·¨ç«¯ä»¿åˆ¶chatgptæ¨¡æ¿å°±åˆ†äº«åˆ°è¿™é‡Œï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©~~ğŸ’ª

**æœ€åé™„ä¸Šä¸€ä¸ªvue3+electron25æ¡Œé¢ç«¯å®ä¾‹é¡¹ç›®**

[https://www.cnblogs.com/xiaoyan2017/p/17468074.html](https://www.cnblogs.com/xiaoyan2017/p/17468074.html)

![](https://img2023.cnblogs.com/blog/1289798/202306/1289798-20230627012531745-75671610.gif)

æœ¬æ–‡ä¸ºåšä¸»åŸåˆ›æ–‡ç« ï¼Œæœªç»åšä¸»å…è®¸ä¸å¾—è½¬è½½ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·äº¤æµ QQï¼ˆ282310962ï¼‰ wxï¼ˆxy190310ï¼‰