---
layout: post
title: "阿里云ASK试用心得(避坑贴)"
date: "2023-06-22T01:16:29.384Z"
---
阿里云ASK试用心得(避坑贴)
===============

### 前言

常年BP阿里云的各种服务,今天却被阿里云给上了一课,这一套组合拳把我安排的明明白白,血亏50大洋,算是提前为各位大佬排坑了,预祝大家端午快乐  
![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621154204382-1248528709.png)

### 目的

最近阿里云首页放出了免费试用的活动,本着不用白不用的原则,直接申请容器服务ASK,上面显示个人账号有7天体验期,作为学习完全是够用了,之前也有k8s相关经验,这次的目的主要是研究KubernetesClient相关API,为后面的devops做准备

[试用地址](https://free.aliyun.com/?product=9596839&spm=5176.28055625.J_5831864660.8.e939154a1Bus4p&scm=20140722.M_9553144.P_154.MO_1802-ID_9553144-MID_9553144-CID_20080-ST_7663-V_1 "试用地址")

![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621154451601-1164732969.png)

**划重点,很多人还搞不懂ASK跟ECI是什么意思,ASK可以理解成k8s集群,ECI就是k8s的节点,Pod是部署在ECI上的,记住我图上圈起的部分,后面要考**

### 注意事项

*   1.容器仓库与集群区域问题  
    我使用的阿里云的镜像仓库(杭州),ASK集群(北京),导致拉取镜像失败,失败原因是pod无法访问公网,需要开通SNAT(收费),这种方式就不考虑了,最简单的办法就是镜像仓库与集群在一个区域,这样可以使用内网拉取镜像
    
*   2.公网IP问题  
    新开通的ASK集群是没有公网IP的,本地的Lins(客户端)想要操作整个集群就必须要申请一个公网ip,KubernetesClient也是同理,这里申请公网即可(需要付费,选择按量付费),然后集群绑定公网ip,生成KubeConfig.yml,就可用于客户端操作集群
    
*   3.Ingress问题  
    Ingress需要先安装Nginx Ingress Controller组件,我这边安装后依旧无法使用,提交了工单,运维反馈需要刷新绑定的域名(刷新集群),刷新后可以正常使用
    
*   4.ECI扣费问题  
    不要轻易使用这个产品,里面的坑特别多,稍有不慎就会扣费,昨天刚冲的50大洋,早上醒来发现倒欠阿里云11块,而且阿里云的客服也是厉害,我算是服了
    

### 客服聊天截图(吃瓜)

总结就是阿里云的ECI收费,在组件管理里添加的组件也会使用ECI资源(哪怕是核心组件),开始截图上的免费ECI仅仅够ASK集群,所以你添加prometheus,nginx-ingress都会产生费用,更别谈自己工作的pod了,并且这些ECI都是预付费,在使用ASK集群的时候自动创建,不会有扣费提示,当没有ECI资源的时候,集群所有页面都会报错,导致集群不可用

![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161943025-2078518869.png)

*   1.客服A (尝试申请代金券)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160307820-1797185993.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160401458-322150090.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160451891-129531922.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160542650-1082456301.png)
    
*   2.客服B  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160830308-792301984.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160852210-1732527132.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160917884-1013963790.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621160924836-1922730184.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161024657-767775721.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161046182-1223513883.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161103412-721885073.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161115212-911690985.png)  
    ![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621161146188-1077860259.png)
    

![image](https://img2023.cnblogs.com/blog/772322/202306/772322-20230621155208946-2128375000.png)