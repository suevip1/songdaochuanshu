---
layout: post
title: "ä¸ºreacté¡¹ç›®æ·»åŠ å¼€å‘/æäº¤è§„èŒƒï¼ˆå‰ç«¯å·¥ç¨‹åŒ–ã€eslintã€prettierã€huskyã€commitlintã€stylelintï¼‰"
date: "2023-08-07T01:06:49.274Z"
---
ä¸ºreacté¡¹ç›®æ·»åŠ å¼€å‘/æäº¤è§„èŒƒï¼ˆå‰ç«¯å·¥ç¨‹åŒ–ã€eslintã€prettierã€huskyã€commitlintã€stylelintï¼‰
===================================================================

å› å†å²é—ç•™åŸå› ï¼Œæ¥æ‰‹çš„é¡¹ç›®æ²¡æœ‰ä»£ç æé†’/æ ¼å¼åŒ–ï¼ŒåŒ…æ‹¬ eslintã€pretttierï¼Œä¹Ÿæ²¡æœ‰ commit æäº¤æ ¡éªŒï¼Œå¦‚ huskyã€commitlintã€stylelintï¼Œä¸å…¶æœŸå¾…è‡ªå·±æˆ–è€…åŒäº‹çš„ä»£ç å†™å¾—å®Œç¾æ— ç¼ºï¼Œä¸å¦‚é€šè¿‡ä¸€äº›å·¥å…·æ¥è¿›è¡Œè§„èŒƒå’Œçº¦æŸã€‚

### eslint

eslint æ˜¯ä¸€ä¸ªä»£ç æ ¡éªŒå·¥å…·ï¼Œç”¨æ¥è§„èŒƒé¡¹ç›®ä»£ç é£æ ¼ã€‚

#### åˆå§‹åŒ–

é€šè¿‡ `npm install eslint` åä½¿ç”¨ `npx eslint --init` æ¥æ ¹æ®é—®ç­”ç”Ÿæˆ `.eslintrc.js` é…ç½®æ–‡ä»¶ã€‚æˆ‘çš„é¡¹ç›®æ˜¯ React + JavaScriptï¼Œè¿™é‡Œé€‰æ‹©äº† Airbnd çš„è§„åˆ™æ¥æ ¡éªŒï¼Œä¸åŒçš„é¡¹ç›®ç±»å‹å¯ä»¥è¿›è¡Œå…¶å®ƒçš„é€‰æ‹©ã€‚é…ç½®è¯¦ç»†ä»‹ç»å¯ä»¥å‚è€ƒè¿™ä¸€ç¯‡ [è§„èŒƒä»£ç ç¼–å†™é£æ ¼å°±ç”¨ eslint å’Œ prettier](https://www.cnblogs.com/vigourice/p/16275015.html) ã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173205011-568055647.png)

ç”Ÿæˆçš„ `.eslintrc.js` æ–‡ä»¶åŒ…å«å½“å‰ eslint é…ç½®çš„è§„åˆ™ï¼Œåœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨ `npx eslint ./xxx.js` æ–‡ä»¶æ—¶ï¼Œeslint å°±ä¼šè¯»å–é¡¹ç›®çš„é…ç½®æ–‡ä»¶å¯¹å…¶å†…å®¹è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœæ²¡æœ‰é…ç½®æ–‡ä»¶ï¼Œåˆ™ä¼šå‡ºç°å›¾ä¸­ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å‘½ä»¤çš„å›åº”ã€‚ã€Oopsï¼Something went wrong! ğŸ˜¦ ï¼ŒESLint couldn't find a configuration fileã€‘

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173214144-1689929874.png)

é€šè¿‡ `npx eslint` å¯ä»¥æ£€æµ‹å‡ºæ–‡ä»¶ä¸ç¬¦åˆè§„èŒƒçš„åœ°æ–¹ï¼Œå¢åŠ  `--fix` å‚æ•°å¯ä»¥è‡ªåŠ¨ä¿®å¤éƒ¨åˆ†é”™è¯¯ã€‚ä½†æˆ‘ä»¬å¼€å‘çš„è¿‡ç¨‹ä¸­ä¹Ÿå¾ˆå°‘ä¼šé€šè¿‡å‘½ä»¤æ£€æµ‹æ–‡ä»¶ä»£ç æ˜¯å¦è§„èŒƒï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ—¶åˆ»æ£€æµ‹ä»£ç ï¼Œå½“ä»£ç å‡ºç°é—®é¢˜æ ‡çº¢æç¤ºï¼Œå¹¶ä¸” ctrl + s ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–çš„å·¥å…·å°±å¥½äº†ï¼vscode æ’ä»¶æ¥æ»¡è¶³ä½ ä»¥ä¸Šè¦æ±‚

#### vscode æ’ä»¶

å®‰è£…ã€eslintã€‘æ’ä»¶

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173225305-502183572.png)

å¹¶åœ¨ vscode çš„ settings.json ä¸­è¿›è¡Œå¢åŠ é…ç½®ï¼Œå³å¯äº«å—å®æ—¶æ ¡éªŒä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¹¶ä¿å­˜åè‡ªåŠ¨ä¿®å¤çš„åŠŸèƒ½ã€‚

    // settings.json
    Â "editor.codeActionsOnSave": {
    Â  Â  "source.fixAll.eslint": true,
    },
    

### prettier

prettier ä¹Ÿä¼šå¯¹ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œå’Œ eslint ä¸¤è€…çš„åŒºåˆ†åœ¨äºï¼Œeslint æ ¡éªŒçš„èŒƒå›´ä¼šåå‘äºä»£ç æ˜¯å¦ä¼˜é›…ï¼Œæ¯”å¦‚æ˜¯å¦å­˜åœ¨ console è¯­å¥ã€æ˜¯å¦å£°æ˜å‡½æ•°ä½†æœªä½¿ç”¨ï¼Œè€Œ prettier æ›´ä¾§é‡äºæ ¼å¼ï¼Œæ¯”å¦‚ä¸€è¡Œå±•ç¤ºå¤šå°‘ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨å•å¼•å·è¿˜æ˜¯åŒå¼•å·ã€‚

#### é…ç½®

é¦–å…ˆé€šè¿‡ `npm install prettier` å®‰è£…ä¾èµ–ï¼Œç„¶åå†æ–°å¢é…ç½®æ–‡ä»¶ `.prettierrc.js` ï¼Œåœ¨æ–‡ä»¶é‡Œå®šä¹‰éœ€è¦çš„é…ç½®ï¼Œè¯¦ç»†å­—æ®µå¯ä»¥å‚è€ƒ[å®˜ç½‘](https://prettier.io/docs/en/options.html)ã€‚

    // .prettierrc.js
    module.exports = {
    Â  printWidth: 100,
    Â  semi: true,
    Â  singleQuote: true,
    Â  tabWidth: 2,
    };
    

åˆ¤æ–­æ˜¯å¦ç”Ÿæ•ˆç›´æ¥ä½¿ç”¨å‘½ä»¤ `npx prettier --write [æŒ‡å®šæ–‡ä»¶]` ï¼ŒæŸ¥çœ‹æ–‡ä»¶æ˜¯å¦æ ¹æ® prettier çš„è§„åˆ™æ ¼å¼åŒ–ã€‚

#### vscode æ’ä»¶

åŒ eslint ä¸€æ ·ï¼Œä½¿ç”¨ vscode æ’ä»¶ prettier æ¥å®ç°ä¿å­˜åè‡ªåŠ¨æ ¼å¼åŒ–  
![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173237825-286418466.png)

åœ¨ vscode é…ç½®æ–‡ä»¶ settings.json ä¸­éœ€è¦è®¾ç½®æ ¼å¼åŒ–çš„å·¥å…·ï¼Œé»˜è®¤ä½¿ç”¨ prettier æ¥æ‰§è¡Œã€‚

    // settings.json
    "editor.defaultFormatter": "esbenp.prettier-vscode"
    
    // å¦‚æœä¸ç”Ÿæ•ˆï¼Œå¯èƒ½è¦é’ˆå¯¹æ¯ç§ç±»å‹çš„æ–‡ä»¶æ¥æ‰§è¡Œæ ¼å¼åŒ–è§„åˆ™
    "[javascript]": {
        "editor.defaultFormatter": "esbenp.prettier-vscode"
    },
    

è®¾ç½®å®Œä¹‹åæŒ‰ä½ ctrl + sï¼Œè‡ªåŠ¨ä¿å­˜ä¸º .prettier çš„æ–‡ä»¶ç‰ˆæœ¬ï¼Œæ­¤æ—¶å¯èƒ½ä¸ eslint æ ¡éªŒä¼šå­˜åœ¨å†²çªï¼Œåœ¨ eslint æ’ä»¶çš„æ£€æŸ¥ä¸‹ï¼Œä¸ eslint ä¸ä¸€è‡´çš„éƒ¨åˆ†ä»ç„¶ä¼šæ ‡çº¢ã€‚æ‰€ä»¥éœ€è¦å°† eslint è§„åˆ™å’Œ prettier ä¿æŒä¸€è‡´ã€‚

é€šè¿‡ä»¥ä¸Šæœ¬åœ°è®¾ç½®ï¼Œå¯ä»¥è§„èŒƒè‡ªå·±çš„å¼€å‘ï¼Œä½†å¤šäººå¼€å‘æ—¶éš¾å…ä¼šå­˜åœ¨æœ‰äº›å¼€å‘è€…æäº¤çš„ä»£ç ä¸è§„èŒƒï¼Œé‚£æˆ‘ä»¬å¯ä»¥åœ¨æäº¤æ—¶è®¾ç½®ä¸€ä¸ªå…³å¡ï¼Œé€šè¿‡ git ä»£ç æäº¤æ—¶çš„é’©å­æ¥é˜»æŒ¡ä¸è§„èŒƒçš„æäº¤ã€‚

### git hooks

åœ¨ç½‘ç»œä¸Šæ‰¾åˆ°ä¸€å¼  git hooks æ‰§è¡Œæµç¨‹å›¾ç¤ºï¼Œä» `git commit` å¼€å§‹æœ‰ä¸€äº›å¡ç‚¹ï¼Œæˆ‘ä»¬ä¸»è¦åº”ç”¨çš„é’©å­æ˜¯ `pre-commit`ï¼ˆé€šè¿‡eslintæ£€æµ‹ä¸‹æ˜¯å¦æœ‰æŠ¥é”™ä»£ç ï¼‰ã€`commit-msg`ï¼ˆæäº¤çš„messageæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼‰

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806174133095-146998952.png)

#### .git/hooks

é¡¹ç›®æ ¹ç›®å½•åˆå§‹åŒ–æ—¶å°±ä¼šå­˜åœ¨ .git æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­ hooks æ–‡ä»¶å¤¹åŒ…å«äº† git æ•´ä¸ªæµç¨‹çš„é’©å­ï¼Œå½“å‰æ–‡ä»¶åç¼€ä»¥ .sample ç»“å°¾ï¼Œå»é™¤æ‰ .sample åç¼€å¹¶åˆ¶å®šæ ¡éªŒè§„åˆ™ä¼šç›´æ¥ç”Ÿæ•ˆã€‚

è¿™é‡Œä¿®æ”¹äº† `pre-commit` çš„è§„åˆ™ï¼Œä¸ºäº†æ¼”ç¤ºç›´æ¥è®¾ç½®æ ¡éªŒæŒ‡å®šæ–‡ä»¶ï¼Œæ­£å¸¸åº”è¯¥æ˜¯æ£€æµ‹ä½¿ç”¨ git add æ·»åŠ åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œæ²¡æœ‰é€šè¿‡ eslint æ ¡éªŒæ—¶ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œ git commitã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806174233995-1255470806.png)

ä½†æˆ‘ä»¬å‘ç°ï¼Œå³ä½¿ä¿®æ”¹äº† .git/hooks æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ï¼Œä¹Ÿä¸ä¼šæ˜¾ç¤ºæ–‡ä»¶ä¿®æ”¹ï¼Œæ›´æ²¡æ³•å°†å…¶æ·»åŠ åˆ°æš‚å­˜åŒºã€æœ¬åœ°ä»“åº“ç”šè‡³åˆ°è¿œç¨‹ä»“åº“ï¼Œå…¶ä»–åŒäº‹æ‹‰å–ä»£ç åæäº¤ä»ç„¶ä¸ä¼šæœ‰æ ¡éªŒã€‚

#### è‡ªå®šä¹‰æ–‡ä»¶ä¸‹çš„hooks

æ—¢ç„¶ .git æ–‡ä»¶ä¸ä¼šæäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸ªä»£ç å¯ä»¥è¢«è·Ÿè¸ªçš„åœ°æ–¹ï¼Œå¹¶ä¸”å‘Šè¯‰ git æ‰§è¡Œå·¥ä½œæµçš„æ—¶å€™æ¥æˆ‘æŒ‡å®šçš„æ–‡ä»¶å¤¹æ‰§è¡Œæ–‡ä»¶ã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å¢æ–‡ä»¶å¤¹ .myhooksï¼ˆå…¶ä»–çš„ä¹Ÿå¯ä»¥ï¼‰ï¼Œæ–°å¢ pre-commit æ–‡ä»¶ï¼Œå¢åŠ  eslint çš„æ ¡éªŒï¼Œå¹¶ä¸”é€šè¿‡å‘½ä»¤`git config core.hooksPath .myhooks`ä¿®æ”¹ git æ‰§è¡Œ hooks çš„åœ°å€ï¼Œå¯è¿›å…¥ .git ç›®å½•æ‰§è¡Œ `cat config` æŸ¥çœ‹é…ç½®æ˜¯å¦ä¿®æ”¹ã€‚

å°† .git/hooks æ–‡ä»¶ä¸­çš„ .sample åç¼€æ¢å¤ï¼Œgit commit æ ¡éªŒä»ç„¶æ˜¯ç”Ÿæ•ˆçš„ï¼Œè¡¨ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰çš„ hooks æ˜¯æˆåŠŸæ‰§è¡Œçš„ã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173308826-1740692044.png)

å¦‚æœå¸Œæœ›è¾¾åˆ°å…±äº«çš„ç›®çš„ï¼Œå°† .myhooks æ–‡ä»¶å¤¹æ¨é€åˆ°è¿œç¨‹åï¼Œéœ€è¦åœ¨ååŒå¼€å‘è€…çš„ç¬”è®°æœ¬éƒ½é…ç½® `git config core.hooksPath .myhooks`ï¼Œè¿™ä¸€æ­¥æ— è®ºæ˜¯æ‰‹åŠ¨æ•²å‘½ä»¤ï¼Œè¿˜æ˜¯é€šè¿‡å·¥å…·éƒ½æœ‰äº›è®¸éº»çƒ¦ï¼Œå†µä¸”ä¸åŒé¡¹ç›®ç›´æ¥è‡ªå®šä¹‰çš„ hooks æ–‡ä»¶è¿˜æœ‰å¯èƒ½ä¸åŒï¼Œé€ æˆç»´æŠ¤å›°éš¾ã€‚

### husky

é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œ`husky` ä¸ºæˆ‘ä»¬æä¾›äº†è§£å†³æ–¹æ¡ˆã€‚

#### é…ç½®

é€šè¿‡ `npm install husky` ä»¥åŠ `npx husky install` åœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆ .husky æ–‡ä»¶å¤¹ï¼Œå°† pre-commit æ–‡ä»¶ä»è‡ªå®šä¹‰çš„æ–‡ä»¶å¤¹ä¸­ç§»è¿‡æ¥ã€‚

å¢åŠ  package.json çš„é…ç½®ï¼Œåœ¨æ‰§è¡Œ npm install ä¹‹åä¼šæ‰§è¡Œ npm run prepared ï¼Œè¿™æ ·æ¯æ¬¡æ–°å¢ä¾èµ–æ—¶ï¼Œä¼šæ›´æ–° huskyã€‚

    // package.json
    "script": {
      "prepared": "husky install"
    }
    

#### åŸç†

æ­¤æ—¶å†æ‰§è¡Œ git commit æ“ä½œæ—¶ï¼Œå’Œå‰é¢æˆ‘ä»¬çœ‹åˆ°çš„æ ¡éªŒæ˜¯ä¸€è‡´çš„ã€‚å…¶å® husky çš„å®ç°åŸç†å’Œæˆ‘ä»¬è‡ªå®šä¹‰ hooks çš„ä¸€è‡´ï¼Œé€šè¿‡å‘½ä»¤è¡Œå»æ”¹å˜æ‰§è¡Œ git hooks çš„ä½ç½®ã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173348636-2100339964.png)

é€šè¿‡ husky å¯ä»¥å…±äº« git hooks çš„æ ¡éªŒè§„èŒƒï¼Œä½†æ˜¯æˆ‘ä»¬åº”è¯¥å¯¹å“ªäº›æ–‡ä»¶è¿›è¡Œæ ¡éªŒå‘¢ï¼Ÿ

ä»¥ä¸Šä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œä½¿ç”¨ eslint å»æ ¡éªŒæŒ‡å®šæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚ src ï¼Œä½†è¿™æ ·çš„æ ¡éªŒæ–¹å¼ä¼šå¯¼è‡´æˆ‘æ˜æ˜åªä¿®æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå´éœ€è¦å»ä¿®å¤å®Œsrcç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„ bug æ‰èƒ½æäº¤ï¼Œæå¤§å¢åŠ äº†å¼€å‘éš¾åº¦ã€‚

æ­£ç¡®çš„æ–¹æ¡ˆåº”è¯¥æ˜¯å¢é‡æ£€æµ‹ï¼Œåªæ£€æµ‹ä½¿ç”¨ git add æ·»åŠ åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå¦‚æœè¿™éƒ¨åˆ†æ–‡ä»¶æœ‰é—®é¢˜ï¼Œä¿®å¤å³å¯æäº¤ã€‚

### lint-staged

lint-staged å°±å¯ä»¥å®ç°å¯¹äºæš‚å­˜åŒºçš„æ£€æµ‹ã€‚

#### é…ç½®

ä½¿ç”¨ `npm install lint-staged` å®‰è£…åï¼Œåœ¨ package.json ä¸­é…ç½® lint-staged æŒ‡ä»¤ï¼Œå› ä¸ºéœ€è¦ä½¿ç”¨åˆ° eslint å’Œ prettier çš„è‡ªåŠ¨ä¿®å¤ï¼Œæ‰€ä»¥è¿˜éœ€è¦å°†ä»–ä»¬æ·»åŠ åˆ° script å±æ€§ä¸­ã€‚

    // package.json
    "script": {
    Â  "eslint-fix": "eslint --fix", // æ–°å¢eslintçš„è§„åˆ™ï¼Œ --fix è¡¨ç¤ºè‡ªåŠ¨ä¿®å¤
    Â  "prettier-format": "prettier --write", // æ–°å¢eslintçš„è§„åˆ™ï¼Œ --write è¡¨ç¤ºè‡ªåŠ¨ä¿®å¤
    }
    "lint-staged": {
        "*.{js,jsx,,ts,tsx}": [
            "npm run eslint-fix",
            "npm run prettier-format"    
        ]
    }
    

ç„¶ååœ¨ .husky/pre-commit å°† npx eslint ä¿®æ”¹æˆ `npx lint-staged`ï¼Œå†æ¬¡æ‰§è¡Œ git commit å°±å¯ä»¥ eslint åªå¯¹æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œæ ¡éªŒã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173407475-1330059488.png)

### commitlint

ä»¥ä¸Šæ˜¯æ‰§è¡Œ commit æ“ä½œä¹‹å‰å¯¹äºæš‚å­˜åŒºä»£ç è¿›è¡Œæ ¡éªŒï¼Œé˜²æ­¢ä¸è§„èŒƒçš„ä»£ç æäº¤ï¼Œåœ¨æäº¤æ—¶è¿˜æœ‰ä¸€é¡¹éœ€è¦æ³¨æ„ï¼šæäº¤çš„æ³¨é‡Šå†…å®¹ï¼ˆgit commit -m åè·Ÿçš„å¼•å·ä¸­å†…å®¹ï¼‰æ˜¯å¦æ¸…æ™°ï¼Œå›æº¯ git æäº¤è®°å½•æ—¶ï¼Œä¸æ¸…æ™°çš„æè¿°å¯¼è‡´æ’æŸ¥é—®é¢˜ã€å¯»æ‰¾åŠŸèƒ½ä¼šéå¸¸ä½æ•ˆã€‚

ä¸ºäº†ä¿è¯æäº¤æ³¨é‡Šçš„å¯é˜…è¯»æ€§ï¼Œç»Ÿä¸€ä½¿ç”¨çš„è§„èŒƒæ ¼å¼ä¸º `<type>: <subject>`ï¼ˆsubjectå‰é¢æœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰ã€‚

*   type ä»£è¡¨æ ‡è¯†ï¼Œæ¯”å¦‚ï¼šfeatï¼ˆæ–°ç‰¹æ€§ï¼‰ã€fixï¼ˆä¿®å¤bugï¼‰ã€styleï¼ˆæ ·å¼è°ƒæ•´ï¼‰ã€refactorï¼ˆé‡æ„ï¼‰ã€docsï¼ˆæ–‡æ¡£è¯´æ˜ï¼‰
*   subject å¯¹äºæ­¤æ—¶æäº¤çš„æè¿°ä¿¡æ¯

#### é…ç½®

ä»¥ä¸Šå±äºå£å¤´è§„èŒƒï¼Œå¾ˆæœ‰å¯èƒ½ä¸è¢«éµå®ˆï¼Œä¸ºäº†ä¿è¯æäº¤è§„èŒƒä¸€è‡´ï¼Œè¿˜éœ€è¦å¢åŠ è¿™äº›é…ç½®ã€‚

é¦–å…ˆå®‰è£…æäº¤æ ¡éªŒè§„èŒƒæ‰€éœ€è¦çš„ä¾èµ–ï¼Œ`npm install @commitlint/cli @commitlint/config-conventional -D`

æ–°å¢ .commitlintrc.js é…ç½®æ–‡ä»¶ï¼Œè®¾ç½® commit å¤‡æ³¨ä¿¡æ¯çš„æ ¡éªŒæ–¹æ¡ˆã€‚

    // .commitlintrc.js
    module.exports = {
    Â  extends: ['@commitlint/config-conventional'],
    };
    

#### commit-msgé’©å­

å†å›åˆ°è¿™å¼ å›¾ï¼Œcommit-msg çš„é’©å­ æ˜¯æäº¤åˆ°æœ¬åœ°åº“ä¹‹å‰æ‰§è¡Œçš„ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µæ¥æ ¡éªŒ commit ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒæ¯”è¾ƒåˆé€‚ã€‚

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173422876-1165822741.png)

åœ¨ .husky æ–‡ä»¶å¤¹ä¸‹æ–°å¢ commit-msg æ–‡ä»¶ï¼Œå¢åŠ æ ¡éªŒå‘½ä»¤

    #!/bin/sh
    npx --no -- commitlint --edit ${1}
    

*   npx --no ï¼šè¡¨ç¤ºåªä½¿ç”¨é¡¹ç›® node\_modules ä¸‹çš„è„šæœ¬ï¼Œä¸å…è®¸æ‰¾ä¸åˆ°æ—¶ä¸‹è½½
*   commitment --edit <æ–‡ä»¶å>ï¼šæ‰§è¡Œ commitment å‘½ä»¤è¡Œå·¥å…·ï¼Œ--edit è¡¨ç¤ºä»æ–‡ä»¶ä¸­æå–commmitå†…å®¹
*   $1ï¼šæŒ‡å‘ .git/COMMIT\_EDITMSG æ–‡ä»¶ï¼Œè¿™é‡Œå­˜æ”¾ç€æœ€åä¸€æ¬¡ commit ä¿¡æ¯

![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173443301-1845811786.png)

ä»¥ä¸Šä¾¿å®Œæˆäº†å¯¹äº commit æ³¨é‡Šå†…å®¹çš„æ ¡éªŒã€‚æˆ‘ä»¬åœ¨é¡¹ç›®ä¸­å¸¸å®šä¹‰çš„æ–‡ä»¶ç±»å‹ï¼Œé™¤äº† jsï¼Œè¿˜æœ‰ css ï¼Œeslint å¯ä»¥å¯¹ js / jsx / vue ç­‰æ–‡ä»¶ç±»å‹è¿›è¡Œæ ¡éªŒï¼Œé‚£ä¹ˆ css ä¹Ÿéœ€è¦å¯ä»¥è§„èŒƒçš„å·¥å…·ã€‚

### stylelint

stylelint å¯ä»¥å®Œæˆå¯¹äº css/scss/less ç­‰æ ·å¼è¡¨æ–‡ä»¶çš„æ ¡éªŒï¼ŒåŠŸèƒ½ç±»ä¼¼äº eslint å¯¹äº jsæ–‡ä»¶ã€‚

#### é…ç½®

å› ä¸ºé¡¹ç›®ä½¿ç”¨çš„æ ·å¼è¡¨ä¸º scss æ ¼å¼ï¼Œæ‰€ä»¥å®‰è£…å¤„ç† scss æ–‡ä»¶çš„ä¾èµ–ï¼Œ`npm install stylelint stylelint-scss stylelint-config-recommended-scss -D`ï¼Œæ³¨æ„ stylelint éœ€è¦å®‰è£…åˆé€‚çš„ç‰ˆæœ¬ï¼Œå› ä¸ºç‰ˆæœ¬ä¸æ­£ç¡®çš„æŠ¥é”™ Errorï¼šUndefined rule annotation-no-unknow è€Œæ’æŸ¥äº†å¾ˆä¹…ã€‚

æ–°å¢ `stylelintrc.js` æ–‡ä»¶ï¼Œå‘Šè¯‰ stylelint æ ¡éªŒè§„åˆ™

    module.exports = {
      extends: ['stylelint-config-recommended-scss'],
    };
    

#### æ’ä»¶

å’Œ eslint / prettier ç›¸ä¼¼ï¼Œå®ƒä¹Ÿæœ‰ vscode æ’ä»¶åœ¨ç¼–è¾‘æ—¶ css/scss æ–‡ä»¶æ—¶æŒ‰ä½ ctrl+s å®ç°ä»£ç è‡ªåŠ¨æ ¼å¼åŒ–  
![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173452846-1450106291.png)

vscode éœ€è¦å¢åŠ ä¸€äº›é…ç½®

    // settings.json
    "editor.codeActionsOnSave": {
        "source.fixAll.stylelint": true
     },
     "stylelint.validate": ["css", "scss"],
    

#### commit

å’Œ eslint ä¸€æ ·ï¼Œåœ¨æäº¤æ—¶è®¾ç½®æ ¡éªŒé¿å…ä¸è§„èŒƒçš„ css ä»£ç æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œéœ€è¦åœ¨ package.json ä¸­å¢åŠ é…ç½®ã€‚

    "script": {
    Â  "eslint-fix": "eslint --fix",
    Â  "prettier-format": "prettier --write",
      "stylelint-fix": "stylelint --fix"  // æ–°å¢stylelintçš„è§„åˆ™ï¼Œ --fix è¡¨ç¤ºè‡ªåŠ¨ä¿®å¤
    }
    "lint-staged": {
        "*.{js,jsx,,ts,tsx}": [
            "npm run eslint-fix",
            "npm run prettier-format"
        ],
        Â "*.{css,scss}":[
    Â  Â  Â  "npm run stylelint-fix" // æ–°å¢ stylelint æ ¡éªŒ
    Â  Â  ]
    }
    

stylelint ä¹ŸåŒæ ·æ˜¯ä½œç”¨äºæš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå’Œ eslintã€prettier ä¸€æ ·ï¼Œåªæ˜¯æ ¡éªŒä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹Ÿé…ç½®åœ¨ å› ä¸ºä¹‹å‰åœ¨ lint-staged çš„è§„åˆ™ä¸­ï¼Œåœ¨ pre-commit æ–‡ä»¶ä¸­ä¸éœ€è¦å¢æ·»æ–°çš„å‘½ä»¤ã€‚

åœ¨æäº¤æ–‡ä»¶æ—¶å°±å¯ä»¥çœ‹åˆ°å¯¹äº css/scss ç­‰æ ·å¼è¡¨çš„æ£€æµ‹ï¼Œå¦‚æœæŠ¥é”™ä¼šç»ˆæ­¢æäº¤ã€‚  
![](https://img2023.cnblogs.com/blog/1408181/202308/1408181-20230806173504226-1768582772.png)

### æ€»ç»“

*   eslint ç”¨æ¥è§„èŒƒ js/ts/jsx ç­‰ç±»å‹æ–‡ä»¶ç¼–ç æ—¶è¯­æ³•
*   prettier ä¿éšœ js/ts/jsx ç­‰ç±»å‹æ–‡ä»¶ç¼–ç æ—¶æ ¼å¼
*   husky ä¸ºæ‰§è¡Œ git commit æ“ä½œè®¾ç½®å¡ç‚¹ï¼Œé¿å…ä¸è§„èŒƒæäº¤
*   lint-staged ä¿è¯æ ¡éªŒçš„åŒºåŸŸåªåœ¨æš‚å­˜åŒº
*   commlint ä½¿å¾—commit msgæŒ‰ç…§æ—¢å®šæ ¼å¼
*   stylelint ç¡®ä¿ css/scss ç±»æ ·å¼è¡¨æ–‡ä»¶ä¹Ÿèƒ½æ˜“è¯»ç»Ÿä¸€

ä»¥ä¸Šå·¥å…·/æ’ä»¶åœ¨ç®€åŒ–å‰ç«¯å¼€å‘æµç¨‹ï¼Œè§„èŒƒä»£ç æ ¼å¼ä¸Šæœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œç¥æˆ‘ä»¬éƒ½èƒ½å†™å‡ºä¼˜é›…çš„ä»£ç ã€‚ä»¥ä¸Šå°±æ˜¯ `å‰ç«¯å·¥ç¨‹åŒ–ä¹‹reacté¡¹ç›®ç»Ÿä¸€ä»£ç è§„èŒƒ` ç›¸å…³å†…å®¹ï¼Œå…³äº `å‰ç«¯å¼€å‘`ï¼Œè¿˜æœ‰å¾ˆå¤šéœ€è¦å¼€å‘è€…æŒæ¡çš„åœ°æ–¹ï¼Œå¯ä»¥çœ‹çœ‹æˆ‘å†™çš„å…¶ä»–åšæ–‡ï¼ŒæŒç»­æ›´æ–°ä¸­~