---
layout: post
title: "【技术积累】C语言中的指针【一】"
date: "2023-06-24T01:23:14.331Z"
---
【技术积累】C语言中的指针【一】
================

博客推行版本更新，成果积累制度，已经写过的博客还会再次更新，不断地琢磨，高质量高数量都是要追求的，工匠精神是学习必不可少的精神。因此，大家有何建议欢迎在评论区踊跃发言，你们的支持是我最大的动力，你们敢投，我就敢肝

C语言中的指针是什么
==========

在C语言中，指针是一个变量，它存储的是内存地址。指针变量可以指向任何类型的数据，如整数、字符、浮点数或其他指针。通过指针可以间接访问和操作变量的值。

指针的主要目的是允许程序直接访问内存，而不是通过变量名来访问。这对于一些高级的编程任务，如动态内存分配、数据结构和函数指针等非常有用。

指针可以用来实现以下几个方面的功能：

1.  内存管理：通过指针，可以动态地分配和释放内存。这在需要灵活管理内存的情况下非常有用，比如动态数组、链表、树等数据结构。
    
2.  数组访问：指针可以用来遍历和访问数组中的元素。可以通过指针算术运算来移动指针位置，从而访问数组中的不同元素。
    
3.  传递参数：可以通过指针将变量的地址传递给函数，从而在函数内部修改变量的值。这样可以避免函数内部创建新的变量，节省内存开销。
    
4.  字符串处理：C语言的字符串是以字符数组的形式存储的，通过指针可以方便地处理字符串，比如拷贝、连接、比较等操作。
    
5.  动态分配内存：通过指针，可以使用标准库函数malloc()或calloc()动态地分配内存。这在需要根据程序运行时的需要分配不同大小的内存时非常有用。
    

需要注意的是，指针也有一些潜在的问题和风险。比如，未初始化的指针可能会导致程序崩溃。指针还可能引发内存泄漏或非法内存访问等问题，因此在使用指针时需要谨慎。

总体而言，指针是C语言中非常强大和灵活的概念，但同时也需要谨慎使用，因为指针操作涉及底层的内存管理和访问，容易引发内存泄漏、段错误等问题。

指针和变量的区别是什么
===========

在C语言中，指针和变量是两个不同的概念，它们有以下几点区别：

1\. 定义方式：变量需要先声明后定义，而指针需要先声明后使用。例如，变量的定义可以直接写为：int a；而指针需要先声明指针变量类型，然后通过取地址符&来获取变量的地址。

2\. 存储内容：变量存储的是具体的数值或数据，而指针存储的是变量或对象的地址。

3\. 内存占用：变量在内存中会占据一定的存储空间，而指针变量只会占据指针的固定大小（通常为4或8个字节，取决于系统的位数）。

4\. 用途：变量用于存储数据值，而指针主要用于动态内存分配、变量间的传递、数据结构等。

5\. 操作：变量可以直接对其进行算术运算、逻辑运算等操作，而指针主要用于访问指向的对象或变量，可以通过解引用操作符\*来获取指针指向的值。

总结来说，变量存储具体数值，而指针存储的是变量或对象的地址，指针是对变量的一种间接引用方式。通过指针，我们可以在程序中更加灵活地对内存进行操作，动态分配内存和传递变量。

如何获取一个变量的地址
===========

在C语言中，可以通过"取地址运算符(&)"来获取一个变量的地址。取地址运算符(&)可以在变量名前使用，以获取该变量的内存地址。

例如，假设有一个整型变量x，要获取它的地址，可以使用以下代码：

    int x;
    int *p; /* 定义一个指针变量p */
    
    p = &x; /* 将x的地址赋值给p */

在上面的代码中，"&x"表示获取变量x的地址，将这个地址赋值给指针变量p。然后，p就指向了x的地址。

需要注意的是，变量的地址是一个内存地址，通常以十六进制显示。在C语言中，可以使用"%p"格式说明符打印变量的地址，例如：

    printf("x的地址是：%p\n", p);

输出结果可能类似于：x的地址是：0x7ffe5b6a09e8。这个地址表示变量x在内存中的位置。

通过获取变量的地址，可以用指针来访问和修改该变量。例如，可以使用"\*"运算符来表示指针所指向的内存的值，例如：

    printf("x的值是：%d\n", *p);

输出结果就是变量x的值。

总结起来，要获取变量的地址，可以使用取地址运算符(&)；要获取指针所指向的内存的值，可以使用"\*"运算符。这些操作在C语言中常用于指针和内存管理。

如何声明一个指针变量？
===========

在C语言中，声明一个指针变量需要使用星号符号（\*）来表示该变量是一个指针。指针变量的声明需要指定指针所指向的数据类型。

声明一个指针变量的一般语法如下：

    data_type *pointer_name;

其中，data\_type表示指针所指向的数据类型，pointer\_name表示指针变量的名称。例如，声明一个指向整数类型的指针变量numPtr，可以使用以下代码：

    int *numPtr;

在这个例子中，int是指针所指向的数据类型，numPtr是指针变量的名称。

需要注意的是，指针变量的声明只是创建了一个指针变量，在声明时并没有为指针分配内存空间。如果在声明时要将指针指向一个变量或者分配内存空间，可以使用赋值运算符和取地址符号。

例如，将指针变量numPtr指向一个整数变量num，可以使用以下代码：

    int num = 10;
    int *numPtr;
    numPtr = &num;

在这个例子中，&符号用于获取变量num的地址（即指针所指向的地址），然后将这个地址赋值给指针变量numPtr。

如何使用指针作为函数的参数？
==============

在C语言中，可以通过指针作为函数的参数来实现在函数内部修改外部变量的值。这样可以避免传递大量的数据拷贝，提高程序的效率。

下面是一个使用指针作为函数参数的案例：

    #include <stdio.h>
    
    // 函数原型
    void swap(int *a, int *b);
    
    int main() {
       int x = 10;
       int y = 20;
       
       printf("交换前：\n");
       printf("x = %d\n", x);
       printf("y = %d\n", y);
       
       // 调用交换函数
       swap(&x, &y);
       
       printf("交换后：\n");
       printf("x = %d\n", x);
       printf("y = %d\n", y);
       
       return 0;
    }
    
    // 交换函数
    void swap(int *a, int *b) {
       int temp;
       temp = *a;
       *a = *b;
       *b = temp;
    }

在上述例子中，我们定义了一个名为swap的函数，该函数接受两个整型指针作为参数。在主函数中，我们声明了两个整型变量x和y，并将它们的初始值分别设置为10和20。

然后，我们调用了swap函数，并传递了x和y的地址作为参数。在swap函数内部，我们声明了一个临时变量temp，用于存储需要交换的值。通过解引用指针，我们可以访问并修改指针指向的变量。

最后，我们在主函数中打印了交换后的结果。

运行上述程序，输出将是：

    交换前：
    x = 10
    y = 20
    交换后：
    x = 20
    y = 10

通过将指针作为函数参数传递，我们可以在函数内部修改外部变量的值，从而实现了交换两个变量的功能。

在C语言中，可以使用指针来访问变量的值。指针是一个变量，它存储了一个内存地址。通过指针，我们可以通过内存地址访问并修改变量的值。

下面是使用指针访问变量的值的方法：

1\. 声明指针变量：首先要声明一个指针变量，以便存储变量的地址。声明指针变量的方法是在变量前面加上星号(\*)，例如：int \*ptr;。

2\. 初始化指针变量：在使用指针之前，必须为指针变量分配内存。可以使用&运算符获取变量的地址，并将其赋值给指针变量。例如：int num = 10; int \*ptr = &num;这里，&num表示变量num的地址。

3\. 通过指针访问变量的值：可以使用星号(\*)运算符通过指针访问变量的值。例如：printf("%d", \*ptr);，这里\*ptr表示指针所指向的变量的值。

4\. 修改变量的值：通过指针，可以修改指针指向的变量的值。例如：\*ptr = 20;，这里\*ptr表示指针所指向的变量，将其值修改为20。

如何使用指针访问变量的值？
=============

下面是一个完整的示例代码，说明了如何使用指针访问变量的值：

    #include <stdio.h>
    
    int main() {
        int num = 10;
        int *ptr = &num; // 初始化指针变量
    
        printf("变量的值：%d\n", num);
        printf("指针所指向的变量的值：%d\n", *ptr);
    
        *ptr = 20; // 修改变量的值
    
        printf("修改后的变量的值：%d\n", num);
        printf("修改后，指针所指向的变量的值：%d\n", *ptr);
    
        return 0;
    }

这段代码首先声明一个整型变量num，然后声明一个指向整型变量的指针变量ptr。通过&运算符获取变量num的地址，并将其赋值给ptr。然后，通过\*ptr访问num的值，并通过\*ptr = 20将num的值修改为20。最后通过printf函数打印出相应的结果。

输出结果为：

    变量的值：10
    指针所指向的变量的值：10
    修改后的变量的值：20
    修改后，指针所指向的变量的值：20

这说明通过指针可以访问并修改变量的值。

如何使用指针返回函数的值？
=============

使用指针返回函数的值可以通过以下步骤实现：

1\. 定义返回值类型为指针类型的函数。例如，如果要返回一个整数类型的指针，可以使用int\* functionName()。  
2\. 在函数内部，使用new关键字动态分配一个新的变量，并将其赋值给该指针。例如，int\* ptr = new int;。  
3\. 对该指针进行其他操作，如赋值或计算等。  
4\. 使用return语句返回指针的值。例如，return ptr;。  
5\. 在调用函数的地方，使用一个指针变量来接收函数的返回值。例如，int\* result = functionName();。  
6\. 使用接收到的指针变量，可以通过解引用操作符\*来访问函数返回的值。例如，int value = \*result;。  
7\. 在使用完返回的指针值后，需要使用delete关键字将其释放，以避免内存泄漏。例如，delete result;。

下面是一个示例代码：

    #include <iostream>
    
    // 使用指针返回函数的示例函数
    int* createInteger() {
        int* ptr = new int;
        *ptr = 10;
        return ptr;
    }
    
    int main() {
        int* result = createInteger();
        std::cout << *result << std::endl; // 输出"10"
        delete result;
        
        return 0;
    }

注意：在使用指针返回函数的值时，需要小心避免内存泄漏。确保在不再需要使用返回的指针值时，及时使用delete释放内存。

如何使用指针函数
========

在C语言中，指针数组是一个数组，其元素为指针类型。它可以用于存储多个指针，并通过索引访问和操作这些指针。

下面是一个使用指针数组的示例：

    #include <stdio.h>
    
    int main() {
        int num1 = 10, num2 = 20, num3 = 30;
        int *ptrArr[3];  // 声明一个指针数组，包含3个指针元素
    
        ptrArr[0] = &num1;  // 将num1的地址存储到指针数组的第一个元素
        ptrArr[1] = &num2;  // 将num2的地址存储到指针数组的第二个元素
        ptrArr[2] = &num3;  // 将num3的地址存储到指针数组的第三个元素
    
        printf("Value of num1: %d\n", *ptrArr[0]);  // 输出num1的值
        printf("Value of num2: %d\n", *ptrArr[1]);  // 输出num2的值
        printf("Value of num3: %d\n", *ptrArr[2]);  // 输出num3的值
    
        return 0;
    }

运行上述代码，将得到以下输出：

    Value of num1: 10
    Value of num2: 20
    Value of num3: 30

该示例中，我们首先声明了一个指针数组ptrArr，其包含了3个元素，每个元素都是一个整型指针。然后，我们分别将num1、num2和num3的地址分别存储到ptrArr的第一个、第二个和第三个元素中。

通过ptrArr\[x\]的方式，我们可以访问并操作指针数组中的指针元素，而通过\*ptrArr\[x\]的方式，我们可以访问指针指向的值。

通过使用指针数组，我们可以方便地管理和操作多个指针，并且在函数之间传递多个指针也更加方便。

如何使用指向指针的指针
===========

在C语言中，指向指针的指针是一种特殊的指针类型，它可以用于存储和操作其他指针的地址。通过使用指向指针的指针，可以创建指向指针的指针链，从而在一次间接引用中访问多级指针。

定义指向指针的指针时，需要使用两个星号（\*\*）表示。例如，下面是一个指向整型指针的指针的定义：

    int **ptr;

接下来，我们来看一些使用指向指针的指针的常用操作：

1\. 分配内存：可以使用指向指针的指针来动态分配内存。首先，使用malloc或calloc函数分配一块内存，并将其地址分配给第一级指针。然后，使用第一级指针的地址分配给第二级指针。

    int **ptr;
    int *p;
    int value = 10;
    
    p = (int *)malloc(sizeof(int));
    *p = value;
    ptr = &p;

2\. 间接引用：可以使用指向指针的指针进行多级间接引用以获取所指向的值。对于上面的示例，可以通过以下方式获取value的值：

    int result = **ptr;
    printf("%d", result);   // 输出：10

3\. 传递指针的指针：指向指针的指针还可以作为函数参数传递，以便在函数中修改指针的值。对于需要修改指针本身的情况，传递指针的指针非常有用。

    void modifyPointer(int **ptr) {
        int *p;
        int value = 20;
    
        p = (int *)malloc(sizeof(int));
        *p = value;
        *ptr = p;
    }
    
    int main() {
        int *p;
        int **ptr;
        int value = 10;
    
        p = (int *)malloc(sizeof(int));
        *p = value;
        ptr = &p;
    
        printf("%d\n", **ptr);   // 输出：10
    
        modifyPointer(ptr);
    
        printf("%d\n", **ptr);   // 输出：20
    
        return 0;
    }

在上面的示例中，首先创建一个指向整型指针的指针ptr，并将其用作modifyPointer函数的参数。在modifyPointer函数中，创建一个新的整型指针p，并将其地址分配给\*ptr。这样，通过修改传递给函数的指针的指针，可以间接修改ptr的值。

总结来说，使用指向指针的指针可以实现对多级指针的访问和修改，以及提供动态分配内存的灵活性。它在处理复杂的数据结构和动态内存分配时非常有用。

如何动态分配内存
========

在C语言中，动态分配内存是通过使用标准库函数malloc、calloc和realloc来实现的。

1\. malloc函数：malloc函数用于分配指定大小的内存块，并返回指针。它的函数原型如下：

       void* malloc(size_t size);

   参数size表示要分配的内存块的大小，以字节为单位。如果分配成功，则返回指向该内存块的指针；如果分配失败，则返回NULL。

   例如，下面的代码将分配一个大小为10个int类型变量的内存块：

       int* ptr = malloc(10 * sizeof(int));
       if (ptr != NULL) {
           // 分配成功
       } else {
           // 分配失败
       }

2\. calloc函数：calloc函数与malloc函数类似，用于分配指定大小的内存块，并返回指针。但与malloc不同的是，calloc会在分配内存块的同时将其初始化为零。它的函数原型如下：

       void* calloc(size_t num, size_t size);

   参数num表示要分配的元素的个数，参数size表示每个元素的大小，以字节为单位。如果分配成功，则返回指向该内存块的指针；如果分配失败，则返回NULL。

   例如，下面的代码将分配一个大小为10个int类型变量的内存块，并将其初始化为零：

       int* ptr = calloc(10, sizeof(int));
       if (ptr != NULL) {
           // 分配成功
       } else {
           // 分配失败
       }

3\. realloc函数：realloc函数用于重新分配已分配内存块的大小，以便更改其大小。它的函数原型如下：

       void* realloc(void* ptr, size_t size);

   参数ptr是指向已分配内存块的指针，参数size表示要重新分配的内存块的大小，以字节为单位。如果分配成功，则返回指向重新分配后的内存块的指针；如果分配失败，则返回NULL。需要注意的是，realloc函数可能会将已分配的内存块移动到新的位置，因此在使用realloc重新分配内存之后，应该始终更新指针。

   例如，下面的代码将重新分配之前已分配的内存块的大小为20个int类型变量的内存块：

       int* ptr = realloc(ptr, 20 * sizeof(int));
       if (ptr != NULL) {
           // 重新分配成功
       } else {
           // 重新分配失败
       }

需要注意的是，在使用完动态分配的内存后，应使用free函数将其释放，以避免内存泄漏。free函数的函数原型如下：

    void free(void* ptr);

参数ptr是指向要释放的内存块的指针。例如，下面的代码释放了先前分配的内存块：

    free(ptr);

如何比较指针的值
========

在C语言中比较指针的值，可以通过使用关系运算符来比较指针的地址。具体来说，C语言中可以使用以下关系运算符来比较指针的值：

1\. "=="：比较两个指针是否指向同一个地址，即判断两个指针是否相等。例如，指针p和指针q，可以通过p == q来判断它们是否相等。

2\. "!="：比较两个指针是否指向不同的地址，即判断两个指针是否不相等。例如，指针p和指针q，可以通过p != q来判断它们是否不相等。

需要注意的是，指针的比较是比较它们的地址，而不是它们所指向的值。因此，即使两个指针所指向的值相等，它们的地址也可能不同，从而使得指针比较的结果为不相等。例如：

    int* p = malloc(sizeof(int));
    int* q = malloc(sizeof(int));
    *p = 5;
    *q = 5;
    if (p == q) {
        printf("p and q point to the same address.\n");
    } else {
        printf("p and q point to different addresses.\n");
    }

在上面的例子中，p和q分别指向了两块不同的内存空间，尽管它们所指向的值均为5，但由于它们的地址不同，所以它们的比较结果为不相等。

如何在结构体中使用指针
===========

在C语言中，结构体是一种自定义的数据类型，可以包含多个不同类型的元素。指针是一种特殊类型的变量，用来存储内存地址。

我们可以在结构体中使用指针来实现动态内存分配和引用其他变量。具体来说，可以在结构体中声明指向其他类型的指针，也可以在指针中存储结构体的地址。

下面是一些使用指针的结构体示例：

1\. 在结构体中声明指针：

    struct student {
       char name[50];
       int age;
       float marks;
       int* rollNumber;
    };

  
在这个例子中，rollNumber是一个指向 int 类型的指针。

2\. 动态分配内存：

    struct student s;
    s.rollNumber = (int*)malloc(sizeof(int));

  
这个例子中，我们使用 malloc 函数为 rollNumber 指针分配了一块 int 类型的内存空间。

3\. 访问指针指向的变量：

    *(s.rollNumber) = 10;

  
通过将值赋给 \*(s.rollNumber)，我们实际上是在给指针指向的变量赋值。

4\. 通过指针访问结构体成员：

    struct student *p;
    p = &s;

  
在这个例子中，我们声明了一个指向 student 结构体的指针 p，并将其指向结构体 s。

5\. 使用指针访问结构体成员：

    printf("Name: %s\n", (*p).name);
    printf("Age: %d\n", (*p).age);
    printf("Marks: %.2f\n", (*p).marks);
    printf("Roll Number: %d\n", *(*p).rollNumber);

  
在这个例子中，我们使用了 (\*p). 的语法来访问结构体成员。(\*p).name 表示访问指针 p 所指向的结构体的 name 成员。

当然，也可以使用另一种更简洁的语法来访问结构体成员：

    printf("Name: %s\n", p->name);
    printf("Age: %d\n", p->age);
    printf("Marks: %.2f\n", p->marks);
    printf("Roll Number: %d\n", *(p->rollNumber));

  
使用 -> 符号可直接访问指针所指向的结构体的成员。

结构体中使用指针可以帮助实现动态内存分配和在结构体中引用其他变量。这种灵活性使得结构体更加强大和多样化。

在黑夜里梦想着光，心中覆盖悲伤，在悲伤里忍受孤独，空守一丝温暖。 我的泪水是无底深海，对你的爱已无言，相信无尽的力量，那是真爱永在。 我的信仰是无底深海，澎湃着心中火焰，燃烧无尽的力量，那是忠诚永在。