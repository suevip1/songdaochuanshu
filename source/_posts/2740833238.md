---
layout: post
title: "C# - XMLHelper ï¼šä¸€ä¸ªæ“ä½œXMLçš„ç®€å•ç±»åº“"
date: "2023-06-26T01:24:13.239Z"
---
C# - XMLHelper ï¼šä¸€ä¸ªæ“ä½œXMLçš„ç®€å•ç±»åº“
============================

![C# - XMLHelper ï¼šä¸€ä¸ªæ“ä½œXMLçš„ç®€å•ç±»åº“](https://img2023.cnblogs.com/blog/2913706/202306/2913706-20230625195407922-937759657.png) ä¸‹åˆå†™äº†ä¸€ä¸ªæ“ä½œ\`XML\`æ–‡ä»¶çš„ç±»åº“ï¼Œåæ¥ä¸ç”¨äº†ï¼Œæ°´ç¯‡æ–‡ç« å­˜ä¸ªæ¡£ğŸ“‹

> ä¸‹åˆå†™äº†ä¸€ä¸ªæ“ä½œ`XML`æ–‡ä»¶çš„ç±»åº“ï¼Œåæ¥ä¸ç”¨äº†ï¼Œæ°´ç¯‡æ–‡ç« å­˜ä¸ªæ¡£ğŸ“‹

æ•´ä½“åŠŸèƒ½
----

`XMLHelper.cs`ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

1.  åŠ è½½XMLæ–‡ä»¶ï¼šä»æ–‡ä»¶è·¯å¾„æˆ–å­—ç¬¦ä¸²ä¸­åŠ è½½XMLæ–‡æ¡£ï¼Œå¹¶è¿”å›`XmlDocument`å¯¹è±¡ã€‚
2.  ä¿å­˜XMLæ–‡ä»¶ï¼šå°†XmlDocumentå¯¹è±¡ä¿å­˜ä¸ºXMLæ–‡ä»¶ã€‚
3.  è¯»å–XMLæ–‡ä»¶åˆ°`DataTable`ï¼šå°†XMLæ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°`DataTable`å¯¹è±¡ä¸­ã€‚
4.  ç”ŸæˆXMLæ–‡ä»¶ï¼šç”Ÿæˆä¸€ä¸ªæ–°çš„XMLæ–‡ä»¶ï¼Œå¹¶æŒ‡å®šæ ¹èŠ‚ç‚¹åç§°ã€‚
5.  ä»`DataTable`æ›´æ–°XMLæ–‡ä»¶ï¼šå°†`DataTable`å¯¹è±¡ä¸­çš„æ•°æ®æ›´æ–°åˆ°XMLæ–‡ä»¶ä¸­ã€‚
6.  è·å–èŠ‚ç‚¹å€¼ï¼šæ ¹æ®XPathè¡¨è¾¾å¼è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼ã€‚
7.  è®¾ç½®èŠ‚ç‚¹å€¼ï¼šæ ¹æ®XPathè¡¨è¾¾å¼è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å€¼ã€‚
8.  è·å–å±æ€§å€¼ï¼šæ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è·å–æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼ã€‚
9.  è®¾ç½®å±æ€§å€¼ï¼šæ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼ã€‚
10.  æ›´æ–°æ–‡ä»¶ä¸­çš„èŠ‚ç‚¹å€¼ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„èŠ‚ç‚¹å€¼ã€‚
11.  æ›´æ–°æ–‡ä»¶ä¸­çš„å±æ€§å€¼ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼ã€å±æ€§åç§°å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„å±æ€§å€¼ã€‚

> æ²¡ç”¨ `LINQ To XML` è¯­æ³•ç³–ğŸ§¬

### XMLHelper.cs

    using System;
    using System.Data;
    using System.Xml;
    
    namespace XMLHelper
    {
        class XMLHelper
        {
            private XmlDocument xmlDoc;
    
            public XMLHelper()
            {
                xmlDoc = new XmlDocument();
            }
    
            // ä»æ–‡ä»¶è·¯å¾„æˆ–å­—ç¬¦ä¸²ä¸­åŠ è½½XMLæ–‡æ¡£ï¼Œå¹¶è¿”å›XmlDocumentå¯¹è±¡
            public XmlDocument LoadXmlDocumentFromFile(string filePath)
            {
                try
                {
                    xmlDoc.Load(filePath);
                    return xmlDoc;
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error loading XML document from file: " + ex.Message);
                    return null;
                }
            }
    
            // ä»ä¸€ä¸ªXMLå­—ç¬¦ä¸²åŠ è½½XMLæ–‡æ¡£ï¼Œå¹¶è¿”å›XmlDocumentå¯¹è±¡
            public XmlDocument LoadXmlDocumentFromString(string xmlString)
            {
                try
                {
                    xmlDoc.LoadXml(xmlString);
                    return xmlDoc;
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error loading XML document from string: " + ex.Message);
                    return null;
                }
            }
    
            // ä¿å­˜XMLæ–‡ä»¶ï¼šå°†XmlDocumentå¯¹è±¡ä¿å­˜ä¸ºXMLæ–‡ä»¶
            public void SaveXmlDocument(XmlDocument xmlDoc, string filePath)
            {
                try
                {
                    xmlDoc.Save(filePath);
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error saving XML document: " + ex.Message);
                }
            }
    
            // ç”Ÿæˆä¸€ä¸ªæ–°çš„XMLæ–‡ä»¶ï¼Œå¹¶æŒ‡å®šæ ¹èŠ‚ç‚¹åç§°
            public void GenerateXmlFile(string filePath, string rootElementName)
            {
                try
                {
                    xmlDoc = new XmlDocument();
                    XmlDeclaration xmlDeclaration = xmlDoc.CreateXmlDeclaration("1.0", "UTF-8", null);
                    XmlNode rootNode = xmlDoc.CreateElement(rootElementName);
                    xmlDoc.AppendChild(xmlDeclaration);
                    xmlDoc.AppendChild(rootNode);
                    xmlDoc.Save(filePath);
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error generating XML file: " + ex.Message);
                }
            }
    
            /// <summary>
            /// è¯»å–XMLæ–‡ä»¶åˆ°DataTableï¼šå°†XMLæ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°DataTableå¯¹è±¡ä¸­
            /// </summary>
            /// <param name="xmlDoc">XmlDocumentå¯¹è±¡</param>
            /// <param name="xpath">èŠ‚ç‚¹é›†åˆçš„ XPath è¡¨è¾¾å¼ - ä¾‹å¦‚"/Roots/Child"</param>
            /// <returns>DataTableå¯¹è±¡</returns>
            public DataTable ReadXmlToDataTable(XmlDocument xmlDoc,string xpath)
            {
                try
                {
                    DataTable dataTable = new DataTable();
    
                    XmlNodeList nodes = xmlDoc.SelectNodes(xpath);
                    foreach (XmlNode node in nodes)
                    {
                        if (dataTable.Columns.Count == 0)
                        {
                            foreach (XmlNode childNode in node.ChildNodes)
                            {
                                dataTable.Columns.Add(childNode.Name, typeof(string));
                            }
                        }
    
                        DataRow row = dataTable.NewRow();
                        foreach (XmlNode childNode in node.ChildNodes)
                        {
                            row[childNode.Name] = childNode.InnerText;
                        }
    
                        dataTable.Rows.Add(row);
                    }
    
                    return dataTable;
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error reading XML document to DataTable: " + ex.Message);
                    return null;
                }
            }
    
            /// <summary>
            /// å°†DataTableå¯¹è±¡ä¸­çš„æ•°æ®æ›´æ–°åˆ°XMLæ–‡ä»¶ä¸­
            /// </summary>
            /// <param name="xmlDoc">XmlDocumentå¯¹è±¡</param>
            /// <param name="dataTable">DataTableå¯¹è±¡</param>
            /// <param name="elementName">å­èŠ‚ç‚¹å€¼</param>
            public void UpdateXmlFromDataTable(XmlDocument xmlDoc, DataTable dataTable,string elementName)
            {
                try
                {
                    xmlDoc.DocumentElement.RemoveAll();
    
                    foreach (DataRow row in dataTable.Rows)
                    {
                        XmlElement measurementPointElement = xmlDoc.CreateElement(elementName);
    
                        foreach (DataColumn column in dataTable.Columns)
                        {
                            XmlElement element = xmlDoc.CreateElement(column.ColumnName);
                            element.InnerText = row[column.ColumnName].ToString();
                            measurementPointElement.AppendChild(element);
                        }
    
                        xmlDoc.DocumentElement.AppendChild(measurementPointElement);
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error updating XML from DataTable: " + ex.Message);
                }
            }
    
            // æ ¹æ®XPathè¡¨è¾¾å¼è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼
            public string GetNodeValue(XmlDocument xmlDoc, string xpath)
            {
                XmlNode node = xmlDoc.SelectSingleNode(xpath);
                return node?.InnerText;
            }
    
            // æ ¹æ®XPathè¡¨è¾¾å¼è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å€¼
            public void SetNodeValue(XmlDocument xmlDoc, string xpath, string value)
            {
                XmlNode node = xmlDoc.SelectSingleNode(xpath);
                if (node != null)
                    node.InnerText = value;
            }
    
            // æ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è·å–æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼
            public string GetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName)
            {
                XmlNode node = xmlDoc.SelectSingleNode(xpath);
                if (node != null && node.Attributes != null)
                {
                    XmlAttribute attribute = node.Attributes[attributeName];
                    return attribute?.Value;
                }
                return null;
            }
    
            // æ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼
            public void SetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName, string value)
            {
                XmlNode node = xmlDoc.SelectSingleNode(xpath);
                if (node != null && node.Attributes != null)
                {
                    XmlAttribute attribute = node.Attributes[attributeName];
                    if (attribute != null)
                        attribute.Value = value;
                }
            }
    
            // æ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„èŠ‚ç‚¹å€¼
            public void UpdateNodeValueInFile(string filePath, string xpath, string value)
            {
                XmlDocument doc = LoadXmlDocumentFromFile(filePath);
                if (doc != null)
                {
                    SetNodeValue(doc, xpath, value);
                    SaveXmlDocument(doc, filePath);
                }
            }
    
            // æ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼ã€å±æ€§åç§°å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„å±æ€§å€¼
            public void UpdateAttributeValueInFile(string filePath, string xpath, string attributeName, string value)
            {
                XmlDocument doc = LoadXmlDocumentFromFile(filePath);
                if (doc != null)
                {
                    SetAttributeValue(doc, xpath, attributeName, value);
                    SaveXmlDocument(doc, filePath);
                }
            }
        }
    }
    

> å¼‚å¸¸å¤„ç†å°±éœ€è¦å¤§å®¶è‡ªç”±å‘æŒ¥äº†â™»ï¸

åŠ è½½å’Œä¿å­˜XMLæ–‡ä»¶
----------

`XMLHelper`ç±»åº“æä¾›äº†ä¸¤ä¸ªæ–¹æ³•ï¼Œç”¨äºä»æ–‡ä»¶è·¯å¾„æˆ–å­—ç¬¦ä¸²ä¸­åŠ è½½XMLæ–‡æ¡£å¹¶è¿”å›`XmlDocument`å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯ï¼š

    public XmlDocument LoadXmlDocumentFromFile(string filePath)
    

    public XmlDocument LoadXmlDocumentFromString(string xmlString)
    

å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•å°†XMLæ–‡ä»¶åŠ è½½åˆ°`XmlDocument`å¯¹è±¡ä¸­ï¼Œæ–¹ä¾¿åç»­çš„å¤„ç†å’Œæ“ä½œï¼Œä¸€ä¸ªæ“ä½œæ–‡ä»¶ï¼Œä¸€ä¸ªæ“ä½œXMLç»“æ„çš„å­—ç¬¦ä¸²ï¼Œç„¶åä¿å­˜ï¼š

    public void SaveXmlDocument(XmlDocument xmlDoc, string filePath)
    

è¿™å‡ ä¸ªéƒ½æ˜¯è°ƒç”¨ç›´æ¥çš„æ–¹æ³•ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚

è¯»å–å’Œæ›´æ–°XMLæ–‡ä»¶
----------

`XMLHelper`ç±»åº“ä½¿å¾—ä»XMLæ–‡ä»¶ä¸­è¯»å–æ•°æ®å˜å¾—éå¸¸ç®€å•ã€‚å…¶ä¸­ï¼Œ`ReadXmlToDataTable`æ–¹æ³•å…è®¸å°†XMLæ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°`DataTable`å¯¹è±¡ä¸­ï¼š

    public DataTable ReadXmlToDataTable(XmlDocument xmlDoc, string xpath)
    

åªéœ€è¦æä¾›`XmlDocument`å¯¹è±¡å’ŒèŠ‚ç‚¹é›†åˆçš„`XPath`è¡¨è¾¾å¼ï¼ˆä¾‹å¦‚`"/Roots/Child"`ï¼‰ï¼Œå³å¯å°†XMLæ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°`DataTable`å¯¹è±¡ä¸­ã€‚

å¦å¤–ï¼Œå¯ä»¥ä½¿ç”¨`UpdateXmlFromDataTable`æ–¹æ³•å°†`DataTable`å¯¹è±¡ä¸­çš„æ•°æ®æ›´æ–°åˆ°XMLæ–‡ä»¶ä¸­ï¼š

    public void UpdateXmlFromDataTable(XmlDocument xmlDoc, DataTable dataTable, string elementName)
    

è¿™ä¸ªæ–¹æ³•ä¼šæ¸…ç©ºXMLæ–‡ä»¶å¹¶æ ¹æ®`DataTable`å¯¹è±¡ä¸­çš„æ•°æ®åˆ›å»ºæ–°çš„XMLèŠ‚ç‚¹ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°`XmlDocument`å¯¹è±¡ä¸­ã€‚

### ç¤ºä¾‹ç”¨æ³•

    // åˆ›å»ºXMLHelperå¯¹è±¡
    XMLHelper xmlHelper = new XMLHelper();
    
    // åŠ è½½XMLæ–‡ä»¶
    XmlDocument xmlDoc = xmlHelper.LoadXmlDocumentFromFile("data.xml");
    
    // è¯»å–XMLæ•°æ®åˆ°DataTable
    DataTable dataTable = xmlHelper.ReadXmlToDataTable(xmlDoc, "/Root/Element");
    
    // ä¿®æ”¹èŠ‚ç‚¹çš„å€¼
    dataTable.Rows[0]["Value"] = "New Value";
    
    // æ›´æ–°XMLæ–‡ä»¶
    xmlHelper.UpdateXmlFromDataTable(xmlDoc, dataTable, "Element");
    
    // ä¿å­˜XMLæ–‡ä»¶
    xmlHelper.SaveXmlDocument(xmlDoc, "data.xml");
    

è¯»å–å’Œæ›´æ–°XMLèŠ‚ç‚¹çš„å€¼
------------

`XMLHelper`è¿˜æä¾›äº†ä¸€äº›æ–¹æ³•ç”¨äºè¯»å–å’Œæ›´æ–°XMLèŠ‚ç‚¹çš„å€¼ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­å‡ ä¸ªæ–¹æ³•çš„ç¤ºä¾‹ï¼š

    string GetNodeValue(XmlDocument xmlDoc, string xpath)
    public void SetNodeValue(XmlDocument xmlDoc, string xpath, string value)
    public string GetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName)
    public void SetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName, string value)
    

è¿™äº›æ–¹æ³•å…è®¸ä½ æ ¹æ®`XPath`è¡¨è¾¾å¼è·å–èŠ‚ç‚¹çš„æ–‡æœ¬å€¼æˆ–å±æ€§å€¼ï¼Œå¹¶ä¸”å¯ä»¥æ›´æ–°èŠ‚ç‚¹çš„æ–‡æœ¬å€¼æˆ–å±æ€§å€¼ã€‚

### ç¤ºä¾‹ç”¨æ³•

    // åˆ›å»ºXMLHelperå¯¹è±¡
    XMLHelper xmlHelper = new XMLHelper();
    
    // åŠ è½½XMLæ–‡ä»¶
    XmlDocument xmlDoc = xmlHelper.LoadXmlDocumentFromFile("data.xml");
    
    // è¯»å–èŠ‚ç‚¹çš„å€¼
    string nodeValue = xmlHelper.GetNodeValue(xmlDoc, "/Root/Element/Value");
    Console.WriteLine("Node Value: " + nodeValue);
    
    // æ›´æ–°èŠ‚ç‚¹çš„å€¼
    string newValue = "New Value";
    xmlHelper.SetNodeValue(xmlDoc, "/Root/Element/Value", newValue);
    Console.WriteLine("Node Value updated.");
    
    // ä¿å­˜XMLæ–‡ä»¶
    xmlHelper.SaveXmlDocument(xmlDoc, "data.xml");
    

ç”ŸæˆXMLæ–‡ä»¶
-------

é™¤äº†åŠ è½½ã€è¯»å–å’Œæ›´æ–°XMLæ–‡ä»¶ï¼ŒXMLHelperç±»åº“è¿˜æä¾›äº†ä¸€ä¸ªæ–¹æ³•ç”¨äºç”ŸæˆXMLæ–‡ä»¶ã€‚ä½ å¯ä»¥ä½¿ç”¨`GenerateXmlFile`æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºçš„XMLæ–‡ä»¶ï¼ŒæŒ‡å®šæ ¹å…ƒç´ çš„åç§°å’Œæ–‡ä»¶è·¯å¾„ï¼š

    public void GenerateXmlFile(string filePath, string rootElementName)
    

è¿™ä¸ªæœ‰ç‚¹ç‘•ç–µï¼Œåé¢ç”¨åˆ°å†æ”¹å“ˆã€‚

è®¾è®¡æ€è·¯
----

`ChatGPT did this` ï¼š

1.  `LoadXmlDocumentFromFile(string filePath): XmlDocument`
    *   åŠŸèƒ½ï¼šä»æŒ‡å®šæ–‡ä»¶è·¯å¾„åŠ è½½XMLæ–‡æ¡£ã€‚
    *   è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ã€‚
    *   è¾“å‡ºï¼šåŠ è½½æˆåŠŸè¿”å›XmlDocumentå¯¹è±¡ï¼ŒåŠ è½½å¤±è´¥è¿”å›nullã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`Load`æ–¹æ³•ä»æ–‡ä»¶è·¯å¾„åŠ è½½XMLæ–‡æ¡£ï¼Œå¦‚æœåŠ è½½å¤±è´¥ï¼Œåˆ™è¿”å›nullã€‚
2.  `LoadXmlDocumentFromString(string xmlString): XmlDocument`
    *   åŠŸèƒ½ï¼šä»æŒ‡å®šå­—ç¬¦ä¸²åŠ è½½XMLæ–‡æ¡£ã€‚
    *   è¾“å…¥ï¼šXMLå­—ç¬¦ä¸²ã€‚
    *   è¾“å‡ºï¼šåŠ è½½æˆåŠŸè¿”å›XmlDocumentå¯¹è±¡ï¼ŒåŠ è½½å¤±è´¥è¿”å›nullã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`LoadXml`æ–¹æ³•ä»å­—ç¬¦ä¸²åŠ è½½XMLæ–‡æ¡£ï¼Œå¦‚æœåŠ è½½å¤±è´¥ï¼Œåˆ™è¿”å›nullã€‚
3.  `GenerateXmlFile(string filePath, string rootElementName): void`
    *   åŠŸèƒ½ï¼šç”Ÿæˆä¸€ä¸ªæ–°çš„XMLæ–‡ä»¶ï¼Œå¹¶æŒ‡å®šæ ¹èŠ‚ç‚¹åç§°ã€‚
    *   è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ï¼Œæ ¹èŠ‚ç‚¹åç§°ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„XmlDocumentå¯¹è±¡ï¼Œå¹¶ä½¿ç”¨æŒ‡å®šçš„æ ¹èŠ‚ç‚¹åç§°åˆ›å»ºæ ¹èŠ‚ç‚¹ã€‚ç„¶åä½¿ç”¨XmlDocumentçš„`Save`æ–¹æ³•å°†XmlDocumentå¯¹è±¡ä¿å­˜ä¸ºæŒ‡å®šæ–‡ä»¶è·¯å¾„çš„XMLæ–‡ä»¶ã€‚
4.  `SaveXmlDocument(XmlDocument xmlDoc, string filePath): void`
    *   åŠŸèƒ½ï¼šå°†XmlDocumentå¯¹è±¡ä¿å­˜ä¸ºXMLæ–‡ä»¶ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼Œæ–‡ä»¶è·¯å¾„ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`Save`æ–¹æ³•å°†XmlDocumentå¯¹è±¡ä¿å­˜ä¸ºæŒ‡å®šæ–‡ä»¶è·¯å¾„çš„XMLæ–‡ä»¶ã€‚
5.  `ReadXmlToDataTable(XmlDocument xmlDoc): DataTable`
    *   åŠŸèƒ½ï¼šå°†XMLæ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°DataTableå¯¹è±¡ä¸­ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ã€‚
    *   è¾“å‡ºï¼šè¯»å–æˆåŠŸè¿”å›DataTableå¯¹è±¡ï¼Œè¯»å–å¤±è´¥è¿”å›nullã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`SelectNodes`æ–¹æ³•é€‰å–æŒ‡å®šXPathè¡¨è¾¾å¼çš„èŠ‚ç‚¹é›†åˆï¼Œéå†èŠ‚ç‚¹é›†åˆï¼Œå¹¶æ ¹æ®èŠ‚ç‚¹çš„å­èŠ‚ç‚¹åˆ›å»ºDataTableçš„åˆ—ã€‚ç„¶åéå†æ¯ä¸ªèŠ‚ç‚¹ï¼Œå°†å­èŠ‚ç‚¹çš„åç§°å’Œæ–‡æœ¬å†…å®¹ä½œä¸ºDataTableçš„è¡Œæ•°æ®ã€‚æœ€åè¿”å›DataTableå¯¹è±¡ã€‚
6.  `UpdateXmlFromDataTable(XmlDocument xmlDoc, DataTable dataTable, string elementName): void`
    *   åŠŸèƒ½ï¼šå°†DataTableå¯¹è±¡ä¸­çš„æ•°æ®æ›´æ–°åˆ°XMLæ–‡ä»¶ä¸­ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼ŒDataTableå¯¹è±¡ï¼Œè¦æ›´æ–°çš„èŠ‚ç‚¹å…ƒç´ åç§°ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šé¦–å…ˆæ¸…ç©ºXmlDocumentçš„æ ¹èŠ‚ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ã€‚ç„¶åéå†DataTableçš„æ¯ä¸€è¡Œï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„XmlElementï¼Œå¹¶æ ¹æ®DataTableçš„åˆ—åå’Œè¡Œæ•°æ®è®¾ç½®XmlElementçš„å­èŠ‚ç‚¹ã€‚æœ€åå°†æ–°çš„XmlElementæ·»åŠ åˆ°XmlDocumentçš„æ ¹èŠ‚ç‚¹ä¸‹ã€‚
7.  `GetNodeValue(XmlDocument xmlDoc, string xpath): string`
    *   åŠŸèƒ½ï¼šæ ¹æ®XPathè¡¨è¾¾å¼è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼ŒXPathè¡¨è¾¾å¼ã€‚
    *   è¾“å‡ºï¼šèŠ‚ç‚¹çš„å€¼ï¼Œå¦‚æœèŠ‚ç‚¹ä¸å­˜åœ¨åˆ™è¿”å›nullã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`SelectSingleNode`æ–¹æ³•æ ¹æ®XPathè¡¨è¾¾å¼é€‰å–æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åè¿”å›èŠ‚ç‚¹çš„InnerTextã€‚
8.  `SetNodeValue(XmlDocument xmlDoc, string xpath, string value): void`
    *   åŠŸèƒ½ï¼šæ ¹æ®XPathè¡¨è¾¾å¼è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å€¼ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼ŒXPathè¡¨è¾¾å¼ï¼Œè¦è®¾ç½®çš„å€¼ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`SelectSingleNode`æ–¹æ³•æ ¹æ®XPathè¡¨è¾¾å¼é€‰å–æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åå°†èŠ‚ç‚¹çš„InnerTextè®¾ç½®ä¸ºæŒ‡å®šçš„å€¼ã€‚
9.  `GetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName): string`
    *   åŠŸèƒ½ï¼šæ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è·å–æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼ŒXPathè¡¨è¾¾å¼ï¼Œå±æ€§åç§°ã€‚
    *   è¾“å‡ºï¼šå±æ€§çš„å€¼ï¼Œå¦‚æœå±æ€§ä¸å­˜åœ¨åˆ™è¿”å›nullã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`SelectSingleNode`æ–¹æ³•æ ¹æ®XPathè¡¨è¾¾å¼é€‰å–æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®å±æ€§åç§°è·å–å±æ€§çš„å€¼ã€‚
10.  `SetAttributeValue(XmlDocument xmlDoc, string xpath, string attributeName, string value): void`
    *   åŠŸèƒ½ï¼šæ ¹æ®XPathè¡¨è¾¾å¼å’Œå±æ€§åç§°è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼ã€‚
    *   è¾“å…¥ï¼šXmlDocumentå¯¹è±¡ï¼ŒXPathè¡¨è¾¾å¼ï¼Œå±æ€§åç§°ï¼Œè¦è®¾ç½®çš„å€¼ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šä½¿ç”¨XmlDocumentçš„`SelectSingleNode`æ–¹æ³•æ ¹æ®XPathè¡¨è¾¾å¼é€‰å–æŒ‡å®šèŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®å±æ€§åç§°è®¾ç½®å±æ€§çš„å€¼ã€‚
11.  `UpdateNodeValueInFile(string filePath, string xpath, string value): void`
    *   åŠŸèƒ½ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„èŠ‚ç‚¹å€¼ã€‚
    *   è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ï¼ŒXPathè¡¨è¾¾å¼ï¼Œè¦è®¾ç½®çš„å€¼ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šé¦–å…ˆä»æ–‡ä»¶è·¯å¾„åŠ è½½XMLæ–‡æ¡£ï¼Œç„¶åè°ƒç”¨SetNodeValueå‡½æ•°è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å€¼ï¼Œæœ€åä¿å­˜XMLæ–‡æ¡£åˆ°æ–‡ä»¶ã€‚
12.  `UpdateAttributeValueInFile(string filePath, string xpath, string attributeName, string value): void`
    *   åŠŸèƒ½ï¼šæ ¹æ®æ–‡ä»¶è·¯å¾„ã€XPathè¡¨è¾¾å¼ã€å±æ€§åç§°å’Œå€¼æ›´æ–°XMLæ–‡ä»¶ä¸­çš„å±æ€§å€¼ã€‚
    *   è¾“å…¥ï¼šæ–‡ä»¶è·¯å¾„ï¼ŒXPathè¡¨è¾¾å¼ï¼Œå±æ€§åç§°ï¼Œè¦è®¾ç½®çš„å€¼ã€‚
    *   è¾“å‡ºï¼šæ— ã€‚
    *   è®¾è®¡æ€è·¯ï¼šé¦–å…ˆä»æ–‡ä»¶è·¯å¾„åŠ è½½XMLæ–‡æ¡£ï¼Œç„¶åè°ƒç”¨SetAttributeValueå‡½æ•°è®¾ç½®æŒ‡å®šèŠ‚ç‚¹çš„å±æ€§å€¼ï¼Œæœ€åä¿å­˜XMLæ–‡æ¡£åˆ°æ–‡ä»¶ã€‚

Done!!!