---
layout: post
title: "【接口测试】Postman（三）-变量与集合"
date: "2023-06-18T01:24:06.843Z"
---
【接口测试】Postman（三）-变量与集合
======================

​ 在Postman中，我们进行接口测试一般是以集合为单位，而在日常应用中，我们会经常使用到变量。下面我们将介绍一下变量和集合的一些用法。

变量与集合
=====

> ​ 在Postman中，我们进行接口测试一般是以集合为单位，而在日常应用中，我们会经常使用到变量。下面我们将介绍一下变量和集合的一些用法。

文章目录导航：

目录

*   [变量与集合](#变量与集合)
    *   [一、变量](#一变量)
        *   [1、环境变量](#1环境变量)
        *   [（1）创建环境变量](#1创建环境变量)
        *   [（2）管理环境变量](#2管理环境变量)
        *   [（3）选择与编辑环境变量](#3选择与编辑环境变量)
        *   [2、全局变量](#2全局变量)
        *   [（1）管理全局变量](#1管理全局变量)
    *   [二、集合](#二集合)
        *   [1、创建集合](#1创建集合)
        *   [2、保存请求到集合](#2保存请求到集合)
        *   [3、分享集合](#3分享集合)
    *   [三、集合执行](#三集合执行)
        *   [1、集合运行参数](#1集合运行参数)
        *   [2、使用数据文件](#2使用数据文件)
        *   [3、创建工作流](#3创建工作流)

一、变量
----

> ​ 变量这个概念相信大家都不陌生，因此在这里我们不介绍了。主要说一下在Postman中有哪几类变量，主要包括以下四类：
> 
> *   Global（全局）
>     
> *   Environment（环境）
>     
> *   Local（本地）
>     
> *   Data（数据）
>     
>     在本文中我们只介绍全局变量与环境变量的用法
>     

### 1、环境变量

​ 环境变量可以理解为局部变量，他会随着环境的变化而变化。

### （1）创建环境变量

我们可以点击右上角的小眼睛，管理环境变量

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045457225-496211858.png)

然后我们点击add

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045523331-553688167.png)

然后输入环境变量的信息完成后Ctrl S保存即可

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045540040-1889953200.png)

### （2）管理环境变量

​ 在添加环境变量界面，我们除了可以在创建环境变量，我们还能共享、复制、导出、删除以及导入环境变量JSON文件等操作。这里就不详细介绍了，操作比较简单。

### （3）选择与编辑环境变量

既然我们创建了环境变量，那么我们就要选择使用他，选择非常简单点击我们小眼睛旁边的下拉框选中所创建的环境变量即可

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045558869-1367327214.png)

至于编辑环境变量，进入界面方式与创建一样，只不过add变成了edit，只不过你需要先选择你需要编辑的环境变量

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045610600-865329072.png)

### 2、全局变量

​ 全局变量顾名思义是可以在所有范围内被引用的一种变量

### （1）管理全局变量

全局变量的管理其实与环境变量一样，都是点击小眼睛后点击add或edit

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045623378-106777346.png)

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045637257-880092011.png)

二、集合
----

> Postman中集合是用来存放多个请求。这里意思比较通俗易懂，我们不详细介绍了，直接进入正题吧。
> 
> 我们为什么要使用集合呢？
> 
> 1.  将请求保存到集合中，能够结构化保存我们的请求，方便后面重复使用
> 2.  方便我们构成集成测试套件，类似与我们Junit中的Test Suite
> 3.  方便使用脚本在接口之间传递数据，构建实际用例的流

### 1、创建集合

选中侧边栏【Collections】，这里根据版本不同可能长得不一样，不过基本都是在左边

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045651900-915784429.png)

点击+或者点击new都可（点击new的话需要选择Collections），然后输入集合名即可

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045705814-1760704109.png)

### 2、保存请求到集合

这个其实非常的简单，我们在需要保存的请求点击保存按钮或者直接Ctrl S会弹出保存弹窗，在下面选择要保存到的集合就可以了

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045720409-863430816.png)  
或者我们可以直接右键集合，然后点击添加请求也可以

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045741164-511553437.png)

同时我们还可以再左侧History中保存之前运行过的请求到集合

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045755675-1835237613.png)

我们还可以右键集合对集合进行复制

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045812743-1327736805.png)

### 3、分享集合

这里我们有两种分享方式，一种需要登录账号通过在线方式分享，一种通过导出集合文件进行分享，这里我们只介绍后者

右键需要分享的集合，选择Export

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045829205-442477868.png)

然后直接导出就行

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045841744-2102277465.png)

至于导入的话，在我们创建的时候，new旁边有个import，对，没错，就是点击它

三、集合执行
------

既然我们有了集合，我们就需要去执行他，接下来我们介绍一下集合执行的一些操作

### 1、集合运行参数

我们可以点击集合进入集合，然后点击Run（这里版本不同操作不一样，有的版本直接右键集合就可以Run）

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045857338-1874401903.png)

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045909999-658394859.png)

我们来介绍一下一些参数吧

首先左侧是选择我们需要执行的脚本，这个不解释了

主要我们看右边

1.  **Environment:**就是选择我们需要使用的环境变量
2.  **lterations：**迭代次数，也就是我们集合运行的次数
3.  **Delay：**设置发送每个请求之间的间隔，这个比较好理解
4.  **Data:**这里是为集合提供运行的数据文件，一般用来设置文件参数化用。

### 2、使用数据文件

这里我们编写一个示例

**请求方式：**POST

**URL：**[https://postman-echo.com/](https://postman-echo.com/)

**Body:**

KEY

VALUE

foo

{{value}}

{{value}}表示引用了value这个变量

然后我们在Tests中编写脚本设置检查点验证我们的请求

    var jsonData = JSON.parse(responseBody);
    
    tests['Response has datan value'] = jsonData.form.foo === data.value
    

然后我们参数化的文件可以采用CSV或者JSON文件，在这里我们采用CSV，CSV文件如下

    path,value
    post,'1'
    post,'2'
    post,'3'
    post,'4'
    

大家在创建CSV文件的时候，如果带有中文需要注意一下我们字符集的问题

直接在runner界面选择文件即可

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045939395-1371668880.png)

选择之后可以手动设置格式以及预览文件

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618045952231-1670976961.png)

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618050003817-414685948.png)

然后我们运行，全部通过（记得勾选save response）

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618050017311-1444504259.png)

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618050027904-959096015.png)

### 3、创建工作流

在集合当中，各个请求的执行顺序是可以控制的，在这里我们采用setNextRequest()方法来控制下一个执行的请求，我们直接上样例：

首先我们先创建四个请求：

[https://postman-echo.com/get?foo1=bar1](https://postman-echo.com/get?foo1=bar1)

另外三个参数分别为foo2=bar2;foo3=bar3;foo4-bar4

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618050041528-752065240.png)

接下来我们在Request 1请求的Tests编写代码：

    postman.setNextRequest("Request 4")
    

执行集合，我们会发现运行完Request 1后直接运行Request 4而不会运行中间的两个请求

![img](https://img2023.cnblogs.com/blog/2687725/202306/2687725-20230618050053781-1677816598.png)

当然在现实运用中我们肯定不会这么简单的，我们经常会使用循环和分支语句来控制工作流，例如在本例中，我们可以进行略微修改一下：

    if (responseCode.code === 401) {
        postman.setNextRequest("Request 4");
    }
    

当请求报401的时候，我们跳过中间两个请求，如果请求为200，那么正常执行。

**以上就是这节的全部内容，如有错误，还请各位指正!**