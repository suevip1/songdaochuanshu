---
layout: post
title: "Lakehouse: A New Generation of Open Platforms that Unify Data Warehousing and Advanced Analytics"
date: "2023-07-16T01:42:30.648Z"
---
Lakehouse: A New Generation of Open Platforms that Unify Data Warehousing and Advanced Analytics
================================================================================================

åœ¨Delta Lakeå®˜ç½‘ä¸Šæåˆ°çš„ä¸€ç¯‡æ–°ä¸€ä»£æ¹–ä»“æ¶æ„çš„è®ºæ–‡.  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689406041936-82416672-e4d8-46db-9742-19b4a283b7f4.png#averageHue=%233f8aac&clientId=uee587144-299b-4&from=paste&height=201&id=ue60dded2&originHeight=402&originWidth=1694&originalType=binary&ratio=2&rotation=0&showTitle=false&size=328611&status=done&style=none&taskId=u8cd33a55-0910-49d8-956f-77532636bbc&title=&width=847)  
è¿™ç¯‡è®ºæ–‡ç”±Databrickså›¢é˜Ÿ2021å¹´å‘è¡¨äºCIDRä¼šè®®. _è¿™ä¸ªä¼šè®®æ˜¯å¯¹sigmodå’Œvldbä¼šè®®çš„è¡¥å……._  
å¯ä»¥çœ‹åˆ°è¿™ç¯‡è®ºæ–‡å’Œå‰ä¸€ç¯‡[Delta Lake: High-Performance ACID Table Storage over Cloud Object Stores](https://www.vldb.org/pvldb/vol13/p3411-armbrust.pdf)å‘è¡¨æ—¶é—´ä»…éš”äº†ä¸€å¹´. è®ºè¿°çš„å†…å®¹ä¹Ÿæ˜¯å¯¹Delta Lakeè¿™å¥—æ¶æ„çš„è¡¥å……(åœºæ™¯æ‹“å±•).

Warehouse, lake, lakehouse
==========================

![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689406838148-1b72847f-cbac-4134-972d-9f914d6bf61e.png#averageHue=%23f8f8f8&clientId=ub9bf4ce3-6933-4&from=paste&height=394&id=u69dcaeac&originHeight=788&originWidth=1826&originalType=binary&ratio=2&rotation=0&showTitle=false&size=307991&status=done&style=none&taskId=u6dd8434c-6356-444c-bff4-d69f4383db8&title=&width=913)  
ç¬¬ä¸€ä»£æ•°ä»“åªå°†æ•°æ®åº“æ“ä½œçš„ç»“æ„åŒ–æ—¥å¿—é€šè¿‡ETLæ¸…æ´—å­˜å‚¨åˆ°ä¸“é—¨çš„æ•°æ®ä»“åº“ä¸­, å…¸å‹çš„å¦‚åŸºäºHiveçš„æ•°ä»“. è¿™ä¸€ä»£æ•°ä»“çš„ä¸»è¦æœåŠ¡çš„ç›®æ ‡åœºæ™¯æ˜¯BIåˆ†æ. ä»–çš„æ¶æ„ä¹Ÿæ˜¯ä¸€ç§è®¡ç®—å­˜å‚¨ç´§è€¦åˆçš„æ¶æ„, ä¾‹å¦‚hiveä¸Šè®¡ç®—èŠ‚ç‚¹å°±å’Œå­˜å‚¨çš„æ•°æ®èŠ‚ç‚¹éƒ¨ç½²åœ¨ä¸€èµ·, é€šå¸¸è¿˜ä¼šæœ‰data colocateçš„ä¼˜åŒ–.  
ç¬¬äºŒä»£æ¼”åŒ–æˆäº†2å±‚çš„ç»“æ„, Data Lake å¯ä»¥å­˜å‚¨åŠç»“æ„åŒ–, å’Œéç»“æ„åŒ–çš„æ•°æ®, ä¾‹å¦‚è§†é¢‘, éŸ³é¢‘  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689420822154-b1da21e0-4dbe-4741-89f3-8fbf66494c4e.png#averageHue=%23d0d1cf&clientId=ua47d4511-2f70-4&from=paste&height=84&id=u535f2cd8&originHeight=168&originWidth=896&originalType=binary&ratio=2&rotation=0&showTitle=false&size=85256&status=done&style=none&taskId=ub00245dd-6973-45e4-9b1a-4a09ac10ee2&title=&width=448)  
è¿™ç§æ¶æ„ä¸‹å¯ä»¥æ”¯æŒéç»“æ„åŒ–æ•°æ®, ä¹Ÿæ”¯æŒç›´æ¥çš„æ•°æ®è®¿é—®, å¯ä»¥æ›´å¥½çš„å¯¹æ¥éSQLçš„æœºå™¨å­¦ä¹ ç³»ç»Ÿ. _ä½†ç›®å‰è‡ªå·±åœ¨ä¸šç•Œæ²¡æœ‰æ˜æ˜¾çš„æ„Ÿå—åˆ°è¿™ç§ä¸¤å±‚çš„ç»“æ„, å¯èƒ½æ˜¯å› ä¸ºæˆ‘å¯¹AIåœºæ™¯æ²¡æ€ä¹ˆæ¥è§¦_  
è®ºæ–‡ä¸­æè¿°è¿™å·²ç»æ˜¯ç»å¤§éƒ¨åˆ†å…¬å¸çš„æ¶æ„äº†  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689421018538-e24021ae-16d4-4e0a-b7cc-0ca0176055ca.png#averageHue=%23d5d5d5&clientId=ua47d4511-2f70-4&from=paste&height=94&id=u9c049f0e&originHeight=188&originWidth=876&originalType=binary&ratio=2&rotation=0&showTitle=false&size=84004&status=done&style=none&taskId=u8c57c030-516c-4e62-b42e-a05a0955ddb&title=&width=438)  
é‚£ä¹ˆæœ‰æ²¡æœ‰å°†ä¼ ç»ŸåŸºäºæ ‡å‡†æ ¼å¼çš„æ•°æ®æ¹–è½¬åŒ–æˆæ—¢æœ‰æ•°ä»“ç®¡ç†èƒ½åŠ›, é«˜æ€§èƒ½çš„åˆ†æèƒ½åŠ›, åˆæœ‰å¿«é€Ÿçš„å¼€æ”¾çš„æ•°æ®è®¿é—®çš„æ¶æ„å‘¢?  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689426200741-985e7bb2-9af0-4ee6-9164-d9e7c8f36952.png#averageHue=%23d4d4d4&clientId=ua47d4511-2f70-4&from=paste&height=95&id=u5e5d5336&originHeight=190&originWidth=886&originalType=binary&ratio=2&rotation=0&showTitle=false&size=75003&status=done&style=none&taskId=u0bc9ad5a-6721-466d-b658-30d85053099&title=&width=443)  
ç­”æ¡ˆæ˜¯ Lakehouse = Data Lake + Data warehouse.  
æ•°æ®ç›´æ¥å­˜å‚¨äºObject storeä¹‹ä¸Š, è€Œä¸Šå±‚çš„BIç³»ç»Ÿ, æœºå™¨å­¦ä¹ , æ•°æ®ç§‘å­¦è®¡ç®—éƒ½ç›´æ¥ä»Lakehouseä¸­å–æ•°åˆ†æ, è¿™æ ·å°±å®ç°äº†å­˜å‚¨å±‚çš„ç»Ÿä¸€. é€šè¿‡Data Lake å’Œ Data warehouseçš„ç»“åˆå®ç°äº†ä¸¤è€…èƒ½åŠ›çš„ç»“åˆ.  
è€ŒLakehouse å°±å¯ä»¥åŸºäºå‰æ–‡æ‰€ä»‹ç»çš„Delta lakeæ¥æ„å»º, å¯ä»¥çœ‹å‡ºLakehouseæ˜¯å¯¹ä¼ ç»Ÿæ•°ä»“çš„ä¸€æ¬¡å‡çº§. ä½†æ˜¯çº¯ç²¹è¿™æ ·çš„æ¶æ„æ€§èƒ½ä¹Ÿè®¸æ²¡æœ‰åŸå…ˆæ•°ä»“ä¸­è®¡ç®—å­˜å‚¨ç´§è€¦åˆçš„æ€§èƒ½å¥½, æ¯•ç«Ÿå¤šäº†é¢å¤–çš„è·¨ç½‘ç»œæ‹‰å–æ•°æ®çš„å¼€é”€  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689426551639-ea87efc3-7e78-4a25-ae34-98f425988d86.png#averageHue=%23cecfce&clientId=ua47d4511-2f70-4&from=paste&height=161&id=u074c4362&originHeight=322&originWidth=912&originalType=binary&ratio=2&rotation=0&showTitle=false&size=154964&status=done&style=none&taskId=u53a1d760-0b2d-498c-ab9f-9c3843b6c10&title=&width=456)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689426560802-2b361ca2-5666-4e63-b332-088b3e9783ad.png#averageHue=%23d4d4d4&clientId=ua47d4511-2f70-4&from=paste&height=76&id=u468f2f5d&originHeight=152&originWidth=876&originalType=binary&ratio=2&rotation=0&showTitle=false&size=69179&status=done&style=none&taskId=u462378e6-e942-4f26-9f3a-b8090e0b88e&title=&width=438)

![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689427159722-5cf36fae-1928-45cb-bbbf-8ba8bc0f316f.png#averageHue=%23d1d1d1&clientId=ua47d4511-2f70-4&from=paste&height=80&id=u0b80dd8b&originHeight=160&originWidth=910&originalType=binary&ratio=2&rotation=0&showTitle=false&size=76866&status=done&style=none&taskId=ua5ab526e-bc46-44e5-823a-09a8e2b05fa&title=&width=455)  
**æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ€§èƒ½é—®é¢˜**

Lakehouseæ¶æ„
===========

*   åŸºäºå¯ä»¥ç›´æ¥è®¿é—®çš„, æ ‡å‡†çš„æ–‡ä»¶æ ¼å¼, å…¸å‹çš„å¦‚Parquet. æ‰€ä»¥Lakehouseæä¾›æ˜¯ä¸€å¥—åŸºäºæ–‡ä»¶çš„æ¥å£, å¯ä»¥ç›´æ¥è®¿é—®å­˜å‚¨çš„æ•°æ®, å¹¶ä¸”æä¾›äº†äº‹åŠ¡æ€§çš„ä¿éšœ
*   åŸºäºäº‘ä¸Šçš„å»‰ä»·å¯¹è±¡å­˜å‚¨
*   é€šè¿‡å…ƒæ•°æ®å±‚å®ç°äº‹åŠ¡æœºåˆ¶
*   å¯¹æœºå™¨å­¦ä¹ å’Œæ•°æ®ç§‘å­¦çš„æ”¯æŒæ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§
*   æä¾›æ€§èƒ½ä¿éšœ

å¦‚ä½•ä¿éšœæ€§èƒ½å‘¢?

*   caching å¯¹äºçƒ­æ•°æ®é€šè¿‡æœ¬åœ°ssdç¼“å­˜åŠ é€ŸæŸ¥è¯¢
*   auxiliary data structures such as indexes and statistics, and data layout optimizations. é€šè¿‡ç´¢å¼•, æ•°æ®é‡æ’å’Œæ•°æ®æ’å¸ƒçš„ä¼˜åŒ–. å¯¹äºçƒ­æ•°æ®, é€šè¿‡ç¼“å­˜å¯ä»¥å®ç°å’Œä¼ ç»Ÿæ•°ä»“ä¸­æ•°æ®co-locateçš„ä¼˜åŒ–, è€Œå¯¹äºå†·æ•°æ®, å½±å“æœ€å¤§çš„æ˜¯æ•°æ®è¯»å–çš„å¤šå°‘, å› æ­¤é€šè¿‡ä¸€ç³»åˆ—è¾…åŠ©æ•°æ®, å¯ä»¥å¤§å¤§å‡å°‘éœ€è¦æ‰«æçš„æ•°æ®é‡
*   Data layout: Zorder
*   æŸ¥è¯¢å¼•æ“è‡ªèº«ä¼˜åŒ–, å‘é‡åŒ–æ‰§è¡Œå¼•æ“

æœ‰å¾…æ¢ç´¢çš„ä¼˜åŒ–

*   ä¸“ä¸ºLakehouseæ‰€è®¾è®¡çš„format, è™½ç„¶åœ¨ä¸€ç›´å¼ºè°ƒstandard format: Parquet/Orc, ä½†æ˜¯çœ‹å‡ºæ¥è¿˜æ˜¯æœ‰è®¾è®¡ä¸€å¥—æ–°çš„formatçš„æ„å›¾, ä¸çŸ¥é“Databricksåœ¨Parquet/Orcæœ‰ç¢°åˆ°ä»€ä¹ˆç—›ç‚¹ ğŸ¤”

![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689427500677-ca2b47b6-adb3-4d62-825a-2a56e85e8b99.png#averageHue=%23d3c3ab&clientId=ua47d4511-2f70-4&from=paste&height=55&id=u7e0aeb42&originHeight=110&originWidth=890&originalType=binary&ratio=2&rotation=0&showTitle=false&size=55432&status=done&style=none&taskId=uc75857fd-265c-44ca-b821-0808c852064&title=&width=445)

*   æ›´å¤šçš„ç´¢å¼•å’Œlayoutä¼˜åŒ–

![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689427407494-e5f21723-0dd0-40c3-a756-03f5f5c2ec9b.png#averageHue=%23f1f0f0&clientId=ua47d4511-2f70-4&from=paste&height=390&id=u1f826a6e&originHeight=780&originWidth=882&originalType=binary&ratio=2&rotation=0&showTitle=false&size=108237&status=done&style=none&taskId=u49f7b168-46d7-4c4b-ac10-ac667478eb7&title=&width=441)  
ä¸ä¼ ç»Ÿæ•°ä»“çš„æ€§èƒ½å’Œcostå¯¹æ¯”. _å’‹æ²¡æœ‰snowflakeå‘¢_? ä¸ç®¡æ˜¯æ€§èƒ½å’Œæ€§ä»·æ¯”ä¸Šéƒ½éå¸¸ä¸é”™.

ä¸è¿‡, åœ¨SQLä¸Šèƒ½å¾ˆå¥½çš„åˆ©ç”¨ä¸‹æ¨, å‰ªæä¼˜åŒ–. ä½†æ˜¯æœºå™¨å­¦ä¹ åº“çš„å¾ˆå¤šapi, å¹¶æ²¡æœ‰å°†queryçš„è¯­ä¹‰ä¸‹æ¨åˆ°å­˜å‚¨å±‚, å¯¼è‡´è¿™ç§æ¡†æ¶ä¸­å°±æ— æ³•å¾ˆå¥½çš„åˆ©ç”¨è¿™äº›statistics.  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689427807266-29ba9ad8-8941-4d34-a3ad-662c5fe4b32f.png#averageHue=%23d1d1cf&clientId=ua47d4511-2f70-4&from=paste&height=77&id=u141ea659&originHeight=154&originWidth=894&originalType=binary&ratio=2&rotation=0&showTitle=false&size=81312&status=done&style=none&taskId=u8ef0750b-9990-411b-929f-642f659c0b1&title=&width=447)  
å› æ­¤è¿™é‡Œå°±éœ€è¦é‡æ–°è®¾è®¡è¿™äº›æœºå™¨å­¦ä¹ åº“çš„api.  
![image.png](https://cdn.nlark.com/yuque/0/2023/png/492896/1689427878338-5dcf7080-80ce-408e-b69b-2b84a99ea342.png#averageHue=%23d2d2d2&clientId=ua47d4511-2f70-4&from=paste&height=81&id=ua5c1e734&originHeight=162&originWidth=896&originalType=binary&ratio=2&rotation=0&showTitle=false&size=84078&status=done&style=none&taskId=u5eaccd55-c0ec-4d48-acbe-5d5afce369c&title=&width=448)

Related work
============

M. Brantner, D. Florescu, D. Graf, D. Kossmann, and T. Kraska. Building a database on S3. In SIGMOD, pages 251â€“264, 01 2008. çœ‹åˆ°ä¸€ç¯‡2008å¹´å°±å°è¯•å°†DBMSå­˜å‚¨è½åœ¨s3ä¸Š, çœŸæ˜¯å…ˆè¿›

æ€»ç»“
==

è¿™ç¯‡è®ºæ–‡çš„å¹²è´§æ¯”è¾ƒå°‘, æ„Ÿè§‰åªæ˜¯æŠŠDelta lakeçš„ä½¿ç”¨åœºæ™¯æ³›åŒ–äº†ä¸€ä¸‹, æ¨å‡ºäº†ä¸€ä¸ªæ–°åè¯, lakehouse. ç°åœ¨ç¡®å®æœ‰è¿™ä¸ªæ¼”è¿›çš„æ–¹å‘, ç»Ÿä¸€å­˜å‚¨, å¹¶åœ¨ç»Ÿä¸€çš„å­˜å‚¨ä¸Šè¿è¡Œå„ç§workload. ä¸è¿‡å…¶ä¸­çš„æ€§èƒ½æŒ‘æˆ˜ä¹Ÿä¸å°.

æœ¬æ–‡æ¥è‡ªåšå®¢å›­ï¼Œä½œè€…ï¼š[Aitozi](https://www.cnblogs.com/Aitozi/)ï¼Œè½¬è½½è¯·æ³¨æ˜åŸæ–‡é“¾æ¥ï¼š[https://www.cnblogs.com/Aitozi/p/17557030.html](https://www.cnblogs.com/Aitozi/p/17557030.html)