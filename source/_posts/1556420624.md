---
layout: post
title: "JSP çš„æœ¬è´¨åŸç†è§£æï¼š"ç¼–å†™çš„æ—¶å€™æ˜¯JSPï¼Œå¿ƒé‡Œæƒ³è§£è¯»çš„æ˜¯ java æºç ""
date: "2023-05-01T01:11:01.324Z"
---
JSP çš„æœ¬è´¨åŸç†è§£æï¼š"ç¼–å†™çš„æ—¶å€™æ˜¯JSPï¼Œå¿ƒé‡Œæƒ³è§£è¯»çš„æ˜¯ java æºç "
=======================================

JSP çš„æœ¬è´¨åŸç†è§£æï¼š"ç¼–å†™çš„æ—¶å€™æ˜¯JSPï¼Œå¿ƒé‡Œæƒ³è§£è¯»çš„æ˜¯ java æºç "
=======================================

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013829-1336930588.png)

@

ç›®å½•

*   [JSP çš„æœ¬è´¨åŸç†è§£æï¼š"ç¼–å†™çš„æ—¶å€™æ˜¯JSPï¼Œå¿ƒé‡Œæƒ³è§£è¯»çš„æ˜¯ java æºç "](#jsp-çš„æœ¬è´¨åŸç†è§£æç¼–å†™çš„æ—¶å€™æ˜¯jspå¿ƒé‡Œæƒ³è§£è¯»çš„æ˜¯-java-æºç )
    *   [æ¯åšä¸€æ–‡æ¡ˆ](#æ¯åšä¸€æ–‡æ¡ˆ)
    *   [1\. JSP æ¦‚è¿°](#1-jsp--æ¦‚è¿°)
    *   [2\. ç¬¬ä¸€ä¸ª JSP ç¨‹åº](#2-ç¬¬ä¸€ä¸ª-jsp-ç¨‹åº)
    *   [3\. JSP çš„æœ¬è´¨å°±æ˜¯ Servlet](#3-jsp-çš„æœ¬è´¨å°±æ˜¯-servlet)
    *   [4\. JSP çš„åŸºç¡€è¯­æ³•](#4-jsp-çš„åŸºç¡€è¯­æ³•)
        *   [4.1 åœ¨ JSP æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™æ–‡å­—](#41-åœ¨-jsp-æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™æ–‡å­—)
        *   [4.2 åœ¨JSPä¸­ç¼–å†™Javaç¨‹åº <% %> ä¸ <%! %>](#42-åœ¨jspä¸­ç¼–å†™javaç¨‹åº---ä¸--)
            *   [4.2.1 <% %>](#421--)
            *   [4.2.2 <%! %>](#422----)
        *   [4.3 é€šè¿‡JSPå½“ä¸­çš„ <%= %>å‘æµè§ˆå™¨å‰ç«¯è¾“å…¥ Javaå˜é‡](#43-é€šè¿‡jspå½“ä¸­çš„---å‘æµè§ˆå™¨å‰ç«¯è¾“å…¥-javaå˜é‡)
        *   [4.4 åœ¨JSP ä¸­çš„ä¸“ä¸šæ³¨é‡Š](#44-åœ¨jsp-ä¸­çš„ä¸“ä¸šæ³¨é‡Š)
        *   [4.5 JSPåŸºç¡€è¯­æ³•æ€»ç»“ï¼š](#45-jspåŸºç¡€è¯­æ³•æ€»ç»“)
    *   [5\. JSPçš„æŒ‡ä»¤](#5-jspçš„æŒ‡ä»¤)
    *   [6\. JSPçš„ä¹å¤§å†…ç½®å¯¹è±¡](#6-jspçš„ä¹å¤§å†…ç½®å¯¹è±¡)
    *   [7\. ä½¿ç”¨Servlet + JSPå®Œæˆoaé¡¹ç›®çš„æ”¹é€ ](#7-ä½¿ç”¨servlet--jspå®Œæˆoaé¡¹ç›®çš„æ”¹é€ )
    *   [8\. è¡¥å……ï¼š](#8-è¡¥å……)
    *   [9\. æ€»ç»“:](#9-æ€»ç»“)
    *   [10\. æœ€åï¼š](#10-æœ€å)

* * *

æ¯åšä¸€æ–‡æ¡ˆ
-----

    æ´»æ˜ç™½çš„äººï¼Œä¸€ç”Ÿåªåšå¥½äº†è¿™ä¸¤ä»¶äº‹ï¼š
    æ¯ä¸ªç¬é—´éƒ½å……æ»¡äº†é€‰æ‹©å’Œæ‰¿æ‹…ï¼Œå°±ç®—é¢å‰æ˜¯ä¸€åº§ç‹¬æœ¨æ¡¥ï¼Œä¹Ÿå¿…é¡»é€‰æ‹©æ˜¯å‰è¿›åé€€ï¼Œäº¦æˆ–æ˜¯ç•™åœ¨åŸåœ°æ­¤æ—¶æ­¤åˆ»ä½ æ‰€ç»å†çš„ä¸€åˆ‡ã€‚
    è¿™æ˜¯è¿‡å¾€æ— æ•°ä¸ªé€‰æ‹©åçš„ç»“æœï¼Œå“ªäº›å°çš„é€‰æ‹©æ±‡èšåœ¨äº†ä¸€èµ·ï¼Œæœ€ç»ˆæˆäº†æˆ‘ä»¬ä»Šå¤©çš„æ—¶å…‰ã€‚
    å…¶å®ï¼Œæ´»æ˜ç™½çš„äººä¸€ç”Ÿåªåšå¥½äº†ä¸¤ä»¶äº‹çœ‹ï¼Œä¸€æ˜¯é€‰æ‹©ï¼ŒäºŒæ˜¯æ‰¿æ‹…ã€‚å¸¸å¬äººäº‰è®ºé€‰æ‹©å’ŒåŠªåŠ›å“ªä¸ªæ›´é‡è¦ã€‚
    å…¶å®ï¼ŒåŠªåŠ›å¹¶ä¸æ˜¯é€‰æ‹©çš„å¯¹æ¯”é¢ï¼Œè€Œæ˜¯æ‹¥æœ‰é€‰æ‹©çš„åŸºæœ¬æ¡ä»¶ã€‚ä¸åŠªåŠ›çš„äººå¾€å¾€è¿é€‰æ‹©çš„èµ„æ ¼éƒ½æ²¡æœ‰ï¼ŒåŠªåŠ›æ˜¯ä¸ºäº†ï¼Œ
    æ›´å¥½çš„é€‰æ‹©ã€‚æ­£å¦‚é©¬ä¼¯åº¸è¯´ï¼šæ‰€è°“çš„é€‰æ‹©åªæ˜¯åŠªåŠ›æ‰€èµ‹äºˆäººçš„ä¸€ç§èµ„æ ¼ã€‚
    æ‰€æœ‰çš„ä¸€å¤œæˆåï¼Œåˆ¹é‚£çš„ç„°ç«ï¼Œå®é™…æ˜¯è¿‡å¾€ä»Šå¹´é»˜é»˜åŠªåŠ›åŸ‹ä¸‹çš„ä¼ç¬”ï¼Œå› æ­¤è¿™é‡Œè¯´çš„é€‰æ‹©ä¸æ˜¯æŠ•æœºå–å·§çš„å°èªæ˜ã€‚
    è€Œæ˜¯ç§¯æ·€åçš„æ·±æ€ç†Ÿè™‘ã€‚å¸¸è¨€é“ï¼šé€‰æ‹©ä¸å¯¹ï¼ŒåŠªåŠ›ç™½è´¹ã€‚
    æå…°å¨Ÿé™¢å£«åœ¨ä¸ºäº†æ±•å¤´å¤§å­¦çš„æ¯•ä¸šå­¦ç”Ÿé€ä¸Šç»™äºˆæ—¶ï¼Œè¡¨ç¤ºï¼šä¸ç®¡æ˜¯åœ¨ç”Ÿæ´»è¿˜æ˜¯äº‹ä¸šä¸Šï¼Œæœ‰å¾ˆå¤šå¤–éƒ¨å˜åŒ–å’Œç¯å¢ƒå› ç´ æ˜¯æˆ‘ä»¬
    æ‰€æ— æ³•é€‰æ‹©çš„ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©çš„æ˜¯åœ¨æ¯ä¸€ä¸ªäººç”Ÿè·¯å£è¦åšå‡ºæ€æ ·çš„é€‰æ‹©ï¼Œä»¥åŠå¦‚ä½•å‹‡æ•¢çš„å‰è¡Œã€‚
    æˆ‘ä»¬æ‰€æœ‰çš„äººéƒ½åœ¨å…±äº«ä¸€æ®µå²æœˆï¼Œå´åœ¨ä¸åŒçš„é€‰æ‹©ä¸­åˆ†é“æ‰¬é•³ï¼Œå› ä¸ºäººç”Ÿæœ€é‡è¦çš„é™¤äº†åŠªåŠ›è¿˜æœ‰é€‰æ‹©ã€‚
    å½“ä½ è¢«ç”Ÿæ´»çš„ç–²æƒ«è£¹æŒŸç€ï¼Œè¢«ç¯å¢ƒçš„è‰°éš¾ç‰µåˆ¶ç€ï¼Œè¿™æ—¶ä½ è¦ä¹ˆè¢«ç”Ÿæ´»ç‰µç€é¼»å­èµ°ï¼Œè¦ä¹ˆæ¥æ”¶ç—›è‹¦ä¸æ‰“å‡»ï¼ŒæŠ—ä½ä¸€åœºåœºæš´é£é›ªï¼Œä¸»åŠ¨è¿å‡»ä¸€åœ°é¸¡æ¯›çš„çç¢ï¼Œä½ è¦åšçš„ä¸æ˜¯æŠ±æ€¨ç”Ÿæ´»çš„ä¸å…¬ï¼Œè€Œæ˜¯è¿ˆå‡ºæ­¥å­ï¼Œå¤ºä¸‹ç”Ÿæ´»çš„ä¸»å¯¼æƒï¼Œåšå‡ºé€‰æ‹©äº†ã€‚
    ä¸€ç§é€‰æ‹©å°±æ˜¯ä¸€ç§ä»£ä»·ï¼Œä¸åŒçš„é€‰æ‹©é€ å°±äº†ä¸åŒçš„äººç”Ÿï¼Œäººæ‰“ä»ç”Ÿä¸‹æ¥å°±é¢ä¸´ç€å¾ˆå¤šç§æœªçŸ¥çš„å¯èƒ½ã€‚
    æœªæ¥éƒ½æ˜¯ä¸€å¼ ç™½çº¸ï¼Œä»»ç”±è‡ªå·±å»ä¸Šè‰²ä½œç”»ã€‚æœ‰äº›äººå®Œæˆåœ°å¾ˆå¥½ï¼Œä¹Ÿæœ‰äººç”»å¾—ä¸€å›¢ç³Ÿï¼Œäººç”Ÿçš„ä¸€ä¸‡ç§å¯èƒ½å¥½çš„ï¼Œä¸å¥½çš„
    éƒ½æ˜¯æœ‰è®¤çœŸé€‰æ‹©å¥½ã€‚
    æ¯ä¸€æ”¯ç”»ç¬”ï¼Œåœ¨æ¯æ¬¡é€‰æ‹©æ—¶éƒ½è¦åšæŒåŸåˆ™ï¼Œä¾¿æ˜¯å¯¹è‡ªå·±çš„äººç”Ÿè´Ÿè´£ã€‚
    
                                                â€”â€”â€”â€”â€”â€” ã€Šä¸€ç¦…å¿ƒçµåº™è¯­ã€‹
    

1\. JSP æ¦‚è¿°
----------

**JSPï¼ˆå…¨ç§°JavaServer Pagesï¼‰**ï¼Œsunå…¬å¸ä¸»å¯¼çš„ä¸€ç§åŠ¨æ€ç½‘é¡µæŠ€æœ¯ï¼ŒJSPåœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œå¯ä»¥å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œæ ¹æ®è¯·æ±‚å†…å®¹åŠ¨æ€çš„ç”ŸæˆHTMLã€XMLæˆ–å…¶ä»–æ ¼å¼æ–‡æ¡£çš„Webç½‘é¡µç„¶åè¿”å›è¯·æ±‚è€…ã€‚åœ¨[JSPé¡µé¢](https://so.csdn.net/so/search?q=JSP%E9%A1%B5%E9%9D%A2&spm=1001.2101.3001.7020)å¯ä»¥åµŒå…¥Javaä»£ç ï¼ŒJSPæ–‡ä»¶åœ¨è¿è¡Œæ—¶ä¼šè¢«å…¶ç¼–è¯‘å™¨è½¬æ¢æˆæ›´åŸå§‹çš„Servletä»£ç ï¼Œç„¶åå†ç”±Javaç¼–è¯‘å™¨æ¥ç¼–è¯‘æˆèƒ½å¿«é€Ÿæ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç ã€‚

**2.ç‰¹ç‚¹:**

1.  èƒ½ä»¥æ¨¡æ¿åŒ–çš„æ–¹å¼ç®€å•ã€é«˜æ•ˆåœ°æ·»åŠ åŠ¨æ€ç½‘é¡µå†…å®¹ã€‚
2.  å¯åˆ©ç”¨JavaBeanå’Œæ ‡ç­¾åº“æŠ€æœ¯å¤ç”¨å¸¸ç”¨çš„åŠŸèƒ½ä»£ç ã€‚
3.  æœ‰è‰¯å¥½çš„å·¥å…·æ”¯æŒã€‚
4.  ç»§æ‰¿äº†Javaè¯­è¨€çš„ç›¸å¯¹æ˜“ç”¨æ€§ã€‚
5.  ç»§æ‰¿äº†Javaçš„è·¨å¹³å°ä¼˜åŠ¿ï¼Œå®ç°â€œä¸€æ¬¡ç¼–å†™ï¼Œå¤„å¤„è¿è¡Œâ€ã€‚
6.  é¡µé¢ä¸­çš„åŠ¨ï¼ˆæ§åˆ¶å˜åŠ¨å†…å®¹çš„éƒ¨åˆ†ï¼‰/é™ï¼ˆå†…å®¹ä¸éœ€å˜åŠ¨çš„éƒ¨åˆ†ï¼‰åŒºåŸŸä»¥åˆ†æ•£ä½†åˆæœ‰åºçš„å½¢å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿å¼€å‘ç»´æŠ¤ã€‚
7.  å¯ä¸å…¶å®ƒä¼ä¸šçº§JavaæŠ€æœ¯ç›¸äº’é…åˆã€‚JSPå¯ä»¥åªä¸“é—¨è´Ÿè´£é¡µé¢ä¸­çš„æ•°æ®å‘ˆç°ï¼Œå®ç°åˆ†å±‚å¼€å‘ã€‚

**3.JSPé¡µé¢ç»„æˆ:**

åœ¨ HTML é¡µé¢æ–‡ä»¶ä¸­åŠ å…¥ Java ç¨‹åºæ®µå’Œ JSP æ ‡ç­¾ï¼Œå³å¯æ„æˆä¸€ä¸ª JSP é¡µæ–‡ä»¶ï¼ŒJSP é¡µé¢ç”± 5 ç§å…ƒç´ ç»„åˆè€Œæˆã€‚  
æ™®é€šçš„ HTML æ ‡è®°ç¬¦ã€‚

1.  JSP æ ‡ç­¾ï¼Œå¦‚æŒ‡ä»¤æ ‡ç­¾ã€åŠ¨ä½œæ ‡ç­¾ã€‚
2.  å˜é‡å’Œæ–¹æ³•çš„å£°æ˜ã€‚
3.  Java ç¨‹åºæ®µã€‚
4.  Java è¡¨è¾¾å¼ã€‚

2\. ç¬¬ä¸€ä¸ª JSP ç¨‹åº
--------------

æˆ‘çš„ç¬¬ä¸€ä¸ªJSPç¨‹åºï¼š

è¿™é‡Œç»™ä¸€ä¸ªå°çš„å»ºè®®ï¼Œå¤§å®¶åœ¨é˜…è¯»å¦‚ä¸‹ï¼Œæ–‡ç« æ—¶ï¼Œå¯ä»¥å¸¦ç€ä¸€ä¸ªè¿™æ ·çš„é—®é¢˜ï¼šJSP æ˜¯ä»€ä¹ˆ ï¼Ÿ å»é˜…è¯»æ–‡ç« ï¼Œæœ‰åŠ©äºåé¢çš„å†…å®¹ä¸Šçš„é˜…è¯»ç†è§£ã€‚

åœ¨**WEB-INF**ç›®å½•ä¹‹å¤–åˆ›å»ºä¸€ä¸ª `index.jsp`æ–‡ä»¶ï¼Œç„¶åè¿™ä¸ªæ–‡ä»¶ä¸­æ²¡æœ‰ä»»ä½•å†…å®¹ã€‚**æ³¨æ„** äº†ï¼šæˆ‘ä»¬å¯¹äºè¿™ä¸ªjsp æ–‡ä»¶å½“ä¸­å¹¶æ²¡æœ‰ç¼–å†™ä»»ä½•çš„å†…å®¹ï¼Œä¸€ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªæ ‡ç‚¹éƒ½å¯ä»¥ï¼Œå°±æ˜¯ä¸€ä¸ªç©ºç™½çš„ã€‚å¦‚ä¸‹æ˜¾ç¤ºçš„ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013691-110435433.png)

å°†ä¸Šé¢çš„é¡¹ç›®éƒ¨ç½²ä¹‹åï¼Œå¯åŠ¨æœåŠ¡å™¨ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ä»¥ä¸‹åœ°å€ `http://127.0.0.1:8080/servlet14/index.jsp` æˆ‘ä»¬éƒ¨ç½²çš„é¡¹ç›®çš„è·¯å¾„ï¼šå…·ä½“æ˜¾ç¤ºå¦‚ä¸‹ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013756-1291741283.png)

**é‡ç‚¹ï¼š** å®é™…ä¸Šæˆ‘ä»¬è®¿é—®çš„ä»¥ä¸Šçš„è¿™ä¸ªï¼š`index.jsp`ï¼Œåº•å±‚æ‰§è¡Œçš„æ˜¯ï¼š`index_jsp.class` è¿™ä¸ªjavaç¨‹åºã€‚æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬æœ¬åœ°ç”µè„‘ä¸Šè®¿é—®åˆ°è¯¥ç”Ÿæˆæ˜¯ `index_jsp.classï¼Œindex_jsp.java`çš„æ–‡ä»¶ï¼Œè¯¥ç”Ÿæˆçš„å¯¹åº”çš„.class,.javaæ–‡ä»¶æ‰€åœ¨çš„è·¯å¾„æ˜¯åœ¨æˆ‘ä»¬å¯åŠ¨ Tomcat æœåŠ¡å™¨å½“ä¸­æç¤ºçš„ï¼Œä¸€ä¸ª `CATALINA_BASE`è·¯å¾„ä¸‹çš„ `C:\Users\huo\AppData\Local\JetBrains\IntelliJIdea2022.1\tomcat\4b6bbfbb-d520-498b-b8f2-090a7ad68f62`

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013784-1146258274.png)

è¿™ä¸ªindex.jspä¼šè¢«tomcatç¿»è¯‘ç”Ÿæˆindex\_jsp.javaæ–‡ä»¶ï¼Œç„¶åtomcatæœåŠ¡å™¨åˆä¼šå°† `index_jsp.java`ç¼–è¯‘ç”Ÿæˆ`index_jsp.class`æ–‡ä»¶ã€‚è®¿é—®`index.jsp`ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯`index_jsp.class`ä¸­çš„æ–¹æ³•ã€‚

å¦‚ä¸‹æ˜¯æˆ‘ä»¬è®¿é—® `index.jsp` åœ¨æˆ‘æœ¬åœ°ç”µè„‘ä¸Šç”Ÿæˆçš„ CATALINA\_BASEçš„ è·¯å¾„ä¸‹çš„ï¼Œindex\_jsp.javaï¼Œindex\_jsp.class çš„æ–‡ä»¶ã€‚ `C:\Users\huo\AppData\Local\JetBrains\IntelliJIdea2022.1\tomcat\4b6bbfbb-d520-498b-b8f2-090a7ad68f62\work\Catalina\localhost\servlet14\org\apache\jsp`

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013744-1904668629.png)

**å¦‚ä¸‹æ˜¯æˆ‘ä»¬çš„ä¸€ä¸ª `index.jspï¼ˆç©ºå†…å®¹ï¼‰` è¢«ç¿»è¯‘ä¸º `index_jsp.java` æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š**

    /*
     * Generated by the Jasper component of Apache Tomcat
     * Version: Apache Tomcat/10.0.12
     * Generated at: 2023-04-21 03:20:48 UTC
     * Note: The last modified time of this file was set to
     *       the last modified time of the source file after
     *       generation to assist with modification tracking.
     */
    package org.apache.jsp;
    
    import jakarta.servlet.*;
    import jakarta.servlet.http.*;
    import jakarta.servlet.jsp.*;
    
    public final class index_jsp extends org.apache.jasper.runtime.HttpJspBase
        implements org.apache.jasper.runtime.JspSourceDependent,
                     org.apache.jasper.runtime.JspSourceImports {
    
      private static final jakarta.servlet.jsp.JspFactory _jspxFactory =
              jakarta.servlet.jsp.JspFactory.getDefaultFactory();
    
      private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_packages;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_classes;
    
      static {
        _jspx_imports_packages = new java.util.HashSet<>();
        _jspx_imports_packages.add("jakarta.servlet");
        _jspx_imports_packages.add("jakarta.servlet.http");
        _jspx_imports_packages.add("jakarta.servlet.jsp");
        _jspx_imports_classes = null;
      }
    
      private volatile jakarta.el.ExpressionFactory _el_expressionfactory;
      private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;
    
      public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
        return _jspx_dependants;
      }
    
      public java.util.Set<java.lang.String> getPackageImports() {
        return _jspx_imports_packages;
      }
    
      public java.util.Set<java.lang.String> getClassImports() {
        return _jspx_imports_classes;
      }
    
      public jakarta.el.ExpressionFactory _jsp_getExpressionFactory() {
        if (_el_expressionfactory == null) {
          synchronized (this) {
            if (_el_expressionfactory == null) {
              _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
            }
          }
        }
        return _el_expressionfactory;
      }
    
      public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
        if (_jsp_instancemanager == null) {
          synchronized (this) {
            if (_jsp_instancemanager == null) {
              _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
            }
          }
        }
        return _jsp_instancemanager;
      }
    
      public void _jspInit() {
      }
    
      public void _jspDestroy() {
      }
    
      public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
          throws java.io.IOException, jakarta.servlet.ServletException {
    
        if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
          final java.lang.String _jspx_method = request.getMethod();
          if ("OPTIONS".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            return;
          }
          if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS");
            return;
          }
        }
    
        final jakarta.servlet.jsp.PageContext pageContext;
        jakarta.servlet.http.HttpSession session = null;
        final jakarta.servlet.ServletContext application;
        final jakarta.servlet.ServletConfig config;
        jakarta.servlet.jsp.JspWriter out = null;
        final java.lang.Object page = this;
        jakarta.servlet.jsp.JspWriter _jspx_out = null;
        jakarta.servlet.jsp.PageContext _jspx_page_context = null;
    
    
        try {
          response.setContentType("text/html");
          pageContext = _jspxFactory.getPageContext(this, request, response,
          			null, true, 8192, true);
          _jspx_page_context = pageContext;
          application = pageContext.getServletContext();
          config = pageContext.getServletConfig();
          session = pageContext.getSession();
          out = pageContext.getOut();
          _jspx_out = out;
    
          out.write(' ');
          out.write(' ');
        } catch (java.lang.Throwable t) {
          if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
            out = _jspx_out;
            if (out != null && out.getBufferSize() != 0)
              try {
                if (response.isCommitted()) {
                  out.flush();
                } else {
                  out.clearBuffer();
                }
              } catch (java.io.IOException e) {}
            if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
            else throw new ServletException(t);
          }
        } finally {
          _jspxFactory.releasePageContext(_jspx_page_context);
        }
      }
    }
    
    

3\. JSP çš„æœ¬è´¨å°±æ˜¯ Servlet
---------------------

ä»ä¸Šè¿°æˆ‘ä»¬ç¼–å†™çš„ç¬¬ä¸€jsp ç¨‹åºï¼Œindex.jsp ç©ºå†…å®¹çš„ï¼Œindex.jspè®¿é—®çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨ç¿»è¯‘ç”Ÿæˆindex\_jsp.javaï¼Œä¼šè‡ªåŠ¨ç¼–è¯‘ç”Ÿæˆindex\_jsp.classï¼Œé‚£ä¹ˆindex\_jsp è¿™å°±æ˜¯ä¸€ä¸ªç±»ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013869-227011187.png)

ä»å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯¥index.jsp ç¿»è¯‘çš„ index\_jsp.java ç±»æ˜¯ç»§æ‰¿äº† `extends org.apache.jasper.runtime.HttpJspBase` ç±»çš„ï¼Œæˆ‘ä»¬æŸ¥é˜…å…¶ Tomcat 10 çš„ HttpJspBase æºç å¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013788-429668879.png)

**å¦‚ä¸‹æ˜¯ HttpJspBase çš„æºç å†…å®¹**

    /*
     * Licensed to the Apache Software Foundation (ASF) under one or more
     * contributor license agreements.  See the NOTICE file distributed with
     * this work for additional information regarding copyright ownership.
     * The ASF licenses this file to You under the Apache License, Version 2.0
     * (the "License"); you may not use this file except in compliance with
     * the License.  You may obtain a copy of the License at
     *
     *      http://www.apache.org/licenses/LICENSE-2.0
     *
     * Unless required by applicable law or agreed to in writing, software
     * distributed under the License is distributed on an "AS IS" BASIS,
     * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     * See the License for the specific language governing permissions and
     * limitations under the License.
     */
    package org.apache.jasper.runtime;
    
    import java.io.IOException;
    
    import jakarta.servlet.ServletConfig;
    import jakarta.servlet.ServletException;
    import jakarta.servlet.http.HttpServlet;
    import jakarta.servlet.http.HttpServletRequest;
    import jakarta.servlet.http.HttpServletResponse;
    import jakarta.servlet.jsp.HttpJspPage;
    
    import org.apache.jasper.Constants;
    import org.apache.jasper.compiler.Localizer;
    
    /**
     * This is the super class of all JSP-generated servlets.
     *
     * @author Anil K. Vijendran
     */
    public abstract class HttpJspBase extends HttpServlet implements HttpJspPage {
    
        private static final long serialVersionUID = 1L;
    
        protected HttpJspBase() {
        }
    
        @Override
        public final void init(ServletConfig config)
            throws ServletException
        {
            super.init(config);
            jspInit();
            _jspInit();
        }
    
        @Override
        public String getServletInfo() {
            return Localizer.getMessage("jsp.engine.info", Constants.SPEC_VERSION);
        }
    
        @Override
        public final void destroy() {
            jspDestroy();
            _jspDestroy();
        }
    
        /**
         * Entry point into service.
         */
        @Override
        public final void service(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException
        {
            _jspService(request, response);
        }
    
        @Override
        public void jspInit() {
        }
    
        public void _jspInit() {
        }
    
        @Override
        public void jspDestroy() {
        }
    
        protected void _jspDestroy() {
        }
    
        @Override
        public abstract void _jspService(HttpServletRequest request,
                                         HttpServletResponse response)
            throws ServletException, IOException;
    }
    
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013603-951431008.png)

è€Œ HttpServlet æ˜¯ extends äº† GenericServlet æŠ½è±¡ç±»ï¼Œè€Œ GenericServlet æŠ½è±¡ç±»æ˜¯ å®ç°äº† Servlet æ¥å£çš„ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013756-890780822.png)

**æ‰€ä»¥ï¼šä¸€ä¸ªindex\_jspç±»å°±æ˜¯ä¸€ä¸ªServletç±»ã€‚æ€»ç»“å°±æ˜¯ï¼šä¸€ä¸ª index.jsp æ–‡ä»¶ä¼šè¢«ç¿»è¯‘ä¸ºä¸€ä¸ª index\_jsp.java ç±»ï¼Œè€Œ è¯¥ ç¿»è¯‘çš„ index\_jsp.javaç±»æ˜¯ `ç»§æ‰¿` äº† org.apache.jasper.runtime.HttpJspBase ç±»çš„ï¼Œè€Œ org.apache.jasper.runtime.HttpJspBase ç±» æ˜¯ç»§æ‰¿äº† HttpServlet ç±»çš„ã€‚è¿™ä¸‹é€»è¾‘å°±æ¸…æ™°äº†ï¼Œ`JSP å°±æ˜¯ Servlet` ã€‚**

*   JSP çš„ç”Ÿå‘½å‘¨æœŸå’ŒServletçš„ç”Ÿå‘½å‘¨æœŸå®Œå…¨ç›¸åŒã€‚å®Œå…¨å°±æ˜¯ä¸€ä¸ªä¸œè¥¿ã€‚æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚
*   JSPå’Œservletä¸€æ ·ï¼Œéƒ½æ˜¯å•ä¾‹çš„ã€‚ï¼ˆå‡å•ä¾‹ï¼ŒçœŸå•ä¾‹æ˜¯ï¼šå…¶ç±»çš„æ„é€ å™¨æ˜¯ private ç§æœ‰åŒ–çš„ï¼Œè€ŒServlte çš„æ„é€ å™¨ä¸æ˜¯ private ç§æœ‰åŒ–çš„ï¼Œæ˜¯å…¬å¼€çš„ã€‚æ‰€ä»¥ä¸ºå‡å•ä¾‹ï¼‰ï¼Œæƒ³è¦äº†è§£æ›´å¤šçš„ï¼Œå¤§å®¶å¯ä»¥ç§»æ­¥è‡³ï¼š ğŸ”œğŸ”œğŸ”œ [javaEE Web(Tomcat)æ·±åº¦ç†è§£ å’Œ Servletçš„æœ¬è´¨\_ChinaRainbowSeaçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_61635597/article/details/129550291)

**ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒæ¸…æ™°çš„å›ç­” JSPæ˜¯ä»€ä¹ˆäº† ï¼Ÿ**

*   JSPæ˜¯javaç¨‹åºã€‚ï¼ˆJSPæœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªServletï¼‰
*   JSPæ˜¯ï¼šJavaServer Pagesçš„ç¼©å†™ã€‚ï¼ˆåŸºäºJavaè¯­è¨€å®ç°çš„æœåŠ¡å™¨ç«¯çš„é¡µé¢ã€‚ï¼‰
*   Servletæ˜¯JavaEEçš„13ä¸ªå­è§„èŒƒä¹‹ä¸€ï¼Œé‚£ä¹ˆJSPä¹Ÿæ˜¯JavaEEçš„13ä¸ªå­è§„èŒƒä¹‹ä¸€ã€‚
*   JSPæ˜¯ä¸€å¥—è§„èŒƒã€‚æ‰€æœ‰çš„webå®¹å™¨/webæœåŠ¡å™¨éƒ½æ˜¯éµå¾ªè¿™å¥—è§„èŒƒçš„ï¼Œéƒ½æ˜¯æŒ‰ç…§è¿™å¥—è§„èŒƒè¿›è¡Œçš„â€œç¿»è¯‘â€
*   æ¯ä¸€ä¸ªwebå®¹å™¨/webæœåŠ¡å™¨éƒ½ä¼šå†…ç½®ä¸€ä¸ªJSP**ç¿»è¯‘**å¼•æ“ã€‚è¿™é‡Œæ‰€è°“çš„ç¿»è¯‘æŒ‡çš„æ˜¯ï¼š å°†æˆ‘ä»¬è®¿é—®çš„ jsp æ–‡ä»¶ç¿»è¯‘æˆ å¯¹åº”çš„ä»¥`.java` åç¼€ç»“å°¾çš„Javaæ–‡ä»¶ï¼Œå†å°† è¯¥ java æ–‡ä»¶ç¼–è¯‘ç”Ÿæˆ `.class` æ–‡ä»¶ã€‚

**é—®é¢˜ï¼šJSPç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™æ˜¯æ¯”è¾ƒæ…¢çš„ï¼Œä¸ºä»€ä¹ˆï¼Ÿ**

**åŒé—®ï¼š ä¸ºä»€ä¹ˆå¤§éƒ¨åˆ†çš„è¿ç»´äººå‘˜åœ¨ç»™å®¢æˆ·æ¼”ç¤ºé¡¹ç›®çš„æ—¶å€™ï¼Œä¸ºä»€ä¹ˆæå‰å…ˆæŠŠæ‰€æœ‰çš„jspæ–‡ä»¶å…ˆè®¿é—®ä¸€éã€‚**

å› ä¸ºæˆ‘ä»¬ç¬¬ä¸€æ¬¡æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦è¿›è¡Œä¸€ä¸ªé¡¹ç›®çš„èµ„æºçš„åŠ è½½ã€‚

*   ç¬¬ä¸€æ¬¡æ¯”è¾ƒéº»çƒ¦çš„åœ°æ–¹ï¼š
    *   è¦æŠŠjspæ–‡ä»¶ç¿»è¯‘ç”Ÿæˆjavaæºæ–‡ä»¶
    *   javaæºæ–‡ä»¶è¦ç¼–è¯‘ç”Ÿæˆclasså­—èŠ‚ç æ–‡ä»¶
    *   ç„¶åé€šè¿‡classå»åˆ›å»ºservletå¯¹è±¡
    *   ç„¶åè°ƒç”¨servletå¯¹è±¡çš„initæ–¹æ³•
    *   æœ€åè°ƒç”¨servletå¯¹è±¡çš„serviceæ–¹æ³•ã€‚
*   ç¬¬äºŒæ¬¡å°±æ¯”è¾ƒå¿«äº†ï¼Œä¸ºä»€ä¹ˆï¼Ÿ
    *   å› ä¸ºç¬¬äºŒæ¬¡ç›´æ¥è°ƒç”¨å•ä¾‹servletå¯¹è±¡çš„serviceæ–¹æ³•å³å¯ã€‚

* * *

**æ³¨æ„ç‚¹ï¼š**

å®é™…ä¸Šæˆ‘ä»¬å¯¹äº JSP è¿›è¡Œé”™è¯¯è°ƒè¯•çš„æ—¶å€™ï¼Œè¿˜æ˜¯è¦ç›´æ¥æ‰“å¼€JSPæ–‡ä»¶å¯¹åº”ç¿»è¯‘ç”Ÿæˆçš„ javaæ–‡ä»¶ï¼Œæ£€æŸ¥å…¶ä¸­ javaä»£ç ã€‚

å¼€å‘JSPçš„æœ€é«˜å¢ƒç•Œï¼š **çœ¼å‰ç¼–å†™çš„æ˜¯JSPä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¿ƒé‡Œï¼Œè„‘è¢‹é‡Œé¢å½“ä¸­å‘ˆç°çš„æ˜¯ javaä»£ç ã€‚**

**JSPæ—¢ç„¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªServletï¼Œé‚£ä¹ˆJSPå’ŒServletåˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ**

èŒè´£ä¸åŒï¼š

*   Servletçš„èŒè´£æ˜¯ä»€ä¹ˆï¼šæ”¶é›†æ•°æ®ã€‚ï¼ˆServletçš„å¼ºé¡¹æ˜¯åç«¯çš„é€»è¾‘å¤„ç†ï¼Œä¸šåŠ¡å¤„ç†ï¼Œç„¶åé“¾æ¥æ•°æ®åº“ï¼Œè·å–/æ”¶é›†æ•°æ®ã€‚ï¼‰
*   JSPçš„èŒè´£æ˜¯ä»€ä¹ˆï¼šå±•ç¤ºæ•°æ®ã€‚ï¼ˆJSPçš„å¼ºé¡¹æ˜¯åš å‰ç«¯æ•°æ®çš„å±•ç¤ºï¼‰

4\. JSP çš„åŸºç¡€è¯­æ³•
-------------

ä¸Šé¢æˆ‘ä»¬å­¦ä¹ ï¼Œäº†è§£åˆ°äº† JSP çš„æœ¬è´¨åŸç†ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥å­¦ä¹ ä¸€ä¸‹æœ‰å…³ JSPçš„åŸºç¡€è¯­æ³•å§

### 4.1 åœ¨ JSP æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™æ–‡å­—

åœ¨ jsp æ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™æ–‡å­—ï¼Œéƒ½ä¼šè‡ªåŠ¨è¢«ç¿»è¯‘åˆ°å“ªé‡Œï¼Ÿ

å¦‚ä¸‹æˆ‘ä»¬å®éªŒä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨ä¸Šä¸€ä¸ª index.jsp æ–‡ä»¶å½“ä¸­ï¼Œç›´æ¥ç¼–å†™ä¸€ä¸ª â€œHello Wroldâ€ ã€‚å½“æˆ‘ä»¬æµè§ˆå™¨ç«¯è®¿é—®è¯¥ index.jsp æ–‡ä»¶æ—¶ï¼Œæµè§ˆå™¨ç«¯æœ‰æ˜¯æ˜¾ç¤ºä¸€ä¸ªåˆ™æ ·çš„æ•ˆæœï¼Œè€Œå…¶æœ¬è´¨ä¸­ â€œHello Wroldâ€ åˆæ˜¯è¢«ç¿»è¯‘åˆ°äº†ï¼Œæˆäº†ä»€ä¹ˆï¼Œç¿»è¯‘åˆ°äº†å“ªé‡Œã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013823-793959710.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013848-888774969.png)

å¦‚ä¸‹æˆ‘ä»¬æŸ¥çœ‹å¯¹åº” index.jsp ç¿»è¯‘çš„ index\_jsp.java æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š

    /*
     * Generated by the Jasper component of Apache Tomcat
     * Version: Apache Tomcat/10.0.12
     * Generated at: 2023-04-21 06:10:10 UTC
     * Note: The last modified time of this file was set to
     *       the last modified time of the source file after
     *       generation to assist with modification tracking.
     */
    package org.apache.jsp;
    
    import jakarta.servlet.*;
    import jakarta.servlet.http.*;
    import jakarta.servlet.jsp.*;
    
    public final class index_jsp extends org.apache.jasper.runtime.HttpJspBase
        implements org.apache.jasper.runtime.JspSourceDependent,
                     org.apache.jasper.runtime.JspSourceImports {
    
      private static final jakarta.servlet.jsp.JspFactory _jspxFactory =
              jakarta.servlet.jsp.JspFactory.getDefaultFactory();
    
      private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_packages;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_classes;
    
      static {
        _jspx_imports_packages = new java.util.HashSet<>();
        _jspx_imports_packages.add("jakarta.servlet");
        _jspx_imports_packages.add("jakarta.servlet.http");
        _jspx_imports_packages.add("jakarta.servlet.jsp");
        _jspx_imports_classes = null;
      }
    
      private volatile jakarta.el.ExpressionFactory _el_expressionfactory;
      private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;
    
      public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
        return _jspx_dependants;
      }
    
      public java.util.Set<java.lang.String> getPackageImports() {
        return _jspx_imports_packages;
      }
    
      public java.util.Set<java.lang.String> getClassImports() {
        return _jspx_imports_classes;
      }
    
      public jakarta.el.ExpressionFactory _jsp_getExpressionFactory() {
        if (_el_expressionfactory == null) {
          synchronized (this) {
            if (_el_expressionfactory == null) {
              _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
            }
          }
        }
        return _el_expressionfactory;
      }
    
      public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
        if (_jsp_instancemanager == null) {
          synchronized (this) {
            if (_jsp_instancemanager == null) {
              _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
            }
          }
        }
        return _jsp_instancemanager;
      }
    
      public void _jspInit() {
      }
    
      public void _jspDestroy() {
      }
    
      public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
          throws java.io.IOException, jakarta.servlet.ServletException {
    
        if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
          final java.lang.String _jspx_method = request.getMethod();
          if ("OPTIONS".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            return;
          }
          if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS");
            return;
          }
        }
    
        final jakarta.servlet.jsp.PageContext pageContext;
        jakarta.servlet.http.HttpSession session = null;
        final jakarta.servlet.ServletContext application;
        final jakarta.servlet.ServletConfig config;
        jakarta.servlet.jsp.JspWriter out = null;
        final java.lang.Object page = this;
        jakarta.servlet.jsp.JspWriter _jspx_out = null;
        jakarta.servlet.jsp.PageContext _jspx_page_context = null;
    
    
        try {
          response.setContentType("text/html");
          pageContext = _jspxFactory.getPageContext(this, request, response,
          			null, true, 8192, true);
          _jspx_page_context = pageContext;
          application = pageContext.getServletContext();
          config = pageContext.getServletConfig();
          session = pageContext.getSession();
          out = pageContext.getOut();
          _jspx_out = out;
    
          out.write("Hello World");
        } catch (java.lang.Throwable t) {
          if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
            out = _jspx_out;
            if (out != null && out.getBufferSize() != 0)
              try {
                if (response.isCommitted()) {
                  out.flush();
                } else {
                  out.clearBuffer();
                }
              } catch (java.io.IOException e) {}
            if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
            else throw new ServletException(t);
          }
        } finally {
          _jspxFactory.releasePageContext(_jspx_page_context);
        }
      }
    }
    
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013739-1108059080.png)

ç¿»è¯‘åˆ° **servlet**ç±»çš„ **service()** æ–¹æ³•çš„ **out.write("ç¿»è¯‘åˆ°è¿™é‡Œ")** ï¼Œç›´æ¥ç¿»è¯‘åˆ°åŒå¼•å·é‡Œï¼Œè¢«javaç¨‹åºå½“åšæ™®é€šå­—ç¬¦ä¸²æ‰“å°è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚

**è¡¥å……ä¸€ç‚¹ï¼š** è§£å†³æµè§ˆå™¨ç«¯æ˜¾ç¤ºçš„ä¹±ç é—®é¢˜ ï¼Ÿ

> JSPçš„pageæŒ‡ä»¤ï¼ˆè¿™ä¸ªæŒ‡ä»¤åé¢å†è¯¦ç»†è¯´ï¼Œè¿™é‡Œå…ˆè§£å†³ä¸€ä¸‹ä¸­æ–‡ä¹±ç é—®é¢˜ï¼‰ï¼Œè§£å†³å“åº”æ—¶çš„ä¸­æ–‡ä¹±ç é—®é¢˜ï¼š
> 
> *   é€šè¿‡pageæŒ‡ä»¤æ¥è®¾ç½®å“åº”çš„å†…å®¹ç±»å‹ï¼Œåœ¨å†…å®¹ç±»å‹çš„æœ€åé¢æ·»åŠ ï¼šcharset=UTF-8
>     *   <%@page contentType="text/html;charset=UTF-8"%>ï¼Œè¡¨ç¤ºå“åº”çš„å†…å®¹ç±»å‹æ˜¯text/htmlï¼Œé‡‡ç”¨çš„å­—ç¬¦é›†UTF-8
>     *   <%@page import="java.util.List,java.util.ArrayList"%> è¡¨ç¤ºåˆ°å¯¹åº”çš„ åŒ…ä¿¡æ¯

åœ¨JSPä¸­ç¼–å†™çš„HTML CSS JSä»£ç ï¼Œè¿™äº›ä»£ç å¯¹äºJSPæ¥è¯´åªæ˜¯ä¸€ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ã€‚ä½†æ˜¯JSPæŠŠè¿™ä¸ªæ™®é€šçš„å­—ç¬¦ä¸²ä¸€æ—¦è¾“å‡ºåˆ°æµè§ˆå™¨ï¼Œæµè§ˆå™¨å°±ä¼šå¯¹HTML CSS JSè¿›è¡Œè§£é‡Šæ‰§è¡Œã€‚å±•ç°ä¸€ä¸ªæ•ˆæœã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š

    <%@page contentType="text/html; chatSet=UTF-8" %>
    
    <html>
    
    <head>
        <title>my first JSP page</title>
    
        <script type="text/javascript">
            function sayHello() {
                window.alert("ä½ å¥½ JSP")
            }
        </script>
    </head>
    <bady>
        <h1>My first JSP page</h1>
        <input type="button" value="hello jsp" onclick="sayHello()" />
    
        fajsi ffasdfda
        fasd
        afjsfi9
    
        Sytstem.out.println("hello JSP");
    </bady>
    </html>
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013663-280659553.png)

è®¿é—® index.jsp æ˜¾ç¤ºçš„æ•ˆæœå¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013588-763532515.png)

å¯¹åº”ç¿»è¯‘çš„java çš„å†…å®¹å¦‚ä¸‹ï¼š**æ³¨æ„ï¼šéƒ½æ˜¯è¢«ç¿»è¯‘åˆ°äº† service()æ–¹æ³•ä½“å½“ä¸­å»äº†**

     public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
          throws java.io.IOException, jakarta.servlet.ServletException {
    
        if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
          final java.lang.String _jspx_method = request.getMethod();
          if ("OPTIONS".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            return;
          }
          if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS");
            return;
          }
        }
    
        final jakarta.servlet.jsp.PageContext pageContext;
        jakarta.servlet.http.HttpSession session = null;
        final jakarta.servlet.ServletContext application;
        final jakarta.servlet.ServletConfig config;
        jakarta.servlet.jsp.JspWriter out = null;
        final java.lang.Object page = this;
        jakarta.servlet.jsp.JspWriter _jspx_out = null;
        jakarta.servlet.jsp.PageContext _jspx_page_context = null;
    
    
        try {
          response.setContentType("text/html; charset=UTF-8");
          pageContext = _jspxFactory.getPageContext(this, request, response,
          			null, true, 8192, true);
          _jspx_page_context = pageContext;
          application = pageContext.getServletContext();
          config = pageContext.getServletConfig();
          session = pageContext.getSession();
          out = pageContext.getOut();
          _jspx_out = out;
    
          out.write("\r\n");
          out.write("\r\n");
          out.write("<html>\r\n");
          out.write("\r\n");
          out.write("<head>\r\n");
          out.write("    <title>my first JSP page</title>\r\n");
          out.write("\r\n");
          out.write("    <script type=\"text/javascript\">\r\n");
          out.write("        function sayHello() {\r\n");
          out.write("            window.alert(\"ä½ å¥½ JSP\")\r\n");
          out.write("        }\r\n");
          out.write("    </script>\r\n");
          out.write("</head>\r\n");
          out.write("<bady>\r\n");
          out.write("    <h1>My first JSP page</h1>\r\n");
          out.write("    <input type=\"button\" value=\"hello jsp\" onclick=\"sayHello()\" />\r\n");
          out.write("\r\n");
          out.write("    fajsi ffasdfda\r\n");
          out.write("    fasd\r\n");
          out.write("    afjsfi9\r\n");
          out.write("\r\n");
          out.write("    Sytstem.out.println(\"hello JSP\");\r\n");
          out.write("</bady>\r\n");
          out.write("</html>");
    
          
        } catch (java.lang.Throwable t) {
          if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
            out = _jspx_out;
            if (out != null && out.getBufferSize() != 0)
              try {
                if (response.isCommitted()) {
                  out.flush();
                } else {
                  out.clearBuffer();
                }
              } catch (java.io.IOException e) {}
            if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
            else throw new ServletException(t);
          }
        } finally {
          _jspxFactory.releasePageContext(_jspx_page_context);
        }
      }
    }
    
    

### 4.2 åœ¨JSPä¸­ç¼–å†™Javaç¨‹åº <% %> ä¸ <%! %>

#### 4.2.1 <% %>

    <% 
     
    // javaè¯­å¥;
    // åœ¨è¿™é‡Œç¼–å†™Javaç¨‹åºï¼Œç¼–å†™ Javaè¯­å¥ã€‚
    // æ—¢ç„¶æ˜¯ç¼–å†™ Javaè¯­å¥ï¼Œè‡ªç„¶è¦éµå¾ªJavaçš„è¯­æ³•è§„èŒƒã€‚
    // åœ¨è¿™é‡Œç¼–å†™çš„javaè¯­å¥ï¼Œä¼šè¢«ç¿»è¯‘åˆ° service() æ–¹æ³•ä½“å†…
    %>
    

åœ¨è¿™ä¸ª`<% javaè¯­å¥; %>`ç¬¦å·å½“ä¸­ç¼–å†™çš„è¢«è§†ä¸ºjavaç¨‹åºï¼Œè¢«ç¿»è¯‘åˆ°Servletç±»çš„ `serviceæ–¹æ³•ä½“`å†…éƒ¨ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013685-492199400.png)

    
    <%
        System.out.println("Hello World");
    %>
    
    
    <%
        System.out.println("Hello JSP");
    %>
    
    <%
        System.out.println("ä½ å¥½ä¸–ç•Œ");
    %>
    
    

è®¿é—® æµè§ˆå™¨å‰ç«¯è®¿é—®ï¼šdemo01.jsp æ•ˆæœ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013678-2054810696.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013700-79172761.png)

å› ä¸ºæˆ‘ä»¬åªåœ¨ demo01.jsp æ–‡ä»¶å½“ä¸­ç¼–å†™äº†ï¼ŒJavaä»£ç ï¼Œå¹¶æ²¡æœ‰ç¼–å†™å…¶ä»–çš„ï¼Œè€Œä¸”æˆ‘ä»¬çš„Javaä»£ç ç¼–å†™çš„ä»…ä»…åªæ˜¯ä¸€ä¸ªç®€å•çš„è¾“å‡ºåˆ°æ§åˆ¶å°ä¸Šçš„ä¸€ä¸ªè¾“å‡ºè¯­å¥è€Œå·²äº†ã€‚æ‰€ä»¥å‰ç«¯æµè§ˆå™¨æ˜¯æ²¡æœ‰ä»»ä½•çš„æ˜¾ç¤ºå†…å®¹çš„ã€‚

å¦‚ä¸‹æ˜¯ å¯¹åº”æˆ‘ä»¬è®¿é—® demo01.jsp æ–‡ä»¶ç¿»è¯‘ä¸º demo01\_jsp.java æ–‡ä»¶çš„æºç ä¿¡æ¯å¦‚ä¸‹ï¼š

    /*
     * Generated by the Jasper component of Apache Tomcat
     * Version: Apache Tomcat/10.0.12
     * Generated at: 2023-04-21 06:43:13 UTC
     * Note: The last modified time of this file was set to
     *       the last modified time of the source file after
     *       generation to assist with modification tracking.
     */
    package org.apache.jsp;
    
    import jakarta.servlet.*;
    import jakarta.servlet.http.*;
    import jakarta.servlet.jsp.*;
    
    public final class demo01_jsp extends org.apache.jasper.runtime.HttpJspBase
        implements org.apache.jasper.runtime.JspSourceDependent,
                     org.apache.jasper.runtime.JspSourceImports {
    
      private static final jakarta.servlet.jsp.JspFactory _jspxFactory =
              jakarta.servlet.jsp.JspFactory.getDefaultFactory();
    
      private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_packages;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_classes;
    
      static {
        _jspx_imports_packages = new java.util.HashSet<>();
        _jspx_imports_packages.add("jakarta.servlet");
        _jspx_imports_packages.add("jakarta.servlet.http");
        _jspx_imports_packages.add("jakarta.servlet.jsp");
        _jspx_imports_classes = null;
      }
    
      private volatile jakarta.el.ExpressionFactory _el_expressionfactory;
      private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;
    
      public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
        return _jspx_dependants;
      }
    
      public java.util.Set<java.lang.String> getPackageImports() {
        return _jspx_imports_packages;
      }
    
      public java.util.Set<java.lang.String> getClassImports() {
        return _jspx_imports_classes;
      }
    
      public jakarta.el.ExpressionFactory _jsp_getExpressionFactory() {
        if (_el_expressionfactory == null) {
          synchronized (this) {
            if (_el_expressionfactory == null) {
              _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
            }
          }
        }
        return _el_expressionfactory;
      }
    
      public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
        if (_jsp_instancemanager == null) {
          synchronized (this) {
            if (_jsp_instancemanager == null) {
              _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
            }
          }
        }
        return _jsp_instancemanager;
      }
    
      public void _jspInit() {
      }
    
      public void _jspDestroy() {
      }
    
      public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
          throws java.io.IOException, jakarta.servlet.ServletException {
    
        if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
          final java.lang.String _jspx_method = request.getMethod();
          if ("OPTIONS".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            return;
          }
          if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS");
            return;
          }
        }
    
        final jakarta.servlet.jsp.PageContext pageContext;
        jakarta.servlet.http.HttpSession session = null;
        final jakarta.servlet.ServletContext application;
        final jakarta.servlet.ServletConfig config;
        jakarta.servlet.jsp.JspWriter out = null;
        final java.lang.Object page = this;
        jakarta.servlet.jsp.JspWriter _jspx_out = null;
        jakarta.servlet.jsp.PageContext _jspx_page_context = null;
    
    
        try {
          response.setContentType("text/html; charset=UTF-8");
          pageContext = _jspxFactory.getPageContext(this, request, response,
          			null, true, 8192, true);
          _jspx_page_context = pageContext;
          application = pageContext.getServletContext();
          config = pageContext.getServletConfig();
          session = pageContext.getSession();
          out = pageContext.getOut();
          _jspx_out = out;
    
          out.write(' ');
          out.write(' ');
          out.write(' ');
          out.write('\r');
          out.write('\n');
    
        System.out.println("Hello World");
    
          out.write("\r\n");
          out.write("\r\n");
          out.write("\r\n");
    
        System.out.println("Hello JSP");
    
          out.write("\r\n");
          out.write("\r\n");
    
        System.out.println("ä½ å¥½ä¸–ç•Œ");
    
          out.write('\r');
          out.write('\n');
        } catch (java.lang.Throwable t) {
          if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
            out = _jspx_out;
            if (out != null && out.getBufferSize() != 0)
              try {
                if (response.isCommitted()) {
                  out.flush();
                } else {
                  out.clearBuffer();
                }
              } catch (java.io.IOException e) {}
            if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
            else throw new ServletException(t);
          }
        } finally {
          _jspxFactory.releasePageContext(_jspx_page_context);
        }
      }
    }
    
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013804-1029897962.png)

**<% %>çš„ä½¿ç”¨çš„æ³¨æ„äº‹é¡¹ï¼š**

*   è¿™é‡Œä½ è¦ç»†å¿ƒç‚¹ï¼Œä½ è¦æ€è€ƒï¼Œåœ¨<% %>è¿™ä¸ªç¬¦å·é‡Œé¢å†™javaä»£ç çš„æ—¶å€™ï¼Œä½ è¦æ—¶æ—¶åˆ»åˆ»çš„è®°ä½ä½ æ­£åœ¨â€œ`sevice() æ–¹æ³•ä½“`â€å½“ä¸­å†™ä»£ç ï¼Œæ–¹æ³•ä½“ä¸­å¯ä»¥å†™ä»€ä¹ˆï¼Œä¸å¯ä»¥å†™ä»€ä¹ˆï¼Œä½ å¿ƒé‡Œæ˜¯å¦æ˜ç™½å‘¢ï¼Ÿ

> æ–¹æ³•ä½“å½“ä¸­ä¸å¯ä»¥ï¼Œå®šä¹‰é™æ€ä»£ç å—ï¼Œä»¥åŠä»£ç å—ï¼Œä¸å¯ä»¥å†å®šä¹‰æ–¹æ³•äº†ï¼Œä¸å¯ä»¥è¢«å®šä¹‰æˆå‘˜å˜é‡ (è¢«æƒé™ä¿®é¥°ç¬¦ä¿®é¥°çš„å˜é‡ã€‚)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013628-1156727444.png)

å¦‚æœåœ¨ jsp å½“ä¸­æ‰€ç¼–å†™çš„ Javaç¨‹åºå­˜åœ¨é”™è¯¯ï¼Œæµè§ˆå™¨ç«¯æ˜¯ä¼šæŠ± 500 é”™è¯¯çš„ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼šä»¥ 5 å¼€å¤´çš„ä¸€èˆ¬éƒ½æ˜¯æœåŠ¡å™¨ç«¯çš„é”™è¯¯ï¼Œè¿™æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯é€šè¿‡æŸ¥çœ‹å…¶ä¸­ç¿»è¯‘çš„ java ç¨‹åºå½“ä¸­ç¿»è¯‘çš„é”™è¯¯äº†ã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013714-53900835.png)  
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013701-1645130340.png)

*   åœ¨serviceæ–¹æ³•å½“ä¸­ç¼–å†™çš„ä»£ç æ˜¯æœ‰é¡ºåºçš„ï¼Œæ–¹æ³•ä½“å½“ä¸­çš„ä»£ç è¦éµå¾ªè‡ªä¸Šè€Œä¸‹çš„é¡ºåºä¾æ¬¡é€è¡Œæ‰§è¡Œã€‚
*   serviceæ–¹æ³•å½“ä¸­ä¸èƒ½å†™é™æ€ä»£ç å—ï¼Œä¸èƒ½å†™æ–¹æ³•ï¼Œä¸èƒ½å®šä¹‰æˆå‘˜å˜é‡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚
*   åœ¨åŒä¸€ä¸ªJSPå½“ä¸­ `<% %>` è¿™ä¸ªç¬¦å·å¯ä»¥å‡ºç°å¤šä¸ªã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013716-1036511491.png)

#### 4.2.2 <%! %>

    <%!
    	// åœ¨è¿™ä¸ªç¬¦å·å½“ä¸­ç¼–å†™çš„javaç¨‹åºä¼šè‡ªåŠ¨ç¿»è¯‘åˆ°serviceæ–¹æ³•ä¹‹å¤–ã€‚
        // service() æ–¹æ³•ä½“ä¹‹å¤–æ˜¯ä»€ä¹ˆï¼Œè‡ªç„¶å°±æ˜¯åœ¨ Servlet ç±»é‡Œé¢äº†ã€‚
    %>
    

*   `<%! %>`åœ¨è¿™ä¸ªç¬¦å·å½“ä¸­ç¼–å†™çš„javaç¨‹åºä¼šè‡ªåŠ¨ç¿»è¯‘åˆ°serviceæ–¹æ³•ä¹‹å¤–ã€‚ç®€å•çš„è¯´å°±æ˜¯ï¼š Servlet ç±»å½“ä¸­ï¼Œservice() æ–¹æ³•å¤–ï¼Œé‚£ä¸å°±æ˜¯ æˆå‘˜å˜é‡ï¼Œæ–¹æ³•ï¼Œä»£ç å—äº†ã€‚

**ä¸¾ä¾‹å¦‚ä¸‹ï¼š**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013712-469856201.png)

**å¯åŠ¨éƒ¨ç½²ï¼Œè®¿é—®è¿è¡Œå¦‚ä¸‹**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013634-936782957.png)

*   è¿™ä¸ªè¯­æ³•å¾ˆå°‘ç”¨ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¹¶ä¸”ä¹Ÿä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºåœ¨serviceæ–¹æ³•å¤–é¢å†™é™æ€å˜é‡å’Œå®ä¾‹å˜é‡ï¼Œéƒ½ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œå› ä¸ºJSPå°±æ˜¯servletï¼Œservletæ˜¯å•ä¾‹çš„ï¼Œå¤šçº¿ç¨‹å¹¶å‘çš„ç¯å¢ƒä¸‹çš„ï¼Œè¿™ä¸ªé™æ€å˜é‡å’Œå®ä¾‹å˜é‡ä¸€æ—¦æœ‰ä¿®æ”¹æ“ä½œï¼Œå¿…ç„¶ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚

### 4.3 é€šè¿‡JSPå½“ä¸­çš„ <%= %>å‘æµè§ˆå™¨å‰ç«¯è¾“å…¥ Javaå˜é‡

æ€ä¹ˆå‘æµè§ˆå™¨ä¸Šè¾“å‡ºä¸€ä¸ªjavaå˜é‡ã€‚

**é”™è¯¯æ–¹å¼ï¼š** ç›´æ¥åœ¨ jsp å½“ä¸­ç¼–å†™å¯¹åº”å˜é‡åï¼Œå› ä¸ºæˆ‘ä»¬çš„åœ¨ JSPæ–‡ä»¶å½“ä¸­ç›´æ¥ç¼–å†™çš„æ–‡å­—çš„å†…å®¹æ˜¯è¢«ç¿»è¯‘åˆ°äº† `service()` æ–¹æ³•ä½“å½“ä¸­å»äº†è¢« `out.write("</html>")` åŒ…è£¹çš„ã€‚æ‰€ä»¥ç¿»è¯‘çš„ä¸æ˜¯å¯¹åº”å˜é‡çš„å€¼ï¼Œè€Œæ˜¯å¯¹åº”å˜é‡çš„åï¼ˆä»¥å­—ç¬¦ä¸²çš„å½¢å¼ç¿»è¯‘åˆ°äº†æµè§ˆå™¨ç«¯äº†ï¼‰ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013656-883077555.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013656-1791003009.png)

**æ­£ç¡®çš„æ–¹å¼ä¸€ï¼šä¸æ¨è**

    <% 
    String name = â€œjackâ€; 
    out.write("name = " + name); 
    %>
    

**æ³¨æ„ï¼š** ä»¥ä¸Šä»£ç ä¸­çš„ `out`æ˜¯JSPçš„ä¹å¤§å†…ç½®å¯¹è±¡ä¹‹ä¸€ã€‚å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚å½“ç„¶ï¼Œå¿…é¡»åªèƒ½åœ¨ `service()`æ–¹æ³•å†…éƒ¨ä½¿ç”¨ï¼ˆå› ä¸º JSPçš„å†…ç½®å¯¹è±¡æ˜¯å®šä¹‰åœ¨ service( ) æ–¹æ³•ä½“å†…çš„ï¼Œæ‰€ä»¥å…¶ä½œç”¨åŸŸä¹Ÿä»…ä»…åªæ˜¯åœ¨ service() æ–¹æ³•ä½“å†…éƒ¨ï¼Œæ‰æœ‰æ•ˆçš„ï¼‰ã€‚

ä¸¾ä¾‹ï¼šæµ‹è¯•

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013771-578175817.png)

*   å¦‚æœå‘æµè§ˆå™¨ä¸Šè¾“å‡ºçš„å†…å®¹ä¸­æ²¡æœ‰â€œjavaä»£ç â€ï¼Œä¾‹å¦‚ï¼šè¾“å‡ºæœ¬èº«å°±æ˜¯ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥åœ¨jspä¸­ç¼–å†™ï¼Œä¸éœ€è¦å†™åˆ°<% %> è¿™é‡Œã€‚å› ä¸ºä»…ä»…åªæ˜¯ä¸€ä¸ªè¾“å‡ºå­—ç¬¦ä¸²çš„è¯ï¼Œå…¶åœ¨JSPç›´æ¥ç¼–å†™ï¼Œè¾“å‡ºçš„å°±æ˜¯å­—ç¬¦ä¸² çš„ã€‚
    
*   å¦‚æœè¾“å‡ºçš„å†…å®¹ä¸­å«æœ‰â€œjavaä»£ç å½“ä¸­çš„å˜é‡çš„å€¼â€ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­æ³•æ ¼å¼ï¼š
    
        <%=å˜é‡å%>  // åœ¨=çš„åé¢ç¼–å†™è¦è¾“å‡ºçš„å†…å®¹ã€‚
        
    
    <%= %> æ³¨æ„ï¼šåœ¨=çš„åé¢ç¼–å†™è¦è¾“å‡ºçš„å†…å®¹ã€‚
    
    ä¸¾ä¾‹ï¼š
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013824-295423021.png)

`<%= %>` è¿™ä¸ªç¬¦å·ä¼šè¢«ç¿»è¯‘åˆ°å“ªé‡Œï¼Ÿæœ€ç»ˆç¿»è¯‘æˆä»€ä¹ˆï¼Ÿ

å¦‚ä¸‹æ˜¯ï¼šå¯¹åº” demo02.jsp æ–‡ä»¶ç¿»è¯‘æˆçš„å¯¹åº”çš„ demo02\_jsp.java æ–‡ä»¶çš„æºç å¦‚ä¸‹ï¼š

    /*
     * Generated by the Jasper component of Apache Tomcat
     * Version: Apache Tomcat/10.0.12
     * Generated at: 2023-04-21 11:55:08 UTC
     * Note: The last modified time of this file was set to
     *       the last modified time of the source file after
     *       generation to assist with modification tracking.
     */
    package org.apache.jsp;
    
    import jakarta.servlet.*;
    import jakarta.servlet.http.*;
    import jakarta.servlet.jsp.*;
    
    public final class demo02_jsp extends org.apache.jasper.runtime.HttpJspBase
        implements org.apache.jasper.runtime.JspSourceDependent,
                     org.apache.jasper.runtime.JspSourceImports {
    
      private static final jakarta.servlet.jsp.JspFactory _jspxFactory =
              jakarta.servlet.jsp.JspFactory.getDefaultFactory();
    
      private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_packages;
    
      private static final java.util.Set<java.lang.String> _jspx_imports_classes;
    
      static {
        _jspx_imports_packages = new java.util.HashSet<>();
        _jspx_imports_packages.add("jakarta.servlet");
        _jspx_imports_packages.add("jakarta.servlet.http");
        _jspx_imports_packages.add("jakarta.servlet.jsp");
        _jspx_imports_classes = null;
      }
    
      private volatile jakarta.el.ExpressionFactory _el_expressionfactory;
      private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;
    
      public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
        return _jspx_dependants;
      }
    
      public java.util.Set<java.lang.String> getPackageImports() {
        return _jspx_imports_packages;
      }
    
      public java.util.Set<java.lang.String> getClassImports() {
        return _jspx_imports_classes;
      }
    
      public jakarta.el.ExpressionFactory _jsp_getExpressionFactory() {
        if (_el_expressionfactory == null) {
          synchronized (this) {
            if (_el_expressionfactory == null) {
              _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
            }
          }
        }
        return _el_expressionfactory;
      }
    
      public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
        if (_jsp_instancemanager == null) {
          synchronized (this) {
            if (_jsp_instancemanager == null) {
              _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
            }
          }
        }
        return _jsp_instancemanager;
      }
    
      public void _jspInit() {
      }
    
      public void _jspDestroy() {
      }
    
      public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
          throws java.io.IOException, jakarta.servlet.ServletException {
    
        if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
          final java.lang.String _jspx_method = request.getMethod();
          if ("OPTIONS".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            return;
          }
          if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
            response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
            response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSP åªå…è®¸ GETã€POST æˆ– HEADã€‚Jasper è¿˜å…è®¸ OPTIONS");
            return;
          }
        }
    
        final jakarta.servlet.jsp.PageContext pageContext;
        jakarta.servlet.http.HttpSession session = null;
        final jakarta.servlet.ServletContext application;
        final jakarta.servlet.ServletConfig config;
        jakarta.servlet.jsp.JspWriter out = null;
        final java.lang.Object page = this;
        jakarta.servlet.jsp.JspWriter _jspx_out = null;
        jakarta.servlet.jsp.PageContext _jspx_page_context = null;
    
    
        try {
          response.setContentType("text/html;charset=UTF-8");
          pageContext = _jspxFactory.getPageContext(this, request, response,
          			null, true, 8192, true);
          _jspx_page_context = pageContext;
          application = pageContext.getServletContext();
          config = pageContext.getServletConfig();
          session = pageContext.getSession();
          out = pageContext.getOut();
          _jspx_out = out;
    
          out.write(' ');
          out.write("\r\n");
          out.write("\r\n");
    
        String name = "å¼ ä¸‰";
    
          out.write("\r\n");
          out.write("\r\n");
          out.print(name);
          out.write("\r\n");
          out.write("<br>\r\n");
          out.print( 1 + 2);
          out.write("\r\n");
          out.write("\r\n");
        } catch (java.lang.Throwable t) {
          if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
            out = _jspx_out;
            if (out != null && out.getBufferSize() != 0)
              try {
                if (response.isCommitted()) {
                  out.flush();
                } else {
                  out.clearBuffer();
                }
              } catch (java.io.IOException e) {}
            if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
            else throw new ServletException(t);
          }
        } finally {
          _jspxFactory.releasePageContext(_jspx_page_context);
        }
      }
    }
    
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013711-1995113595.png)

ç¿»è¯‘æˆäº†è¿™ä¸ªjavaä»£ç ï¼š out.print();

ç¿»è¯‘åˆ°serviceæ–¹æ³•å½“ä¸­äº†ã€‚

**ä»€ä¹ˆæ—¶å€™ä½¿ç”¨<%=%> è¾“å‡ºå‘¢ï¼Ÿè¾“å‡ºçš„å†…å®¹ä¸­å«æœ‰javaçš„å˜é‡ï¼Œè¾“å‡ºçš„å†…å®¹æ˜¯ä¸€ä¸ªåŠ¨æ€çš„å†…å®¹ï¼Œä¸æ˜¯ä¸€ä¸ªæ­»çš„å­—ç¬¦ä¸²ã€‚å¦‚æœè¾“å‡ºçš„æ˜¯ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²ï¼Œç›´æ¥åœ¨JSPæ–‡ä»¶ä¸­ç¼–å†™å³å¯ã€‚**

### 4.4 åœ¨JSP ä¸­çš„ä¸“ä¸šæ³¨é‡Š

*   åœ¨JSPä¸­å¦‚ä½•ç¼–å†™JSPçš„ä¸“ä¸šæ³¨é‡Š

    <%--JSPçš„ä¸“ä¸šæ³¨é‡Šï¼Œä¸ä¼šè¢«ç¿»è¯‘åˆ°javaæºä»£ç å½“ä¸­ã€‚--%> ä¸ä¼šç¿»è¯‘å¯¹åº”çš„ä¿¡æ¯ã€‚è¯¥æ³¨è§£å½“ä¸­çš„å†…å®¹ä¼šè¢«å¿½ç•¥è€Œä¸ç¿»è¯‘çš„ã€‚
    
    <!--è¿™ç§æ³¨é‡Šå±äºHTMLçš„æ³¨é‡Šï¼Œè¿™ä¸ªæ³¨é‡Šä¿¡æ¯ä»ç„¶ä¼šè¢«ç¿»è¯‘åˆ°javaæºä»£ç å½“ä¸­ï¼Œä¸å»ºè®®ã€‚-->  ç¿»è¯‘åˆ°HTMLå½“ä¸­ä½œä¸º html çš„
    æ³¨è§£å­˜åœ¨ã€‚
    

### 4.5 JSPåŸºç¡€è¯­æ³•æ€»ç»“ï¼š

*   JSPä¸­ç›´æ¥ç¼–å†™æ™®é€šå­—ç¬¦ä¸²

    ç¿»è¯‘åˆ°serviceæ–¹æ³•çš„out.write("è¿™é‡Œ")
    

*   <%%>

    ç¿»è¯‘åˆ°serviceæ–¹æ³•ä½“å†…éƒ¨ï¼Œé‡Œé¢æ˜¯ä¸€æ¡ä¸€æ¡çš„javaè¯­å¥ã€‚
    

*   <%! %>

    ç¿»è¯‘åˆ°serviceæ–¹æ³•ä¹‹å¤–ã€‚
    

*   <%= %>

    ç¿»è¯‘åˆ°serviceæ–¹æ³•ä½“å†…éƒ¨ï¼Œç¿»è¯‘ä¸ºï¼šout.print();
    

*   <%@page contentType="text/html;charset=UTF-8"%>

    pageæŒ‡ä»¤ï¼Œé€šè¿‡contentTypeå±æ€§ç”¨æ¥è®¾ç½®å“åº”çš„å†…å®¹ç±»å‹ä»¥åŠå­—ç¬¦é›†ç¼–ç çš„è®¾ç½®ã€‚
    

* * *

**JSPæ–‡ä»¶çš„æ‰©å±•åå¿…é¡»æ˜¯`xxx.jsp`å— ï¼Ÿ**

*   `.jspæ–‡`ä»¶çš„æ‰©å±•åæ˜¯å¯ä»¥é…ç½®çš„ã€‚ä¸æ˜¯å›ºå®šçš„ã€‚
    
*   åœ¨CATALINA\_HOME/conf/web.xmlï¼Œåœ¨è¿™ä¸ªæ–‡ä»¶å½“ä¸­é…ç½®jspæ–‡ä»¶çš„æ‰©å±•åã€‚
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013839-1267417347.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013839-150634496.png)

    <servlet-mapping>
        <servlet-name>jsp</servlet-name>
        <url-pattern>*.jsp</url-pattern>
        <url-pattern>*.jspx</url-pattern>
    </servlet-mapping>
    

xxx.jspæ–‡ä»¶å¯¹äº Tomcat å°çŒ«å’ªæ¥è¯´ï¼Œåªæ˜¯ä¸€ä¸ªæ™®é€šçš„æ–‡æœ¬æ–‡ä»¶ï¼Œwebå®¹å™¨ä¼šå°†xxx.jspæ–‡ä»¶æœ€ç»ˆç”Ÿæˆjavaç¨‹åºï¼Œæœ€ç»ˆè°ƒç”¨çš„æ˜¯javaå¯¹è±¡ç›¸å…³çš„æ–¹æ³•ï¼ŒçœŸæ­£æ‰§è¡Œçš„æ—¶å€™ï¼Œå’Œjspæ–‡ä»¶å°±æ²¡æœ‰å…³ç³»äº†ã€‚

5\. JSPçš„æŒ‡ä»¤
----------

**æŒ‡ä»¤çš„ä½œç”¨ï¼š** æŒ‡å¯¼JSPçš„ç¿»è¯‘å¼•æ“å¦‚ä½•å·¥ä½œï¼ˆæŒ‡å¯¼å½“å‰çš„JSPç¿»è¯‘å¼•æ“å¦‚ä½•ç¿»è¯‘JSPæ–‡ä»¶ã€‚ï¼‰

æŒ‡ä»¤åŒ…æ‹¬å“ªäº›å‘¢ï¼Ÿ

*   **includeæŒ‡ä»¤ï¼š** åŒ…å«æŒ‡ä»¤ï¼Œåœ¨JSPä¸­å®Œæˆé™æ€åŒ…å«ï¼Œå¾ˆå°‘ç”¨äº†ã€‚ï¼ˆè¿™é‡Œä¸è®²ï¼‰
*   **taglibæŒ‡ä»¤ï¼š** å¼•å…¥æ ‡ç­¾åº“çš„æŒ‡ä»¤ã€‚è¿™ä¸ªåˆ°JJSTLæ ‡ç­¾åº“çš„æ—¶å€™å†å­¦ä¹ ã€‚ç°åœ¨å…ˆä¸ç®¡ã€‚
*   **pageæŒ‡ä»¤ï¼š** ç›®å‰é‡ç‚¹å­¦ä¹ ä¸€ä¸ªpageæŒ‡ä»¤ã€‚

æŒ‡ä»¤çš„ä½¿ç”¨è¯­æ³•æ˜¯ä»€ä¹ˆï¼Ÿ

    <%@æŒ‡ä»¤å  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼....%>
    // è¿™é‡Œæˆ‘ä»¬åªå­¦ä¹  page æŒ‡ä»¤æ‰€ä»¥æ˜¯:
    <%@page  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼....%>
    

å¦‚ä¸‹æ˜¯ï¼špageæŒ‡ä»¤å½“ä¸­ä¸€äº› å¸¸ç”¨çš„å±æ€§

     <%@page session="true|false" %>
     trueè¡¨ç¤ºå¯ç”¨JSPçš„å†…ç½®å¯¹è±¡sessionï¼Œè¡¨ç¤ºä¸€å®šå¯åŠ¨sessionå¯¹è±¡ã€‚æ²¡æœ‰sessionå¯¹è±¡ä¼šåˆ›å»ºã€‚
     å¦‚æœæ²¡æœ‰è®¾ç½®ï¼Œé»˜è®¤å€¼å°±æ˜¯session="true"
     session="false" è¡¨ç¤ºä¸å¯åŠ¨å†…ç½®å¯¹è±¡sessionã€‚å½“å‰JSPé¡µé¢ä¸­æ— æ³•ä½¿ç”¨å†…ç½®å¯¹è±¡sessionã€‚
     session è¡¨ç¤ºçš„æ˜¯ä¼šè¯æœºåˆ¶ã€‚
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013704-1710074131.png)

     <%@page contentType="text/json" %>
     contentTypeå±æ€§ç”¨æ¥è®¾ç½®å“åº”çš„å†…å®¹ç±»å‹
     ä½†åŒæ—¶ä¹Ÿå¯ä»¥è®¾ç½®å­—ç¬¦é›†ã€‚
     <%@page contentType="text/json;charset=UTF-8" %>
     <%-- ç¼–ç ä¹Ÿå¯ä»¥å•ç‹¬åˆ†å¼€è®¾ç½®å¦‚ä¸‹--%>
     <%@page pageEncoding="UTF-8" %>
     pageEncoding="UTF-8" è¡¨ç¤ºè®¾ç½®å“åº”æ—¶é‡‡ç”¨çš„å­—ç¬¦é›†ã€‚
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013847-284287455.png)

     <%@page import="java.util.List, java.util.Date, java.util.ArrayList" %> å¯ä»¥å¤šä¸ªåŒ…ä¸€èµ·å¯¼å…¥
     <%@page import="java.util.*" %> ä¹Ÿå¯ä»¥å•ä¸ªå¯¼åŒ…
     importè¯­å¥,å¯¼åŒ…ã€‚
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013850-1815595413.png)

     <%@page errorPage="/error.jsp" %>
     å½“å‰é¡µé¢å‡ºç°å¼‚å¸¸ä¹‹åï¼Œè·³è½¬åˆ°error.jspé¡µé¢ã€‚
     errorPageå±æ€§ç”¨æ¥æŒ‡å®šå‡ºé”™ä¹‹åçš„è·³è½¬ä½ç½®ã€‚
     
      <%@page isErrorPage="true" %>
     è¡¨ç¤ºå¯ç”¨JSPä¹å¤§å†…ç½®å¯¹è±¡ä¹‹ä¸€ï¼šexception
     é»˜è®¤å€¼æ˜¯falseã€‚ 
     
     errorPage,å’Œ isErrorPage ä¸€èˆ¬æ˜¯è¿ç€ä¸€èµ·ä½¿ç”¨çš„ï¼Œå› ä¸º errorPage è¡¨ç¤ºé”™è¯¯è·³è½¬åˆ°æŒ‡å®šçš„é¡µé¢ï¼Œä½†æ˜¯ä¸ä¼šæœ‰é”™è¯¯æç¤ºï¼Œè€Œ isErrorPage å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªæ²¡æœ‰é”™è¯¯æç¤ºçš„é—®é¢˜ã€‚
     
    

**ä¸¾ä¾‹ï¼š**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013849-1145270307.png)

æµ‹è¯•ï¼šè®¿é—® demo03.jsp è¯¥æ–‡ä»¶å½“ä¸­å­˜åœ¨ä¸€ä¸ª java ç¨‹åºçš„ä¸€ä¸ª null æŒ‡é’ˆè®¿é—®çš„å¼‚å¸¸ã€‚å½“å‘ç”Ÿé”™è¯¯æ—¶ï¼Œé”™è¯¯ä¸å¤„ç†ï¼Œä¹Ÿä¸æ‰“å°é”™è¯¯ä¿¡æ¯ï¼Œè€Œæ˜¯ç›´æ¥è·³è½¬åˆ° error.jsp æ–‡ä»¶

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013673-88277459.png)

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013761-50459645.png)

å¯ä»¥ä½¿ç”¨ JSPå½“ä¸­çš„ä¹å¤§å†…ç½®å¯¹è±¡ä¹‹ä¸€çš„ ï¼š \*\*java.lang.Throwable exception \*\* ã€‚

æ³¨æ„ï¼šæƒ³è¦ä½¿ç”¨è¯¥ java.lang.Throwable exception å†…ç½®å¯¹è±¡å¿…é¡»ï¼Œé…ç½®ç›¸å…³çš„æŒ‡ä»¤ï¼š

    <%--
     åœ¨é”™è¯¯é¡µé¢å¯ä»¥å¯ç”¨JSPä¹å¤§å†…ç½®å¯¹è±¡ï¼Œexception
     exeptionå†…ç½®å¯¹è±¡å°±æ˜¯åˆšåˆšå‘ç”Ÿçš„å¼‚å¸¸å¯¹è±¡
    --%>
    <%@page isErrorPage="true" %>
    <%--isErrorPage æœ‰ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯ä¸ºï¼šfalse,true ï¼štrue è¡¨ç¤ºå¼€å¯ isErrorPage ï¼Œfalse è¡¨ç¤ºç¦ç”¨ï¼Œé»˜è®¤ä¸è®¾ç½®ä¹Ÿæ˜¯ç¦ç”¨çŠ¶æ€çš„--%>
    
    

**error.jsp çš„å†…å®¹ä¸Šçš„ç¼–å†™å¦‚ä¸‹**

    
    <%@ page contentType="text/html;charset=UTF-8" language="java" %>
    
    <%--
     åœ¨é”™è¯¯é¡µé¢å¯ä»¥å¯ç”¨JSPä¹å¤§å†…ç½®å¯¹è±¡ï¼Œexception
     exeptionå†…ç½®å¯¹è±¡å°±æ˜¯åˆšåˆšå‘ç”Ÿçš„å¼‚å¸¸å¯¹è±¡
    --%>
    <%@page isErrorPage="true" %>
    <%--isErrorPage æœ‰ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯ä¸ºï¼šfalse,true ï¼štrue è¡¨ç¤ºå¼€å¯ isErrorPage ï¼Œfalse è¡¨ç¤ºç¦ç”¨ï¼Œé»˜è®¤ä¸è®¾ç½®ä¹Ÿæ˜¯ç¦ç”¨çŠ¶æ€çš„--%>
    
    <html>
    <head>
        <title>ç¨‹åºé”™è¯¯</title>
    </head>
    <body>
    <h2>ç½‘ç»œç¹å¿™ï¼Œç¨åå†è¯•</h2>
    
    <%
        // é…ç½®äº† isErrorPage å†…ç½®çš„å¼‚å¸¸å¯¹è±¡åˆ™å¯ä»¥
        // æ‰“å°å¼‚å¸¸å †æ ˆä¿¡æ¯ï¼Œè¾“å‡ºåˆ°åå°æ§åˆ¶å°ä¸Š
        // exception æ˜¯JSP ä¹å¤§å†…ç½®å¯¹è±¡ä¹‹ä¸€ã€‚
        exception.printStackTrace();
    %>
    
    
    </body>
    </html>
    
    

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013699-588223709.png)

6\. JSPçš„ä¹å¤§å†…ç½®å¯¹è±¡
--------------

**æ³¨æ„ï¼šæ‰€è°“çš„JSPçš„ä¹å¤§å†…ç½®å¯¹è±¡æŒ‡çš„æ˜¯ï¼šåœ¨ `service()` æ–¹æ³•ä½“å½“ä¸­çš„å±€éƒ¨çš„å¯¹è±¡å˜é‡ï¼Œservice() æ–¹æ³•ä½“å¤–æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013843-426044926.png)

*   jakarta.servlet.jsp.PageContext pageContext é¡µé¢ä½œç”¨åŸŸ
    
*   jakarta.servlet.http.HttpServletRequest request è¯·æ±‚ä½œç”¨åŸŸ
    
*   jakarta.servlet.http.HttpSession session ä¼šè¯ä½œç”¨åŸŸ
    
*   jakarta.servlet.ServletContext application åº”ç”¨ä½œç”¨åŸŸ
    
    *   pageContext < request < session < application
    *   ä»¥ä¸Šå››ä¸ªä½œç”¨åŸŸéƒ½æœ‰ï¼šsetAttributeã€getAttributeã€removeAttributeæ–¹æ³•ã€‚
    *   ä»¥ä¸Šä½œç”¨åŸŸçš„ä½¿ç”¨åŸåˆ™ï¼šå°½å¯èƒ½ä½¿ç”¨å°çš„åŸŸã€‚
*   java.lang.Throwable exception
    
*   jakarta.servlet.ServletConfig config
    
*   java.lang.Object page ï¼ˆå…¶å®æ˜¯thisï¼Œå½“å‰çš„servletå¯¹è±¡ï¼‰
    
*   jakarta.servlet.jsp.JspWriter out ï¼ˆè´Ÿè´£è¾“å‡ºï¼‰
    
*   jakarta.servlet.http.HttpServletResponse response ï¼ˆè´Ÿè´£å“åº”ï¼‰
    

**æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘åªç”¨JSPè¿™ä¸€ä¸ªæŠ€æœ¯ï¼Œèƒ½ä¸èƒ½å¼€å‘webåº”ç”¨ï¼Ÿ**

> *   å½“ç„¶å¯ä»¥ä½¿ç”¨JSPæ¥å®Œæˆæ‰€æœ‰çš„åŠŸèƒ½ã€‚å› ä¸ºJSPå°±æ˜¯Servletï¼Œåœ¨JSPçš„<%%>é‡Œé¢å†™çš„ä»£ç å°±æ˜¯åœ¨serviceæ–¹æ³•å½“ä¸­çš„ï¼Œæ‰€ä»¥åœ¨<%%>å½“ä¸­å®Œå…¨å¯ä»¥ç¼–å†™JDBCä»£ç ï¼Œè¿æ¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ•°æ®ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ–¹æ³•å½“ä¸­ç¼–å†™ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œå¤„ç†ä¸šåŠ¡ï¼Œéƒ½æ˜¯å¯ä»¥çš„ï¼Œæ‰€ä»¥ä½¿ç”¨å•ç‹¬çš„JSPå¼€å‘webåº”ç”¨å®Œå…¨æ²¡é—®é¢˜ã€‚
> *   è™½ç„¶JSPä¸€ä¸ªæŠ€æœ¯å°±å¯ä»¥å®Œæˆwebåº”ç”¨ï¼Œä½†æ˜¯ä¸å»ºè®®ï¼Œè¿˜æ˜¯å»ºè®®é‡‡ç”¨servlet + jspçš„æ–¹å¼è¿›è¡Œå¼€å‘ã€‚è¿™æ ·éƒ½èƒ½å°†å„è‡ªçš„ä¼˜ç‚¹å‘æŒ¥å‡ºæ¥ã€‚JSPå°±æ˜¯åšæ•°æ®å±•ç¤ºã€‚Servletå°±æ˜¯åšæ•°æ®çš„æ”¶é›†ã€‚ï¼ˆJSPä¸­ç¼–å†™çš„Javaä»£ç è¶Šå°‘è¶Šå¥½ã€‚ï¼‰ä¸€å®šè¦èŒè´£åˆ†æ˜ã€‚

7\. ä½¿ç”¨Servlet + JSPå®Œæˆoaé¡¹ç›®çš„æ”¹é€ 
----------------------------

å…³äº ä¸Šæ¬¡çš„ oa é¡¹ç›®çš„è¯¦ç»†å†…å®¹ï¼Œå¤§å®¶å¯ä»¥å…ˆç§»æ­¥è‡³ï¼šğŸ”œğŸ”œğŸ”œ [Servletæ³¨è§£çš„ä½¿ç”¨ï¼Œç®€åŒ–é…ç½® ä»¥åŠï¼Œä½¿ç”¨æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ä¼˜åŒ–oaé¡¹ç›®\_ChinaRainbowSeaçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_61635597/article/details/130065076?spm=1001.2014.3001.5501) ï¼Œä»¥åŠï¼š [ä½¿ç”¨â€œçº¯â€Servletåšä¸€ä¸ªå•è¡¨çš„CRUDæ“ä½œ\_ChinaRainbowSeaçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_61635597/article/details/130064554)å»ºè®®å¤§å®¶å…ˆï¼Œè·³è¿‡å»ï¼Œçœ‹ä¸€çœ‹ï¼Œæœ‰åŠ©äºåé¢è¯¥æ–‡ç« å†…å®¹ä¸Šçš„é˜…è¯»ç†è§£ã€‚

*   ä½¿ç”¨Servletå¤„ç†ä¸šåŠ¡ï¼Œæ”¶é›†æ•°æ®ã€‚ ä½¿ç”¨JSPå±•ç¤ºæ•°æ®ã€‚
    
*   å°†ä¹‹å‰åŸå‹ä¸­çš„htmlæ–‡ä»¶ï¼Œå…¨éƒ¨ä¿®æ”¹ä¸ºjspï¼Œç„¶ååœ¨jspæ–‡ä»¶å¤´éƒ¨æ·»åŠ pageæŒ‡ä»¤ï¼ˆæŒ‡å®šcontentTypeé˜²æ­¢ä¸­æ–‡ä¹±ç ï¼‰ï¼Œå°†æ‰€æœ‰çš„JSPç›´æ¥æ‹·è´åˆ°webç›®å½•ä¸‹ã€‚
    
*   å®Œæˆæ‰€æœ‰é¡µé¢çš„æ­£å¸¸æµè½¬ã€‚ï¼ˆé¡µé¢ä»ç„¶èƒ½å¤Ÿæ­£å¸¸çš„è·³è½¬ã€‚ä¿®æ”¹è¶…é“¾æ¥çš„è¯·æ±‚è·¯å¾„ã€‚ï¼‰
    
    *   <%=request.getContextPath() %> åœ¨JSPä¸­åŠ¨æ€çš„è·å–åº”ç”¨çš„æ ¹è·¯å¾„ã€‚
*   Servletä¸­è¿æ¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ‰€æœ‰çš„éƒ¨é—¨ï¼Œéå†ç»“æœé›†ã€‚
    
    *   éå†ç»“æœé›†çš„è¿‡ç¨‹ä¸­ï¼Œå–å‡ºéƒ¨é—¨ç¼–å·ã€éƒ¨é—¨åã€ä½ç½®ç­‰ä¿¡æ¯ï¼Œå°è£…æˆjavaå¯¹è±¡ã€‚
    *   å°†javaå¯¹è±¡å­˜æ”¾åˆ°Listé›†åˆä¸­ã€‚
    *   å°†Listé›†åˆå­˜å‚¨åˆ°requeståŸŸå½“ä¸­ã€‚
    *   è½¬å‘forwardåˆ°jspã€‚
*   åœ¨JSPä¸­ï¼š
    
    *   ä»requeståŸŸå½“ä¸­å–å‡ºListé›†åˆã€‚
    *   éå†Listé›†åˆï¼Œå–å‡ºæ¯ä¸ªéƒ¨é—¨å¯¹è±¡ã€‚åŠ¨æ€ç”Ÿæˆtrã€‚

**æ¨¡å—å¯¹åº”çš„åŒ…ç›®å½•å¦‚ä¸‹ï¼š**

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013845-2033308250.png)

* * *

**DeptServlet**

    package com.RainbowSea.servlet;
    
    import com.RainbowSea.DBUtil.DBUtil;
    import com.RainbowSea.bean.Dept;
    import jakarta.servlet.ServletException;
    import jakarta.servlet.annotation.WebServlet;
    import jakarta.servlet.http.HttpServlet;
    import jakarta.servlet.http.HttpServletRequest;
    import jakarta.servlet.http.HttpServletResponse;
    import java.io.IOException;
    import java.sql.Connection;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;
    import java.sql.SQLException;
    import java.util.ArrayList;
    import java.util.List;
    
    // å¯ä»¥ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢ @WebServlet("/dept/*")
    @WebServlet({"/dept/list", "/dept/detail", "/dept/delete", "/dept/save", "/dept/modify"})
    public class DeptServlet extends HttpServlet {
        @Override
        protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException,
                IOException {
    
            String servletPath = request.getServletPath();  // è·å–åˆ°æµè§ˆå™¨å½“ä¸­çš„uri
    
            // åŒé‡çš„åˆ¤æ–­ï¼Œä¸€ä¸ªæ˜¯ session ä¼šè¯åŸŸè¦å­˜åœ¨ï¼Œå…¶æ¬¡æ˜¯ ä¼šè¯åŸŸå½“ä¸­å­˜å‚¨äº†åä¸º "username" çš„ä¿¡æ¯
            if ("/dept/list".equals(servletPath)) {
                doList(request, response);
            } else if ("/dept/detail".equals(servletPath)) {
                doDetail(request, response);
            } else if ("/dept/delete".equals(servletPath)) {
                doElete(request, response);
            } else if ("/dept/save".equals(servletPath)) {
                doSave(request, response);
            } else if ("/dept/modify".equals(servletPath)) {
                doModify(request, response);
            }
    
    
        }
    
    
        /**
         * ä¿®æ”¹éƒ¨é—¨ä¿¡æ¯
         *
         * @param request
         * @param response
         */
        private void doModify(HttpServletRequest request, HttpServletResponse response) throws IOException {
            request.setCharacterEncoding("UTF-8");  // è®¾ç½®è·å–çš„çš„ä¿¡æ¯çš„ç¼–ç é›†
            Connection connection = null;
            PreparedStatement preparedStatement = null;
            // å½±å“æ•°æ®åº“çš„è¡Œæ•°
            int count = 0;
    
    
            String deptno = request.getParameter("deptno");
            String dname = request.getParameter("dname");
            String loc = request.getParameter("loc");
    
    
            try {
                // 1. æ³¨å†Œé©±åŠ¨ï¼Œè¿æ¥æ•°æ®åº“
                connection = DBUtil.getConnection();
    
                // 2. è·å–åˆ°æ“ä½œæ•°æ®åº“çš„å¯¹è±¡ï¼Œé¢„ç¼–è¯‘sqlè¯­å¥ï¼Œsqlæµ‹è¯•
                String sql = "update dept set dname = ?,loc = ? where depton = ?";
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. å¡«å……å ä½ç¬¦ï¼ŒçœŸæ­£æ‰§è¡Œsqlè¯­å¥
                // ä»ä¸‹æ ‡ 1å¼€å§‹
                preparedStatement.setString(1, dname);
                preparedStatement.setString(2, loc);
                preparedStatement.setString(3, deptno);
    
                count = preparedStatement.executeUpdate();
            } catch (SQLException e) {
                throw new RuntimeException(e);
            } finally {
                // 4. é‡Šæ”¾èµ„æºï¼Œæœ€åä½¿ç”¨çš„ä¼˜å…ˆè¢«é‡Šæ”¾
                DBUtil.close(connection, preparedStatement, null);
            }
    
            if (count == 1) {
                // æ›´æ–°æˆåŠŸ
                // è·³è½¬åˆ°éƒ¨é—¨åˆ—è¡¨é¡µé¢ï¼ˆéƒ¨é—¨åˆ—è¡¨è¡¨é¢æ˜¯é€šè¿‡javaç¨‹åºåŠ¨æ€ç”Ÿæˆçš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦å†æ¬¡æ‰§è¡Œå¦ä¸€ä¸ªServletï¼‰
                // è½¬å‘æ˜¯æœåŠ¡å™¨å†…éƒ¨çš„æ“ä½œï¼Œâ€œ/â€ ä¸è¦åŠ é¡¹ç›®å
                // request.getRequestDispatcher("/dept/list/").forward(request,response);
    
                // ä¼˜åŒ–ä½¿ç”¨é‡å®šå‘,è‡ªå‘å‰ç«¯(éœ€è¦æŒ‡æ˜é¡¹ç›®å)
                response.sendRedirect(request.getContextPath() + "/dept/list");
    
            }
        }
    
    
        /**
         * ä¿å­˜éƒ¨é—¨ä¿¡æ¯
         *
         * @param request
         * @param response
         */
        private void doSave(HttpServletRequest request, HttpServletResponse response) throws IOException {
    
            request.setCharacterEncoding("UTF-8");
    
            // è·å–åˆ°å‰ç«¯çš„æ•°æ®ï¼Œå»ºè®® name ä½¿ç”¨å¤åˆ¶
            String deptno = request.getParameter("deptno");
            String dname = request.getParameter("dname");
            String loc = request.getParameter("loc");
    
            // è¿æ¥æ•°æ®åº“ï¼Œæ·»åŠ æ•°æ®
            Connection connection = null;
            PreparedStatement preparedStatement = null;
            // å½±å“æ•°æ®åº“çš„è¡Œæ•°
            int count = 0;
    
            try {
                // 1. æ³¨å†Œé©±åŠ¨ï¼Œè¿æ¥æ•°æ®åº“
                connection = DBUtil.getConnection();
    
                // 2. è·å–æ“ä½œæ•°æ®åº“å¯¹è±¡ï¼Œé¢„ç¼–è¯‘sqlè¯­å¥ï¼ŒSqlæµ‹è¯•
                String sql = "insert into dept(depton,dname,loc) values(?,?,?)";
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. å¡«å……å ä½ç¬¦, çœŸæ­£æ‰§è¡Œsqlè¯­å¥ï¼Œ
                // æ³¨æ„ï¼š å ä½ç¬¦çš„å¡«å……æ˜¯ä» 1 å¼€å§‹çš„ï¼ŒåŸºæœ¬ä¸Šæ•°æ®åº“ç›¸å…³çš„èµ·å§‹ä¸‹æ ‡ç´¢å¼•éƒ½æ˜¯ä» 1ä¸‹æ ‡å¼€å§‹çš„
                preparedStatement.setString(1, deptno);
                preparedStatement.setString(2, dname);
                preparedStatement.setString(3, loc);
    
                // è¿”å›å½±å“æ•°æ®åº“çš„è¡Œæ•°
                count = preparedStatement.executeUpdate();
    
                // 5.é‡Šæ”¾èµ„æº
            } catch (SQLException e) {
                throw new RuntimeException(e);
            } finally {
                DBUtil.close(connection, preparedStatement, null);
            }
    
            // ä¿å­˜æˆåŠŸï¼Œè¿”å›éƒ¨é—¨åˆ—è¡¨é¡µé¢
            if (count == 1) {
                // è¿™é‡Œåº”è¯¥ä½¿ç”¨ï¼Œé‡å®šå‘
                // è¿™é‡Œç”¨çš„è½¬å‘ï¼Œæ˜¯æœåŠ¡å™¨å†…éƒ¨çš„ï¼Œä¸è¦åŠ é¡¹ç›®å
                //request.getRequestDispatcher("/dept/list/").forward(request, response);
    
                // é‡å®šå‘
                response.sendRedirect(request.getContextPath() + "/dept/list");
            }
        }
    
    
        /**
         * é€šè¿‡éƒ¨é—¨åˆ é™¤éƒ¨é—¨
         *
         * @param request
         * @param response
         */
        private void doElete(HttpServletRequest request, HttpServletResponse response) throws IOException {
    
            request.setCharacterEncoding("UTF-8");  // è®¾ç½®è·å–çš„çš„ä¿¡æ¯çš„ç¼–ç é›†
            // è·å–åˆ°å‘é€æ•°æ®
            String deptno = request.getParameter("deptno");
    
             /*
            æ ¹æ®éƒ¨é—¨ç¼–å·åˆ é™¤ä¿¡æ¯ï¼Œ
            åˆ é™¤æˆåŠŸï¼Œè·³è½¬å›åŸæ¥çš„éƒ¨é—¨åˆ—è¡¨é¡µé¢
            åˆ é™¤å¤±è´¥ï¼Œè·³è½¬åˆ é™¤å¤±è´¥çš„é¡µé¢
             */
    
            Connection connection = null;
            PreparedStatement preparedStatement = null;
    
            // è®°å½•åˆ é™¤æ•°æ®åº“çš„è¡Œæ•°
            int count = 0;
    
    
            // è¿æ¥æ•°æ®åº“è¿›è¡Œåˆ é™¤æ“ä½œ
    
            try {
                // 1.æ³¨å†Œé©±åŠ¨ï¼Œè¿æ¥æ•°æ®åº“
                connection = DBUtil.getConnection();
    
                // å¼€å¯äº‹åŠ¡ï¼ˆå–æ¶ˆè‡ªåŠ¨æäº¤æœºåˆ¶ï¼‰,å®ç°å¯å›æ»š
                connection.setAutoCommit(false);
    
                // 2. é¢„ç¼–è¯‘sqlè¯­å¥,sqlæµ‹è¯•
                String sql = "delete from dept where depton = ?"; // ? å ä½ç¬¦
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. å¡«å……å ä½ç¬¦ï¼ŒçœŸæ­£çš„æ‰§è¡Œsqlè¯­å¥
                preparedStatement.setString(1, deptno);
                // è¿”å›å½±å“æ•°æ®åº“çš„è¡Œæ•°
                count = preparedStatement.executeUpdate();
                connection.commit();  // æ‰‹åŠ¨æäº¤æ•°æ®
            } catch (SQLException e) {
                // é‡åˆ°å¼‚å¸¸å›æ»š
                if (connection != null) {
                    try {
                        // äº‹åŠ¡çš„å›æ»š
                        connection.rollback();
                    } catch (SQLException ex) {
                        throw new RuntimeException(ex);
                    }
                }
                throw new RuntimeException(e);
            } finally {
                // 4. é‡Šæ”¾èµ„æº
                // å› ä¸ºè¿™é‡Œæ˜¯åˆ é™¤æ•°æ®ï¼Œæ²¡æœ‰æŸ¥è¯¢æ“ä½œï¼Œæ‰€ä»¥ æ²¡æœ‰ ResultSet å¯ä»¥ä¼ null
                DBUtil.close(connection, preparedStatement, null);
            }
    
            if (count == 1) {
                // åˆ é™¤æˆåŠŸ
                // ä»ç„¶è·³è½¬åˆ°éƒ¨é—¨åˆ—è¡¨é¡µé¢
                // éƒ¨é—¨åˆ—è¡¨é¡µé¢çš„æ˜¾ç¤ºéœ€è¦æ‰§è¡Œå¦å¤–ä¸€ä¸ªServletï¼Œæ€ä¹ˆåŠï¼Œå¯ä»¥ä½¿ç”¨è·³è½¬ï¼Œä¸è¿‡è¿™é‡Œæœ€åæ˜¯ä½¿ç”¨é‡å®šå‘
                // æ³¨æ„ï¼šè½¬å‘æ˜¯åœ¨æœåŠ¡å™¨é—´çš„ï¼Œæ‰€ä»¥ä¸è¦åŠ â€œé¡¹ç›®åâ€ è€Œæ˜¯ / + web.xml æ˜ å°„çš„è·¯å¾„å³å¯
                //request.getRequestDispatcher("/dept/list/").forward(request,response);
    
                // ä¼˜åŒ–ï¼šä½¿ç”¨é‡å®šå‘æœºåˆ¶ æ³¨æ„: é‡å®šå‘æ˜¯è‡ªå‘åˆ°å‰ç«¯çš„åœ°å€æ ä¸Šçš„ï¼Œå‰ç«¯æ‰€ä»¥éœ€è¦æŒ‡æ˜é¡¹ç›®å
                // æ³¨æ„: request.getContextPath() è¿”å›çš„æ ¹è·¯å¾„æ˜¯ï¼ŒåŒ…å«äº† "/" çš„
                response.sendRedirect(request.getContextPath() + "/dept/list");
            }
        }
    
    
        /**
         * é€šè¿‡éƒ¨é—¨ç¼–å·ï¼ŒæŸ¥è¯¢éƒ¨é—¨çš„è¯¦æƒ…
         *
         * @param request
         * @param response
         */
        private void doDetail(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    
            request.setCharacterEncoding("UTF-8");  // è®¾ç½®è·å–çš„çš„ä¿¡æ¯çš„ç¼–ç é›†
    
            Connection connection = null;
            PreparedStatement preparedStatement = null;
            ResultSet resultSet = null;
            // è·å–åˆ°éƒ¨é—¨ç¼–å·
            String dno = request.getParameter("dno");
            Dept dept = new Dept();
    
            // è·å–åˆ°éƒ¨é—¨ç¼–å·ï¼Œè·å–éƒ¨é—¨ä¿¡æ¯ï¼Œå°†éƒ¨é—¨ä¿¡æ¯æ”¶é›†å¥½ï¼Œç„¶åè·³è½¬åˆ°JSPåšé¡µé¢å±•ç¤º
    
    
            try {
                // 2. è¿æ¥æ•°æ®åº“ï¼Œæ ¹æ®éƒ¨é—¨ç¼–å·æŸ¥è¯¢æ•°æ®åº“
                // 1.æ³¨å†Œé©±åŠ¨ï¼Œè¿æ¥æ•°æ®åº“
                connection = DBUtil.getConnection();
    
                // 2. é¢„ç¼–è¯‘SQLè¯­å¥,sqlè¦æµ‹è¯•
                String sql = "select dname,loc from dept where depton = ?";  // ? å ä½ç¬¦
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. å¡«å……å ä½ç¬¦,çœŸæ­£æ‰§è¡Œsqlè¯­å¥
                preparedStatement.setString(1, dno);
                resultSet = preparedStatement.executeQuery();
    
                // 4. å¤„ç†æŸ¥è¯¢ç»“æœé›†
                while (resultSet.next()) {
                    String dname = resultSet.getString("dname");
                    String loc = resultSet.getString("loc");
    
                    // å°è£…å¯¹è±¡(å»ºè®®ä½¿ç”¨å’–å•¡è±†ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªå¯¹è±¡)
                    dept.setDeptno(dno);
                    dept.setDname(dname);
                    dept.setLoc(loc);
                }
            } catch (SQLException e) {
                throw new RuntimeException(e);
            } finally {
                // 5. é‡Šæ”¾èµ„æº
                DBUtil.close(connection, preparedStatement, resultSet);
            }
    
            // è¿™ä¸ªå’–å•¡è±†åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥ä¸éœ€è¦è¢‹å­ï¼Œåªéœ€è¦å°†è¿™ä¸ªå’–å•¡è±†æ”¾åˆ°requestè¯·æ±‚åŸŸå½“ä¸­ï¼Œ
            // ç”¨äºå¯¹åº”çš„ jspæ˜¾ç¤º
            request.setAttribute("dept", dept);
            //String sign = request.getParameter("f");
    
            /*if("m".equals(sign)) {
    
                // è½¬å‘ï¼šå¤šä¸ªè¯·æ±‚ä¸ºä¸€ä¸ªè¯·æ±‚(åœ°å€æ ä¸ä¼šå‘ç”Ÿæ”¹å˜)
                // æ³¨æ„: è¯¥è·¯å¾„é»˜è®¤æ˜¯ä» web å¼€å§‹æ‰¾çš„ / è¡¨ç¤º web
                // è½¬å‘åˆ°ä¿®æ”¹é¡µé¢
                request.getRequestDispatcher("/edit.jsp").forward(request,response);
            } else if("d".equals(sign)) {
                // è·³è½¬åˆ°è¯¦æƒ…é¡µé¢
                request.getRequestDispatcher("/detail.jsp").forward(request,response);
            }*/
    
            // æˆ–è€…ä¼˜åŒ–
            // æ³¨æ„ æ— è®ºæ˜¯è½¬å‘è¿˜æ˜¯é‡å®šå‘éƒ½æ˜¯ä» â€œ/â€ å¼€å§‹çš„
            // request.getParameter()æ‹¿åˆ°çš„æ˜¯ f=editï¼Œè¿˜æ˜¯f=detail å°±æ˜¯è·³è½¬åˆ°çš„å“ªä¸ªé¡µé¢
            //<a href="<%=request.getContextPath()%>/dept/detail?f=edit&dno=<%=dept.getDeptno()%>">ä¿®æ”¹</a>
            //<a href="<%=request.getContextPath()%>/dept/detail?f=detail&dno=<%=dept.getDeptno()%>">è¯¦æƒ…</a>
            String forward = "/" + request.getParameter("f") + ".jsp";
            request.getRequestDispatcher(forward).forward(request, response);
        }
    
    
        /**
         * è¿æ¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ‰€æœ‰çš„éƒ¨é—¨ä¿¡æ¯ï¼Œå°†éƒ¨é—¨ä¿¡æ¯æ”¶é›†å¥½ï¼Œç„¶åè·³è½¬åˆ°JSPé¡µé¢å±•ç¤º
         *
         * @param request
         * @param response
         */
        private void doList(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
            request.setCharacterEncoding("UTF-8");  // è®¾ç½®è·å–çš„çš„ä¿¡æ¯çš„ç¼–ç é›†
            Connection connection = null;
            PreparedStatement preparedStatement = null;
            ResultSet resultSet = null;
    
            // åˆ›å»ºä¸€ä¸ªé›†åˆList å­˜å‚¨æŸ¥è¯¢åˆ°çš„ä¿¡æ¯
            List<Dept> depts = new ArrayList<Dept>();
    
    
            try {
                // è¿æ¥æ•°æ®åº“ï¼ŒæŸ¥è¯¢æ‰€æœ‰éƒ¨é—¨:
                // 1. æ³¨å†Œé©±åŠ¨,è·å–è¿æ¥
                connection = DBUtil.getConnection();
                // 2. è·å–æ“ä½œæ•°æ®åº“å¯¹è±¡ï¼Œé¢„ç¼–è¯‘sqlè¯­å¥
                String sql = "select depton as det,dname,loc from dept"; // åœ¨mysqlä¸­æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ­£ç¡®
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. æ‰§è¡Œsqlè¯­å¥
                resultSet = preparedStatement.executeQuery();
    
                // 4. å¤„ç†æŸ¥è¯¢ç»“æœé›†
                while (resultSet.next()) {
                    String det = resultSet.getString("det");  // æœ‰åˆ«åè¦ä½¿ç”¨åˆ«å
                    String dname = resultSet.getString("dname");
                    String loc = resultSet.getString("loc");
    
                    Dept dept = new Dept(det, dname, loc);
    
                    // å°†éƒ¨é—¨å¯¹è±¡æ”¾åˆ°Listé›†åˆå½“ä¸­
                    depts.add(dept);
    
                }
            } catch (SQLException e) {
                throw new RuntimeException(e);
            } finally {
    
                // 5. å…³é—­èµ„æº
                DBUtil.close(connection, preparedStatement, resultSet);
            }
    
    
            // æŸ¥è¯¢åˆ°æ•°æ®ï¼Œå°†æ•°æ®æäº¤ç»™ list.jsp æ˜¾ç¤ºæ•°æ®
            // å°†é›†åˆå­˜å‚¨çš„æ•°æ®æ”¾åˆ°è¯·æ±‚åŸŸå½“ä¸­ï¼Œç”¨äºå…¶ä»–Servlet ä½¿ç”¨ jsp ä¹Ÿæ˜¯Servelt
            request.setAttribute("depList", depts);
    
            // è½¬å‘(æ³¨æ„ä¸è¦é‡å®šå‘)ï¼Œé‡å®šå‘æ— æ³•å…±ç”¨ request è¯·æ±‚åŸŸå½“ä¸­çš„æ•°æ®
            // è½¬å‘è·¯å¾„ï¼Œ/ é»˜è®¤æ˜¯ä» web ç›®å½•å¼€å§‹æ‰¾çš„
            request.getRequestDispatcher("/list.jsp").forward(request, response);
        }
    }
    
    

**UserServlet**

    package com.RainbowSea.servlet;
    
    import com.RainbowSea.DBUtil.DBUtil;
    import jakarta.servlet.ServletException;
    import jakarta.servlet.annotation.WebServlet;
    import jakarta.servlet.http.HttpServlet;
    import jakarta.servlet.http.HttpServletRequest;
    import jakarta.servlet.http.HttpServletResponse;
    
    import java.io.IOException;
    import java.sql.Connection;
    import java.sql.PreparedStatement;
    import java.sql.ResultSet;
    import java.sql.SQLException;
    
    
    @WebServlet({"/user/login", "/user/exit"})
    public class UserServlet extends HttpServlet {
        @Override
        protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException,
                IOException {
    
            // è·å–åˆ°æµè§ˆå™¨åœ°å€æ ä¸Šçš„URLè·¯å¾„
            String servletPath = request.getServletPath();
    
            if ("/user/login".equals(servletPath)) {
                doLogin(request, response);
            } else if ("/user/exit".equals(servletPath)) {
                doExit(request, response);
            }
    
    
        }
    
        private void doExit(HttpServletRequest request, HttpServletResponse response) throws IOException {
        }
    
        protected void doLogin(HttpServletRequest request, HttpServletResponse response) throws ServletException,
                IOException {
    
            // ä¸€ä¸ªç”¨æˆ·ç™»å½•éªŒè¯çš„æ–¹å¼ï¼šéªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
            // è·å–ç”¨æˆ·åå’Œå¯†ç 
            // å‰ç«¯æäº¤æ˜¯æ•°æ®æ˜¯ï¼šusername=111&password=fads
            // æ³¨æ„ï¼špost æäº¤çš„æ•°æ®æ˜¯åœ¨è¯·æ±‚ä½“å½“ä¸­ï¼Œè€Œgetæäº¤çš„æ•°æ®æ˜¯åœ¨è¯·æ±‚è¡Œå½“ä¸­
    
            boolean success = false;  // æ ‡è¯†ç™»å½•æˆåŠŸ
    
            String username = request.getParameter("username");
            String password = request.getParameter("password");
    
            String exempt = request.getParameter("exempt");
    
            // è¿æ¥æ•°æ®åº“éªŒè¯ç”¨æˆ·åå’Œå¯†ç 
            Connection connection = null;
            PreparedStatement preparedStatement = null;
            ResultSet resultSet = null;
    
            try {
                // 1. è·å–è¿æ¥ï¼Œæ³¨å†Œé©±åŠ¨
                connection = DBUtil.getConnection();
    
                // 2. è·å–æ“ä½œæ•°æ®å¯¹è±¡ï¼Œé¢„ç¼–è¯‘sqlè¯­å¥, ? å ä½ç¬¦ä¸è¦åŠ ï¼Œâ€œâ€,'' å•åŒå¼•å·ï¼Œæˆäº†å­—ç¬¦ä¸²äº†ï¼Œæ— æ³•è¯†åˆ«æˆå ä½ç¬¦äº†ã€‚
                String sql = "select username,password from t_user where username = ? and password = ?";
                preparedStatement = connection.prepareStatement(sql);
    
                // 3. å¡«å……å ä½ç¬¦ï¼ŒçœŸæ­£æ‰§è¡Œsqlè¯­å¥
                preparedStatement.setString(1, username);
                preparedStatement.setString(2, password);
    
                resultSet = preparedStatement.executeQuery();
    
                // 4. å¤„ç†æŸ¥è¯¢ç»“æœé›†
                // åªæœ‰ä¸€æ¡ç»“æœé›†
                if (resultSet.next()) {
                    // ç™»å½•æˆåŠŸ
                    success = true;
                }
            } catch (SQLException e) {
                throw new RuntimeException(e);
            } finally {
                // 5. å…³é—­èµ„æºï¼Œæœ€åä½¿ç”¨çš„æœ€å…ˆå…³é—­ï¼Œ
                DBUtil.close(connection, preparedStatement, resultSet);
            }
    
            // ç™»å½•æˆåŠŸä¸å¦
            if (success) {
                response.sendRedirect(request.getContextPath() + "/dept/list");
            } else {
                // å¤±è´¥ï¼Œè·³è½¬åˆ°å¤±è´¥é¡µé¢
                response.sendRedirect(request.getContextPath() + "/error.jsp");
            }
    
    
        }
    }
    
    

æ‰€ä»¥çš„ html é¡µé¢æ›¿æ¢ä¸ºäº†å¯¹åº”çš„ `jsp` æ–‡ä»¶

**add.html --> add.jsp**

    <%@page contentType="text/html; charset=utf-8" %>
    
    
    <!DOCTYPE html>
    <html lang="en">
    
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>æ–°å¢éƒ¨é—¨</title>
    </head>
    
    <body>
    <h1>æ–°å¢éƒ¨é—¨</h1>
    <form action="<%=request.getContextPath()%>/dept/save" method="post">
      éƒ¨é—¨ç¼–å·: <input type="text" name="deptno" /><br>
      éƒ¨é—¨åç§°: <input type="text" name="dname" /><br>
      éƒ¨é—¨ä½ç½®: <input type="text" name="loc" /><br>
      <input type="submit" value="ä¿å­˜" />
    </form>
    </body>
    
    </html>
    

**detail.html --> detail.jsp**

    <%@ page import="com.RainbowSea.bean.Dept" %>
    <%@page contentType="text/html; charset=UTF-8" %>
    
    
    <%
      // è·å–åˆ°è¯·æ±‚åŸŸå½“ä¸­çš„æ•°æ®ï¼Œ
      Dept dept = (Dept) request.getAttribute("dept");
    %>
    
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>éƒ¨é—¨è¯¦æƒ…</title>
    </head>
    <body>
    <h1>éƒ¨é—¨è¯¦æƒ…</h1>
    éƒ¨é—¨ç¼–å·: <%=dept.getDeptno()%> <br>
    éƒ¨é—¨åç§°: <%=dept.getDname()%><br>
    éƒ¨é—¨ä½ç½®: <%=dept.getLoc()%><br>
    
    <input type="button" value="åé€€" onclick="window.history.back()"  />
    </body>
    </html>
    

**edit.html --> edit.jsp**

    <%@ page import="com.RainbowSea.bean.Dept" %>
    <%@page contentType="text/html; charset=UTF-8" %>
    
    <!DOCTYPE html>
    <html lang="en">
    
    
    <%
      // è·å–åˆ°å­˜å‚¨åˆ°è¯·æ±‚åŸŸå½“çš„ éƒ¨é—¨ä¿¡æ¯
      Dept dept = (Dept) request.getAttribute("dept");
    %>
    <head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>ä¿®æ”¹éƒ¨é—¨</title>
    </head>
    
    <body>
    <h1>ä¿®æ”¹éƒ¨é—¨</h1>
    <form action="<%=request.getContextPath()%>/dept/modify" method="post">
      <!-- readonly è¡¨ç¤ºåªè¯»ï¼Œä¸å¯ä¿®æ”¹çš„ä½œç”¨ -->
      éƒ¨é—¨ç¼–å·: <input type="text" name="deptno" value="<%=dept.getDeptno()%>" readonly /><br>
      éƒ¨é—¨åç§°: <input type="text" name="dname" value="<%=dept.getDname()%>" /><br>
      éƒ¨é—¨ä½ç½®: <input type="text" name="loc" value="<%=dept.getLoc()%>" /><br>
      <input type="submit" value="ä¿®æ”¹" />
    </form>
    
    </body>
    
    </html>
    

**error.html --> error.jsp**

    <%@ page contentType="text/html;charset=UTF-8" language="java" %>
    <%@ page session="false" %>
    <html>
    <head>
        <title>ç™»å½•å¤±è´¥</title>
    </head>
    <body>
    
    ç™»å½•å¤±è´¥ï¼Œå¯†ç æˆ–è´¦å·é”™è¯¯: <a href="<%=request.getContextPath()%>/index.jsp">è¯·é‡æ–°ç™»å½•</a>
    
    </body>
    </html>
    
    

**index.html --> index.jsp**

    <%@page contentType="text/html; charset=UTF-8" %>
    <%--è¡¨ç¤ºè®¿é—® jsp çš„æ—¶å€™ä¸ç”Ÿæˆ session å¯¹è±¡--%>
    <%@page session="false" %>  <%--è¯¥æŒ‡ä»¤ä¸æ˜¯è­¦ç”¨jspå†…ç½®å¯¹è±¡å½“ä¸­çš„ session--%>
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>æ¬¢è¿ä½¿ç”¨OAç³»ç»Ÿ</title>
    </head>
    <body>
    <%--<!--æ³¨æ„ï¼šå¯¹åº”å‰ç«¯çš„èµ„æºè·å–åŸºæœ¬ä¸Šéƒ½æ˜¯è¦åŠ é¡¹ç›®åçš„ï¼Œå¹¶ä¸”è¦"/"å¼€å§‹-->--%>
    <%--è¿™ç§æ–¹å¼ä¸å¥½ï¼Œå°† é¡¹ç›®åå†™æ­»äº†ï¼Œ--%>
    <%--<a href="/servlet09/dept/list/">æŸ¥çœ‹éƒ¨é—¨åˆ—è¡¨</a>--%>
    <%--ä½¿ç”¨request.getContextPath() åŠ¨æ€è·å–é¡¹ç›®åçš„æ ¹è·¯å¾„å¸¦ / çš„ï¼Œ
    æ³¨æ„å“ªé‡Œå¯ä»¥åŠ  ç©ºæ ¼ï¼Œå“ªé‡Œä¸èƒ½åŠ ç©ºæ ¼--%>
    <%--<a href="<%=request.getContextPath()          %>/dept/list">æŸ¥çœ‹éƒ¨é—¨åˆ—è¡¨</a>--%>
    
    <%--<%=request.getContextPath()%> &lt;%&ndash;out.print(request.getContextPath()) è·å–åˆ°è¯¥é¡¹ç›®çš„æ ¹è·¯å¾„å¸¦æœ‰/çš„&ndash;%&gt;--%>
    
    
        <h1>Login in</h1>
        <hr>
        <form action="<%=request.getContextPath()%>/user/login" method="post">
            username: <input type="text" name="username" /><br>
            password: <input type="password" name="password" /> <br>
            å…åå¤©ç™»å½• <input type="checkbox" name="exempt" value="true" /> <br>
            <input type="submit" value="login" />
        </form>
    </body>
    </html>
    

**list.html ---> list.jsp**

    <%@ page import="com.RainbowSea.bean.Dept" %>
    <%@ page import="java.util.List" %>  <%--è¿™æ˜¯å¯¼åŒ…åœ¨jSP å½“ä¸­ï¼Œå¹¶ç¿»è¯‘ä¸ºimportå¯¼å…¥å¯¹äºçš„æŠ¥--%>
    <%@page contentType="text/html; charset=utf-8" %>
    
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>éƒ¨é—¨åˆ—è¡¨é¡µé¢</title>
    </head>
    <script type="text/javascript">
        function del(dno) {
            // å¼¹å‡ºç¡®è®¤æ¡†,ç”¨æˆ·ç‚¹å‡»ç¡®å®šï¼Œè¿”å›true,ç‚¹å‡»å–æ¶ˆè¿”å›false
            var ok = window.confirm("äº²,åˆ äº†ä¸å¯æ¢å¤å“¦!");
            if (ok) {
                // å‘é€è¯·æ±‚è¿›è¡Œåˆ é™¤æ•°æ®çš„æ“ä½œ
                // åœ¨jsä»£ç å½“ä¸­å¦‚ä½•å‘é€è¯·æ±‚ç»™æœåŠ¡å™¨
                //
                // document.location.href="è¯·æ±‚è·¯å¾„"
                // document.location = "è¯·æ±‚è·¯å¾„"
                // window.location.href = "è¯·æ±‚è·¯å¾„"
                // window.location = "è¯·æ±‚è·¯å¾„"
    
                // æ³¨æ„æ˜¯æ ¹æ®æ‰€ä¼ çš„éƒ¨é—¨ç¼–å·åˆ é™¤æ•°æ®çš„
                document.location.href = "<%=request.getContextPath()%>/dept/delete?deptno=" + dno;
    
            }
        }
    </script>
    
    <body>
    <h1 align="center">éƒ¨é—¨åˆ—è¡¨</h1>
    <%--æ˜¾ç¤ºç™»å½•çš„ç”¨æˆ·åä¿¡æ¯--%>
    <h3><%=session.getAttribute("username")%></h3>  <%--æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯ jsp å†…ç½®çš„ session å¯¹è±¡æ‰€ä»¥ä¸å¯ä»¥ï¼Œä¸è¦æŠŠ session ç¦ç”¨äº†ã€‚--%>
    
    <a href="<%=request.getContextPath()%>/user/exit">å®‰å…¨é€€å‡ºç³»ç»Ÿ(æ‰‹åŠ¨æ¸…é™¤ session ä¼šè¯ä¿¡æ¯)</a>
    
    <table border="1px" align="center" width="50%">
        <tr>
            <th>åºå·</th>
            <th>éƒ¨é—¨ç¼–å·</th>
            <th>éƒ¨é—¨åç§°</th>
        </tr>
    
        <%
            // è·å–åˆ° request åŸŸå½“ä¸­çš„æ•°æ®ï¼Œå¹¶å–å‡ºæ¥ï¼Œæˆ‘ä»¬çŸ¥é“æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ï¼Œç›´æ¥å¼ºåˆ¶è½¬æ¢
            List<Dept> depList = (List<Dept>) request.getAttribute("depList");
    
            int i = 0;
            // å¾ªç¯éå†Listï¼Œå–å‡ºæ•°æ®
            for (Dept dept : depList) {
                // åœ¨åå°è¾“å‡ºæµ‹è¯•
                //System.out.println(dept.getDname());
                // åœ¨æµè§ˆå™¨æ˜¾ç¤º æµ‹è¯•
                //out.write(dept.getDname() + "<br>");
    
    
        %>
        <%--    æµè§ˆå™¨æ˜¾ç¤ºæµ‹è¯•--%>
        <%--    <%=dept.getDname()%>--%>
    
    
        <tr>
            <td><%=++i%>
            </td>
            <td><%=dept.getDeptno()%>
            </td>
            <td><%=dept.getLoc()%>
            </td>
            <td>
                <!-- javascript:void(0)ä¿æŒ<a>è¶…é“¾æ¥çš„æ ¼å¼ï¼ŒåŒæ—¶ä¸ä¼šå‘ç”Ÿè·³è½¬
                    æˆ‘åªæ˜¯å¸Œæœ›ç”¨æˆ·ç‚¹å‡»è¯¥è¶…é“¾æ¥çš„æ—¶å€™æ‰§è¡Œä¸€æ®µjsä»£ç ï¼Œä¸è¿›è¡Œé¡µé¢çš„è·³è½¬ -->
                <a href="javascript:void(0)" onclick="del(<%=dept.getDeptno()%>)">åˆ é™¤</a>
    <%--            <a href="<%=request.getContextPath()%>/dept/detail?f=m&dno=<%=dept.getDeptno()%>">ä¿®æ”¹</a>--%>
    <%--            <a href="<%=request.getContextPath()%>/dept/detail?f=d&dno=<%=dept.getDeptno()%>">è¯¦æƒ…</a>--%>
                <%-- è¿™é‡Œçš„ä¿®æ”¹ï¼Œå’Œè¯¦æƒ…éƒ½æ˜¯éœ€è¦ éƒ¨é—¨ç¼–å·ï¼Œæˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€ä¸ªç»Ÿä¸€å¤„ç†ï¼Œé€šè¿‡æ‰€ä¼ çš„ä¸åŒçš„ f= å€¼ä½œä¸º
     æ ‡è®°ï¼Œç”¨äºæœåŠ¡å™¨ç«¯çš„ Servlet åˆ¤æ–­è½¬å‘å¤„ç†åˆ°çš„--%>
                <%--            æˆ–è€…æ˜¯--%>
                <a href="<%=request.getContextPath()%>/dept/detail?f=edit&dno=<%=dept.getDeptno()%>">ä¿®æ”¹</a>
                <a href="<%=request.getContextPath()%>/dept/detail?f=detail&dno=<%=dept.getDeptno()%>">è¯¦æƒ…</a>
            </td>
        </tr>
    
        <%
            }
        %>
    </table>
    <hr>
    <a href="<%=request.getContextPath()%>/add.jsp">æ–°å¢éƒ¨é—¨</a>
    </body>
    
    </html>
    

* * *

å½“å‰çš„oaåº”ç”¨å­˜åœ¨çš„é—®é¢˜ï¼š

*   ä»»ä½•ä¸€ä¸ªç”¨æˆ·éƒ½å¯ä»¥è®¿é—®è¿™ä¸ªç³»ç»Ÿï¼Œéƒ½å¯ä»¥å¯¹è¿™ä¸ªç³»ç»Ÿå½“ä¸­çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹è¿™äº›å±é™©çš„æ“ä½œã€‚æˆ‘åªæƒ³è®©åˆæ³•çš„ç”¨æˆ·å»ä½¿ç”¨è¿™ä¸ªç³»ç»Ÿï¼Œä¸åˆæ³•çš„ç”¨æˆ·ä¸èƒ½è®¿é—®è¿™ä¸ªç³»ç»Ÿï¼Œæ€ä¹ˆåŠï¼Ÿ
    
    *   åŠ ä¸€ä¸ªç™»å½•åŠŸèƒ½ã€‚ç™»å½•æˆåŠŸçš„å¯ä»¥è®¿é—®è¯¥ç³»ç»Ÿï¼Œç™»å½•å¤±è´¥ä¸èƒ½è®¿é—®ã€‚
*   å®ç°ç™»å½•åŠŸèƒ½ï¼š
    
    *   æ­¥éª¤1ï¼šæ•°æ®åº“å½“ä¸­æ·»åŠ ä¸€ä¸ªç”¨æˆ·è¡¨ï¼št\_user
        *   t\_userè¡¨å½“ä¸­å­˜å‚¨çš„æ˜¯ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œæœ€åŸºæœ¬çš„ä¹ŸåŒ…æ‹¬ï¼šç™»å½•çš„ç”¨æˆ·åå’Œç™»å½•çš„å¯†ç ã€‚
        *   å¯†ç ä¸€èˆ¬åœ¨æ•°æ®åº“è¡¨å½“ä¸­å­˜å‚¨çš„æ˜¯å¯†æ–‡ã€‚ä¸€èˆ¬ä¸ä»¥æ˜æ–‡çš„å½¢å¼å­˜å‚¨ã€‚ï¼ˆè¿™é‡Œå…ˆä½¿ç”¨æ˜æ–‡æ–¹å¼ã€‚ï¼‰
        *   å‘t\_userè¡¨ä¸­æ’å…¥æ•°æ®ã€‚
    *   æ­¥éª¤2ï¼šå†å®ç°ä¸€ä¸ªç™»å½•é¡µé¢ã€‚
        *   ç™»å½•é¡µé¢ä¸Šåº”è¯¥æœ‰ä¸€ä¸ªç™»å½•çš„è¡¨å•ã€‚æœ‰ç”¨æˆ·åå’Œå¯†ç è¾“å…¥çš„æ¡†ã€‚
        *   ç”¨æˆ·ç‚¹å‡»ç™»å½•ï¼Œæäº¤è¡¨å•ï¼Œæäº¤ç”¨æˆ·åå’Œå¯†ç ã€‚formæ˜¯postæ–¹å¼æäº¤ã€‚
    *   æ­¥éª¤3ï¼šåå°è¦æœ‰ä¸€ä¸ªå¯¹åº”çš„Servletæ¥å¤„ç†ç™»å½•çš„è¯·æ±‚ã€‚
        *   ç™»å½•æˆåŠŸï¼šè·³è½¬åˆ°éƒ¨é—¨åˆ—è¡¨é¡µé¢ã€‚
        *   ç™»å½•å¤±è´¥ï¼šè·³è½¬åˆ°å¤±è´¥çš„é¡µé¢ã€‚
    *   æ­¥éª¤4ï¼šå†æä¾›ä¸€ä¸ªç™»å½•å¤±è´¥çš„é¡µé¢ã€‚
*   ç™»å½•åŠŸèƒ½å®ç°äº†ï¼Œç›®å‰å­˜åœ¨çš„æœ€å¤§çš„é—®é¢˜ï¼š
    
    *   è¿™ä¸ªç™»å½•åŠŸèƒ½ç›®å‰åªæ˜¯ä¸€ä¸ªæ‘†è®¾ï¼Œæ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚åªè¦ç”¨æˆ·çŸ¥é“åç«¯çš„è¯·æ±‚è·¯å¾„ï¼Œç…§æ ·å¯ä»¥åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹è®¿é—®ã€‚
    *   è¿™ä¸ªç™»å½•æ²¡æœ‰çœŸæ­£èµ·åˆ°æ‹¦æˆªçš„ä½œç”¨ã€‚æ€ä¹ˆè§£å†³ï¼Ÿ

**è§£å†³æ–¹å¼ï¼šé€šè¿‡ session ä¼šè¯æœºåˆ¶ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶ä¸”ç™»å½•è¿‡ã€‚å› ä¸ºæ¶‰åŠåˆ°ç¯‡å¹…å†…å®¹çš„è¿‡å¤šï¼Œæ‰€ä»¥è¯¦ç»†å†…å®¹å¤§å®¶å¯ä»¥ç§»æ­¥è‡³ï¼šğŸ”œğŸ”œğŸ”œ** [B/Sç»“æ„ç³»ç»Ÿçš„ä¼šè¯æœºåˆ¶(session)\_ChinaRainbowSeaçš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/weixin_61635597/article/details/130444009?spm=1001.2014.3001.5501)

8\. è¡¥å……ï¼š
-------

åŒ…å **bean** æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013674-1242946448.png)

*   javabeanï¼ˆjavaçš„logoæ˜¯ä¸€æ¯å†’ç€çƒ­æ°”çš„å’–å•¡ã€‚javabeanè¢«ç¿»è¯‘ä¸ºï¼šå’–å•¡è±†ï¼‰
*   javaæ˜¯ä¸€æ¯å’–å•¡ï¼Œå’–å•¡åˆæ˜¯ç”±ä¸€ç²’ä¸€ç²’çš„å’–å•¡è±†ç ”ç£¨è€Œæˆã€‚
*   æ•´ä¸ªjavaç¨‹åºä¸­æœ‰å¾ˆå¤šbeançš„å­˜åœ¨ã€‚ç”±å¾ˆå¤šbeanç»„æˆã€‚
*   ä»€ä¹ˆæ˜¯javabeanï¼Ÿå®é™…ä¸Šjavabeanä½ å¯ä»¥ç†è§£ä¸ºç¬¦åˆæŸç§è§„èŒƒçš„javaç±»ï¼Œæ¯”å¦‚ï¼š
    *   æœ‰æ— å‚æ•°æ„é€ æ–¹æ³•
    *   å±æ€§ç§æœ‰åŒ–
    *   å¯¹å¤–æä¾›å…¬å¼€çš„setå’Œgetæ–¹æ³•
    *   å®ç°java.io.Serializableæ¥å£
    *   é‡å†™toString
    *   é‡å†™hashCode+equals
    *   ....
*   javabeanå…¶å®å°±æ˜¯javaä¸­çš„å®ä½“ç±»ã€‚è´Ÿè´£æ•°æ®çš„å°è£…ã€‚
*   ç”±äºjavabeanç¬¦åˆjavabeanè§„èŒƒï¼Œå…·æœ‰æ›´å¼ºçš„é€šç”¨æ€§ã€‚

ä¸¾ä¾‹ï¼šå¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ bean ç±»å…³äº dept ç±»å¯¹åº”æ•°æ®åº“è¡¨å½“ä¸­çš„ dept æ•°æ®è¡¨çš„å­—æ®µä¿¡æ¯ã€‚

    package com.RainbowSea.bean;
    
    import java.io.Serializable;
    import java.util.Objects;
    
    public class Dept implements Serializable {
    
        private static final long serialVersionUID = 1L;
    
        private String deptno;
        private String dname;
        private String loc;
    
    
        public Dept() {
        }
    
        public Dept(String deptno, String dname, String loc) {
            this.deptno = deptno;
            this.dname = dname;
            this.loc = loc;
        }
    
    
        public String getDeptno() {
            return deptno;
        }
    
        public void setDeptno(String deptno) {
            this.deptno = deptno;
        }
    
        public String getDname() {
            return dname;
        }
    
        public void setDname(String dname) {
            this.dname = dname;
        }
    
        public String getLoc() {
            return loc;
        }
    
        public void setLoc(String loc) {
            this.loc = loc;
        }
    
        @Override
        public boolean equals(Object o) {
            if (this == o) return true;
            if (!(o instanceof Dept)) return false;
            Dept dept = (Dept) o;
            return Objects.equals(getDeptno(), dept.getDeptno()) && Objects.equals(getDname(), dept.getDname()) && Objects.equals(getLoc(), dept.getLoc());
        }
    
        @Override
        public int hashCode() {
            return Objects.hash(getDeptno(), getDname(), getLoc());
        }
    
    
        @Override
        public String toString() {
            return "Dept{" +
                    "deptno='" + deptno + '\'' +
                    ", dname='" + dname + '\'' +
                    ", loc='" + loc + '\'' +
                    '}';
        }
    }
    
    
    

9\. æ€»ç»“:
-------

1.  JSP çš„æœ¬è´¨ï¼šä¸€ä¸ªindex\_jspç±»å°±æ˜¯ä¸€ä¸ªServletç±»ã€‚æ€»ç»“å°±æ˜¯ï¼šä¸€ä¸ª index.jsp æ–‡ä»¶ä¼šè¢«ç¿»è¯‘ä¸ºä¸€ä¸ª index\_jsp.java ç±»ï¼Œè€Œ è¯¥ ç¿»è¯‘çš„ index\_jsp.javaç±»æ˜¯ `ç»§æ‰¿` äº† org.apache.jasper.runtime.HttpJspBase ç±»çš„ï¼Œè€Œ org.apache.jasper.runtime.HttpJspBase ç±» æ˜¯ç»§æ‰¿äº† HttpServlet ç±»çš„ã€‚è¿™ä¸‹é€»è¾‘å°±æ¸…æ™°äº†ï¼Œ`JSP å°±æ˜¯ Servlet` ã€‚
    
2.  JSPçš„åŸºç¡€è¯­æ³•ï¼š
    
    1.  åœ¨JSPæ–‡ä»¶ä¸­ç›´æ¥ç¼–å†™æ–‡å­—ï¼Œç¿»è¯‘çš„æ˜¯åœ¨ `service()`æ–¹æ³•ä½“å†…çš„ï¼Œç¿»è¯‘åˆ° **servlet**ç±»çš„ **service()**æ–¹æ³•çš„ **out.write("ç¿»è¯‘åˆ°è¿™é‡Œ")** ï¼Œç›´æ¥ç¿»è¯‘åˆ°åŒå¼•å·é‡Œï¼Œè¢«javaç¨‹åºå½“åšæ™®é€šå­—ç¬¦ä¸²æ‰“å°è¾“å‡ºåˆ°æµè§ˆå™¨ã€‚
    2.  JSPçš„æ³¨é‡Šï¼š
    
        <%--JSPçš„ä¸“ä¸šæ³¨é‡Šï¼Œä¸ä¼šè¢«ç¿»è¯‘åˆ°javaæºä»£ç å½“ä¸­ã€‚--%> ä¸ä¼šç¿»è¯‘å¯¹åº”çš„ä¿¡æ¯ã€‚è¯¥æ³¨è§£å½“ä¸­çš„å†…å®¹ä¼šè¢«å¿½ç•¥è€Œä¸ç¿»è¯‘çš„ã€‚
        
        <!--è¿™ç§æ³¨é‡Šå±äºHTMLçš„æ³¨é‡Šï¼Œè¿™ä¸ªæ³¨é‡Šä¿¡æ¯ä»ç„¶ä¼šè¢«ç¿»è¯‘åˆ°javaæºä»£ç å½“ä¸­ï¼Œä¸å»ºè®®ã€‚-->  ç¿»è¯‘åˆ°HTMLå½“ä¸­ä½œä¸º html çš„
        æ³¨è§£å­˜åœ¨ã€‚
        
    
    3.  <% %> åœ¨è¿™ä¸ª`<% javaè¯­å¥; %>`ç¬¦å·å½“ä¸­ç¼–å†™çš„è¢«è§†ä¸ºjavaç¨‹åºï¼Œè¢«ç¿»è¯‘åˆ°Servletç±»çš„ `serviceæ–¹æ³•ä½“`å†…éƒ¨ã€‚æ³¨æ„æ–¹æ³•ä½“å½“ä¸­ä¸å¯ä»¥ç¼–å†™ä»€ä¹ˆå†…å®¹ã€‚åŒæ—¶å› ä¸ºç¼–å†™çš„æ˜¯ Javaä»£ç éœ€è¦éµä» Javaçš„è¯­æ³•ã€‚
    
        <% 
         
        // javaè¯­å¥;
        // åœ¨è¿™é‡Œç¼–å†™Javaç¨‹åºï¼Œç¼–å†™ Javaè¯­å¥ã€‚
        // æ—¢ç„¶æ˜¯ç¼–å†™ Javaè¯­å¥ï¼Œè‡ªç„¶è¦éµå¾ªJavaçš„è¯­æ³•è§„èŒƒã€‚
        // åœ¨è¿™é‡Œç¼–å†™çš„javaè¯­å¥ï¼Œä¼šè¢«ç¿»è¯‘åˆ° service() æ–¹æ³•ä½“å†…
        %>
        
    
    4.  `<%! %>`åœ¨è¿™ä¸ªç¬¦å·å½“ä¸­ç¼–å†™çš„javaç¨‹åºä¼šè‡ªåŠ¨ç¿»è¯‘åˆ°serviceæ–¹æ³•ä¹‹å¤–ã€‚ç®€å•çš„è¯´å°±æ˜¯ï¼š Servlet ç±»å½“ä¸­ï¼Œservice() æ–¹æ³•å¤–ï¼Œé‚£ä¸å°±æ˜¯ æˆå‘˜å˜é‡ï¼Œæ–¹æ³•ï¼Œä»£ç å—äº†ã€‚
    
        <%!
        	// åœ¨è¿™ä¸ªç¬¦å·å½“ä¸­ç¼–å†™çš„javaç¨‹åºä¼šè‡ªåŠ¨ç¿»è¯‘åˆ°serviceæ–¹æ³•ä¹‹å¤–ã€‚
            // service() æ–¹æ³•ä½“ä¹‹å¤–æ˜¯ä»€ä¹ˆï¼Œè‡ªç„¶å°±æ˜¯åœ¨ Servlet ç±»é‡Œé¢äº†ã€‚
        %>
        
    
    5.  <%= %>å‘æµè§ˆå™¨å‰ç«¯è¾“å…¥ Javaå˜é‡å€¼ï¼Œè€Œä¸æ˜¯å˜é‡åã€‚
    
        <% 
        String name = â€œjackâ€; 
        out.write("name = " + name); 
        %>
        
    
3.  **JSPæŒ‡ä»¤çš„ä½œç”¨ï¼š**æŒ‡å¯¼JSPçš„ç¿»è¯‘å¼•æ“å¦‚ä½•å·¥ä½œï¼ˆæŒ‡å¯¼å½“å‰çš„JSPç¿»è¯‘å¼•æ“å¦‚ä½•ç¿»è¯‘JSPæ–‡ä»¶ã€‚ï¼‰ä¸»è¦è¯´æ˜çš„æ˜¯ page æŒ‡ä»¤ã€‚æŒ‡ä»¤çš„æ ¼å¼:
    

    <%@æŒ‡ä»¤å  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼....%>
    // è¿™é‡Œæˆ‘ä»¬åªå­¦ä¹  page æŒ‡ä»¤æ‰€ä»¥æ˜¯:
    <%@page  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼  å±æ€§å=å±æ€§å€¼....%>
    

4.  JSP çš„ä¹å¤§å†…ç½®å¯¹è±¡ï¼šæ‰€è°“çš„JSPçš„ä¹å¤§å†…ç½®å¯¹è±¡æŒ‡çš„æ˜¯ï¼šåœ¨ `service()` æ–¹æ³•ä½“å½“ä¸­çš„å±€éƒ¨çš„å¯¹è±¡å˜é‡ï¼Œservice() æ–¹æ³•ä½“å¤–æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚
5.  JSP ç¬¬ä¸€æ¬¡è®¿é—®é€Ÿåº¦æ…¢çš„åŸå› ï¼šç¿»è¯‘ä¸º javaï¼Œå¹¶ç¼–è¯‘javaï¼Œç”Ÿæˆ class æ–‡ä»¶
6.  `JSPæ–‡ä»¶çš„æ‰©å±•åå¿…é¡»ä¸æ˜¯`xxx.jspåç¼€å—ï¼Œä¸æ˜¯çš„ï¼Œ.jspæ–‡\`ä»¶çš„æ‰©å±•åæ˜¯å¯ä»¥é…ç½®çš„ã€‚

    <servlet-mapping>
        <servlet-name>jsp</servlet-name>
        <url-pattern>*.jsp</url-pattern>
        <url-pattern>*.jspx</url-pattern>
    </servlet-mapping>
    

7.  å¼€å‘JSPçš„æœ€é«˜å¢ƒç•Œï¼š **çœ¼å‰ç¼–å†™çš„æ˜¯JSPä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¿ƒé‡Œï¼Œè„‘è¢‹é‡Œé¢å½“ä¸­å‘ˆç°çš„æ˜¯ javaä»£ç ã€‚**

10\. æœ€åï¼š
--------

> é™äºè‡ªèº«æ°´å¹³ï¼Œå…¶ä¸­å­˜åœ¨çš„é”™è¯¯ï¼Œå¸Œæœ›å¤§å®¶ç»™äºˆæŒ‡æ•™ï¼ŒéŸ©ä¿¡ç‚¹å…µâ€”â€”å¤šå¤šç›Šå–„ï¼Œè°¢è°¢å¤§å®¶ï¼Œæ±Ÿæ¹–å†è§ï¼Œåæ‚”æœ‰æœŸ
> 
> ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img2023.cnblogs.com/blog/3084824/202304/3084824-20230430172013951-474625100.gif)