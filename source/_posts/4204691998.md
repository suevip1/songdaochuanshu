---
layout: post
title: "Three.js è¿›é˜¶ä¹‹æ—…ï¼šæ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»å’Œç›¸æœºåŠ¨ç”» ğŸ¦¢"
date: "2023-05-25T01:08:00.303Z"
---
Three.js è¿›é˜¶ä¹‹æ—…ï¼šæ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»å’Œç›¸æœºåŠ¨ç”» ğŸ¦¢
==============================

![Three.js è¿›é˜¶ä¹‹æ—…ï¼šæ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»å’Œç›¸æœºåŠ¨ç”» &#129442;](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082902688-511132239.png) æœ¬æ–‡å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨æ»šåŠ¨æ§åˆ¶ ScrollControls æ¥æ§åˆ¶æ¨¡å‹çš„çš„åŠ¨ç”»æ’­æ”¾å’Œç›¸æœºåŠ¨ç”»ï¼Œé€šè¿‡æ»šåŠ¨é¼ æ ‡æ»šè½®æˆ–è€…ä¸Šä¸‹ç§»åŠ¨è§¦æ‘¸æ¿ï¼Œæ¥æ§åˆ¶æ¨¡å‹çš„åŠ¨ç”»æ’­æ”¾è¿›åº¦æˆ–è€…ç›¸æœºçš„æ–¹ä½è§†è§’ï¼Œä»è€Œå‘ˆç°å‡ºæƒŠè‰³çš„è§†è§‰æ•ˆæœã€‚é€šè¿‡æœ¬æ–‡çš„é˜…è¯»å’Œæ¡ˆä¾‹é¡µé¢çš„å®ç°ï¼Œä½ å°†å­¦ä¹ åˆ°çš„çŸ¥è¯†åŒ…æ‹¬ï¼šR3F ç”Ÿæ€ä¸­çš„ ScrollControlsã€Htmlã€useScrollã€useGLTFã€useAnimations ç­‰ç»„ä»¶å’Œæ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€åœ¨ R3F ä¸­åŠ è½½æ¨¡å‹å¹¶æ’­æ”¾æ¨¡å‹éª¨éª¼åŠ¨ç”»ã€é€šè¿‡æ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»æ’­æ”¾è¿›ç¨‹å’Œç›¸æœºå‚æ•°ã€é¡µé¢å…ƒç´ çš„ä¸€äº› CSS åŠ¨ç”»åŠé¡µé¢æ•´ä½“ä¸æ»‘æ»šåŠ¨åŠ¨ç”»å®ç°ç­‰ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082502148-1313350703.gif)

**å£°æ˜ï¼šæœ¬æ–‡æ¶‰åŠå›¾æ–‡å’Œæ¨¡å‹ç´ æä»…ç”¨äºä¸ªäººå­¦ä¹ ã€ç ”ç©¶å’Œæ¬£èµï¼Œè¯·å‹¿äºŒæ¬¡ä¿®æ”¹ã€éæ³•ä¼ æ’­ã€è½¬è½½ã€å‡ºç‰ˆã€å•†ç”¨ã€åŠè¿›è¡Œå…¶ä»–è·åˆ©è¡Œä¸ºã€‚**

æ‘˜è¦
--

[ä¸“æ ](https://juejin.cn/column/7140122697622618119)ä¸Šç¯‡æ–‡ç« [ã€ŠThree.js è¿›é˜¶ä¹‹æ—…ï¼šé¡µé¢\*æ»‘æ»šåŠ¨-ç‹å›½ä¹‹æ³ªã€‹](https://juejin.cn/post/7229808533420032056) è®²è§£å¹¶å®ç°äº†å¦‚ä½•ä½¿ç”¨ `R3F` è¿›è¡Œé¡µé¢å›¾ç‰‡\*æ»‘æ»šåŠ¨ï¼Œæœ¬æ–‡å†…å®¹åœ¨ä¸ŠèŠ‚çš„åŸºç¡€ä¸Šï¼Œå­¦ä¹ å¦‚ä½•ä½¿ç”¨æ»šåŠ¨æ§åˆ¶ `ScrollControls` æ¥æ§åˆ¶æ¨¡å‹çš„çš„åŠ¨ç”»æ’­æ”¾å’Œç›¸æœºåŠ¨ç”»ï¼Œ**é€šè¿‡æ»šåŠ¨é¼ æ ‡æ»šè½®æˆ–è€…ä¸Šä¸‹ç§»åŠ¨è§¦æ‘¸æ¿ï¼Œæ¥æ§åˆ¶æ¨¡å‹çš„åŠ¨ç”»æ’­æ”¾è¿›åº¦æˆ–è€…ç›¸æœºçš„æ–¹ä½è§†è§’**ï¼Œä»è€Œå‘ˆç°å‡ºæƒŠè‰³çš„è§†è§‰æ•ˆæœã€‚è¿™ç§æœ‰è¶£çš„æ•ˆæœå¤§å®¶åœ¨\*æ—¶æµè§ˆä¸€äº›ç½‘é¡µçš„æ—¶å€™åº”è¯¥ç»å¸¸è§åˆ°ï¼Œå¦‚ä¸€äº› `3Däº§å“` ä»‹ç»é¡µå‘ä¸‹æ»‘åŠ¨é¼ æ ‡æ»šè½®æ—¶äº§å“åŒæ—¶æ—‹è½¬å¹¶æ ¹æ®äº§å“çš„ä¸åŒè§†è§’åŠ è½½ä¸åŒæ–‡æ¡ˆã€æˆ–è€… `3Dæ•°å­—åœ°çƒ` æ ¹æ®æ»šè½®çš„ç§»åŠ¨è·ç¦»è½¬åˆ°æŸä¸ªå›½å®¶æˆ–åœ°åŒºã€è¿˜æœ‰ä¸€äº› `ä¸ªäººç®€å†` é¡µé¢æˆ–æ—¶é—´è½´é¡µé¢ä¹Ÿç»å¸¸ç”¨åˆ°è¿™ç§æ•ˆæœã€‚é€šè¿‡æœ¬æ–‡çš„é˜…è¯»å’Œæ¡ˆä¾‹é¡µé¢çš„å®ç°ï¼Œä½ å°†å­¦ä¹ åˆ°çš„çŸ¥è¯†åŒ…æ‹¬ï¼š`R3F` ç”Ÿæ€ä¸­çš„ `ScrollControls`ã€`Html`ã€`useScroll`ã€`useGLTF`ã€`useAnimations` ç­‰ç»„ä»¶å’Œæ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€åœ¨ `R3F` ä¸­åŠ è½½æ¨¡å‹å¹¶æ’­æ”¾æ¨¡å‹éª¨éª¼åŠ¨ç”»ã€é€šè¿‡æ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»æ’­æ”¾è¿›ç¨‹å’Œç›¸æœºå‚æ•°ã€é¡µé¢å…ƒç´ çš„ä¸€äº› `CSS` åŠ¨ç”»åŠé¡µé¢æ•´ä½“ä¸æ»‘æ»šåŠ¨åŠ¨ç”»å®ç°ç­‰ã€‚

æ•ˆæœ
--

æœ¬æ–‡æ¡ˆä¾‹çš„å®ç°æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé¡µé¢ä¸»ä½“å…ƒç´ ç”±ä¸€ä¸ªä¸‰ç»´æ¨¡å‹ `ğŸ¸ğŸ¦¢`ã€åŠåº•éƒ¨çš„ `5` é¡µ `HTML` é¡µé¢æ„æˆï¼Œé¡µé¢åˆå§‹åŠ è½½æ—¶æ¨¡å‹æ˜¯é™æ­¢çš„ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨é¼ æ ‡æˆ–è§¦æ§æ¿æˆ–ç›´æ¥æ‹–åŠ¨é¡µé¢æ»šåŠ¨æ¡æ—¶ `ğŸ–±`ï¼Œç›¸æœºé•œå¤´`ğŸ“·` ä»æ­£é¢\*å¤„\*æ»‘è¿‡æ¸¡åˆ°æ¨¡å‹ä¾§é¢è¿œå¤„ï¼Œæ¨¡å‹å¼€å§‹è‡ªåŠ¨æ’­æ”¾è‡ªå¸¦éª¨éª¼åŠ¨ç”»ï¼Œæ¨¡å‹åŠ¨ä½œæ ¹æ®é¡µé¢æ»šåŠ¨è·ç¦»å’Œæ»šåŠ¨æ—¶é€Ÿç‡çš„å¤§å°è€Œä¸åŒã€‚å½“æˆ‘ä»¬ç‚¹å‡»é¡µé¢é¡¶éƒ¨èœå•æ—¶ï¼Œé¡µé¢ä¼š\*æ»‘æ»šåŠ¨åˆ°å¯¹åº”ä½ç½®ï¼Œæ¨¡å‹ä¹Ÿä¼šæ’­æ”¾åŠ¨ç”»ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082520322-267452224.gif)

å½“é¡µé¢é€†å‘ `ğŸ‘†` æ»šåŠ¨æ—¶ï¼Œç›¸æœºå’Œæ¨¡å‹åŠ¨ç”»ä¹Ÿä¼šé€†å‘å˜åŒ–å’Œæ’­æ”¾ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082529610-639793345.gif)

æ–‡ç« ä½¿ç”¨ `GIF` å¯èƒ½ä¼šé€ æˆä¸¢å¸§æˆ–å¡é¡¿ï¼Œå¯ä»¥äº²è‡ªæ‰“å¼€é¢„è§ˆé“¾æ¥è¯•è¯•ï¼Œå¤§å±è®¿é—®æ•ˆæœæ›´ä½³ã€‚

*   `ğŸ‘â€ğŸ—¨` åœ¨çº¿é¢„è§ˆåœ°å€ï¼š[https://dragonir.github.io/dancingDuck/](https://dragonir.github.io/dancingDuck/)

æœ¬ä¸“æ ç³»åˆ—ä»£ç æ‰˜ç®¡åœ¨ `Github` ä»“åº“[ã€threejs-odesseyã€‘](https://github.com/dragonir/threejs-odessey)ï¼Œ**åç»­æ‰€æœ‰ç›®å½•ä¹Ÿéƒ½å°†åœ¨æ­¤ä»“åº“ä¸­æ›´æ–°**ã€‚

> `ğŸ”—` ä»£ç ä»“åº“åœ°å€ï¼šgit@github.com:dragonir/threejs-odessey.git

åŸç†
--

å¦‚æœç”¨åŸç”Ÿ `JavaScript` å®ç°æ»šåŠ¨åŠ¨ç”»æ•ˆæœï¼Œå°±éœ€è¦ç›‘å¬æ»šåŠ¨äº‹ä»¶å’Œè®¡ç®—æ»šåŠ¨è·ç¦»ã€‚æœ¬æ–‡è¿˜æ˜¯å’Œä¸Šç¯‡æ–‡ç« [ã€Šhree.js è¿›é˜¶ä¹‹æ—…ï¼šé¡µé¢\*æ»‘æ»šåŠ¨-ç‹å›½ä¹‹æ³ªã€‹](https://juejin.cn/post/7229808533420032056)ä¸€æ ·ï¼Œç›´æ¥ä½¿ç”¨å°è£…å¥½çš„ç»„ä»¶ `ScrollControls` å’Œ `Scroll` æ¥å®ç°ï¼Œå®ƒä»¬çš„è¯¦ç»†ç”¨æ³•å’ŒåŸç†å¯å‰å¾€ä¸Šç¯‡æ–‡ç« æŸ¥çœ‹ã€‚æœ¬æ–‡ä¸­æœ€ç»ˆå®ç°çš„é¡µé¢éœ€è¦åŠ è½½æ¨¡å‹å¹¶æ’­æ”¾å®ƒè‡ªå¸¦çš„éª¨éª¼åŠ¨ç”»ï¼Œå› æ­¤ç”¨åˆ°äº†ä»¥ä¸‹å‡ ä¸ª `@react-three/drei` ä¸­çš„ç»„ä»¶å’Œ `hooks`ã€‚

### Html

å…è®¸æˆ‘ä»¬å°† `HTML` å†…å®¹ç»‘å®šåˆ°åœºæ™¯ä¸­çš„ä»»æ„å¯¹è±¡ï¼Œå®ƒå°†è‡ªåŠ¨æŠ•å½±åˆ°å¯¹è±¡ä¸Šã€‚

    <Html
      as='div'                       // åŒ…è£¹å…ƒç´ ï¼Œé»˜è®¤ä¸º 'div'
      wrapperClass                   // åŒ…è£¹å…ƒç´ çš„ç±»åï¼Œé»˜è®¤ä¸º undefined
      prepend                        // ç”»å¸ƒåé¢çš„å…ƒç´ ï¼Œé»˜è®¤ä¸º false
      center                         // æ·»åŠ  -50%/-50% csså˜æ¢ï¼Œé»˜è®¤ä¸º false
      fullscreen                     // ä¸å·¦ä¸Šè§’å¯¹é½å¹¶å¡«æ»¡å±å¹•ï¼Œé»˜è®¤ä¸º false
      distanceFactor={10}            // å¦‚æœè®¾ç½®è¯¥å€¼ï¼Œå­å…ƒç´ å°†æŒ‰ä¸ç›¸æœºçš„è·ç¦»è¿›è¡Œç¼©æ”¾ï¼Œé»˜è®¤ä¸º undefined
      zIndexRange={[100, 0]}         // Zé˜¶èŒƒå›´ï¼Œé»˜è®¤ä¸º [16777271, 0]
      portal={domnodeRef}            // å¯¹ç›®æ ‡å®¹å™¨çš„å¼•ç”¨ï¼Œé»˜è®¤ä¸º undefined
      transform                      // è‹¥è®¾ç½® trueï¼Œå°†è¿›è¡Œ 3d çŸ©é˜µè½¬æ¢ï¼Œé»˜è®¤ä¸º false
      sprite                         // æ¸²æŸ“ä¸º spriteï¼Œä»…åœ¨è½¬æ¢æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼Œé»˜è®¤ä¸º false
      occlude                        // é®æŒ¡æ¨¡å¼ï¼Œé»˜è®¤ä¸º falseï¼Œå½“è®¾ç½®ä¸º blending æ—¶å°†å¼€å¯çœŸæ­£æ··åˆé®æŒ¡
      castShadow                     // äº§ç”Ÿé˜´å½±
      receiveShadow                  // æ¥æ”¶é˜´å½±
      // åƒ Mesh ä¸€æ ·è®¾ç½®æè´¨
      material={<meshPhysicalMaterial side={DoubleSide} opacity={0.1} />}
      // è¦†ç›–é»˜è®¤å®šä½åŠŸèƒ½
      calculatePosition={(el: Object3D, camera: Camera, size: { width: number; height: number }) => number[]}
      occlude={[ref]}                // å¯ä»¥ä¸ºçœŸæˆ– Ref<Object3D>ï¼Œå½“ä¸º true æ—¶é®æŒ¡æ•´ä¸ªåœºæ™¯ï¼Œé»˜è®¤ä¸º undefined
      onOcclude={(visible) => null}  // å¯è§æ€§ä¿®æ”¹æ—¶çš„å›è°ƒï¼Œé»˜è®¤ä¸º undefined
      {...groupProps}                // æ”¯æŒæ‰€æœ‰ THREE.Group å±æ€§
      {...divProps}                  // æ”¯æŒæ‰€æœ‰ HTML DIV å…ƒç´ å±æ€§
    >
      <h1>hello</h1>
      <p>world</p>
    </Html>
    

`Html` å¯ä»¥é€šè¿‡é…ç½® `occlude` å±æ€§éšè—åœ¨å‡ ä½•ä½“åé¢ã€‚å½“ `Html` ç»„ä»¶éšè—æ—¶ï¼Œå®ƒå°†åœ¨æœ€å†…éƒ¨çš„ `div` ä¸Šè®¾ç½® `opacity` å±æ€§ï¼Œå¦‚æœéœ€è¦æ·»åŠ åŠ¨ç”»æ•ˆæœæˆ–è€…æ§åˆ¶è¿‡æ¸¡æ•ˆæœï¼Œå¯ä»¥ä½¿ç”¨ `onOcclude` è‡ªå®šä¹‰æ–¹æ³•ã€‚

    <Html
      occlude
      onOcclude={set}
      style={{
        transition: 'all 0.5s',
        opacity: hidden ? 0 : 1,
        transform: `scale(${hidden ? 0.5 : 1})`
      }}
    />
    

### useGLTF

å®ƒæ˜¯ä¸€ä¸ªä½¿ç”¨ `useLoader` å’Œ `GLTFLoader` çš„æ–¹ä¾¿é’©å­å‡½æ•°ï¼Œå®ƒé»˜è®¤ä½¿ç”¨ [draco](https://www.gstatic.com/draco/v1/decoders/) æ¥åŠ è½½å·²å‹ç¼©çš„æ¨¡å‹æ–‡ä»¶ã€‚

    useGLTF(url)
    useGLTF(url, '/draco-gltf')
    useGLTF.preload(url)
    

### useAnimations

[AnimationMixer](https://threejs.org/docs/#api/en/animation/AnimationMixer) çš„æŠ½è±¡é’©å­æ–¹æ³•ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·è·å–åˆ°æ¨¡å‹è‡ªå¸¦çš„åŠ¨ç”»ä¿¡æ¯ã€‚

    const { nodes, materials, animations } = useGLTF(url)
    const { ref, mixer, names, actions, clips } = useAnimations(animations)
    useEffect(() => {
      actions?.jump.play()
    })
    

### THREE.MathUtils.damp

ä½¿ç”¨ `dt` ä»¥ç±»ä¼¼å¼¹ç°§çš„æ–¹å¼ä» `x` å‘ `y` \*æ»‘åœ°æ’å…¥ä¸€ä¸ªæ•°å­—ï¼Œä»¥ä¿æŒä¸å¸§é€Ÿç‡æ— å…³çš„è¿åŠ¨ã€‚

    .damp (x : Float, y: Float, lambda: Float, dt: Float ): Float
    

*   `x`ï¼šå½“å‰ç‚¹ã€‚
*   `y`ï¼šç›®æ ‡ç‚¹ã€‚
*   `lambda`ï¼šè¾ƒé«˜çš„ `lambda` å€¼å¯ä»¥ä½¿è¿åŠ¨æ›´åŠ çªç„¶ï¼Œè¾ƒä½çš„å€¼å¯ä»¥ä½¿è¿åŠ¨æ›´åŠ \*ç¼“ã€‚
*   `dt`ï¼šä»¥ç§’ä¸ºå•ä½çš„å¢é‡æ—¶é—´ã€‚

å®ç°
--

### ã€‡ èµ„æºå¼•å…¥

åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼Œæˆ‘ä»¬æŒ‰ä¸Šè¿°åŸç†ä¸­æ‰€è¿°ï¼Œå¼•å…¥å¿…éœ€çš„ç»„ä»¶å’Œæ–¹æ³•ã€‚

    import * as THREE from 'three';
    import { Suspense, useEffect } from 'react';
    import { Canvas, useFrame } from '@react-three/fiber';
    import { ScrollControls, Html, useScroll, useGLTF, useAnimations } from '@react-three/drei';
    

### â‘  åœºæ™¯åˆå§‹åŒ–

åœºæ™¯åˆå§‹åŒ–éå¸¸ç®€å•ï¼Œåªéœ€åƒä¸‹é¢è¿™æ ·æ·»åŠ  `R3F` çš„ `<Canvas />` ç»„ä»¶ï¼Œå¹¶åˆå§‹åŒ–ç›¸æœºä½ç½®å³å¯ã€‚

    export default function Experience() {
      return (
        <>
          <Canvas camera={{ position: [0, 0, 0] }}></Canvas>
        </>
      );
    }
    

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082554884-1813625127.png)

### â‘¡ åŠ è½½æ¨¡å‹

æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ª `ShubaDuck` ç±»ç”¨æ¥è¡¨ç¤ºæ¨¡å‹å…ƒç´ ï¼Œç„¶åä½¿ç”¨ `useGLTF` åŠ è½½æ¨¡å‹ `ğŸ¸ğŸ¦¢` å¹¶ä½¿ç”¨æ¨¡å‹æ–‡ä»¶çš„ `scene` è¿›è¡Œæ¸²æŸ“ã€‚ç„¶ååœ¨ `Canvas` ä¸­æ·»åŠ æ¨¡å‹å…ƒç´ ï¼Œå¹¶é€šè¿‡ `scale` ã€`position` ç­‰å±æ€§è°ƒæ•´æ¨¡å‹åœ¨é¡µé¢ä¸Šçš„æ˜¾ç¤ºå¤§å°å’Œä½ç½®ã€‚åœ¨é¡µé¢æ¸²æŸ“å‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ `useGLTF.preload` å¯¹æ¨¡å‹è¿›è¡Œé¢„åŠ è½½ï¼Œä»¥æé«˜é¡µé¢ä½¿ç”¨ä½“éªŒã€‚

    function ShubaDuck({ ...props }) {
      const { scene, animations } = useGLTF('./models/duck.glb')
      return <primitive object={scene} {...props} />
    }
    useGLTF.preload('./models/duck.glb');
    
    <Canvas camera={{ position: [0, 0, 0] }}>
      <ShubaDuck scale={8} position={[0, -7, 0]} />
    </Canvas>
    

ä»¥ä¸‹ä¸ºåŸå§‹æ¨¡å‹æ–‡ä»¶ï¼Œä¸‹è½½å®Œæ¨¡å‹åå¯ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ `Blender` ä¸­æŸ¥çœ‹æ¨¡å‹ç»“æ„å’ŒåŠ¨ç”»ä¿¡æ¯ï¼Œåˆ é™¤ä¿®æ”¹ä¸éœ€è¦çš„å…ƒç´ ï¼Œæœ€åå‹ç¼©å¯¼å‡ºã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082740253-1879490037.png)

é¡µé¢ä¸­å®Œæˆæ¨¡å‹åŠ è½½å¹¶æ¸²æŸ“ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082603943-1984968341.png)

> `ğŸ”—` æ¨¡å‹æ–‡ä»¶æ¥æºï¼š[https://sketchfab.com/3d-models/shuba-duck-54a6276ce06c4cc88fd497c8f1b8eb66](https://sketchfab.com/3d-models/shuba-duck-54a6276ce06c4cc88fd497c8f1b8eb66)

### â‘¢ æ’­æ”¾æ¨¡å‹éª¨éª¼åŠ¨ç”»

æˆ‘ä»¬ä»æ¨¡å‹ä¸­æ‹¿åˆ°å†…ç½®çš„éª¨éª¼åŠ¨ç”» `animations`ï¼Œç„¶åä½¿ç”¨ `useAnimations` è·å–åˆ°æ‰€æœ‰çš„åŠ¨ä½œï¼Œå¯ä»¥æ ¹æ®åŠ¨ä½œçš„åç§°è¿›è¡ŒåŠ¨ç”»æ’­æ”¾æ¯”å¦‚æœ¬ä¾‹ä¸­æ˜¯ `LironShuba`ã€‚å¯ä»¥åœ¨ `useEffect` ä¸­å¯¹åŠ¨ä½œä½¿ç”¨ `play()` æ–¹æ³•è¿›è¡Œæ’­æ”¾ï¼Œæœ¬ä¾‹ä¸­çš„ `reset()`ã€`fadeIn()` æ–¹æ³•éƒ½æ˜¯å¯é€‰çš„ï¼Œå®ƒä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯å¼€å§‹å‰é‡ç½®åŠ¨ä½œå’Œæ¨¡å‹å…¥åœºåŠ¨ç”»ç±»å‹ã€‚

    function ShubaDuck({ ...props }) {
      const { scene, animations } = useGLTF('./models/duck.glb')
      const { actions } = useAnimations(animations, scene)
      // æ’­æ”¾æ¨¡å‹åŠ¨ç”»
      useEffect(() => void (actions['LironShuba'].reset().fadeIn(0.5).play()), [actions])
      // ...
    }
    

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082611484-1762195812.gif)

### â‘£ æ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»

ç°åœ¨æˆ‘ä»¬æ¥æ·»åŠ **é€šè¿‡é¼ æ ‡æ»šè½®æ»šåŠ¨æ¥æ§åˆ¶æ¨¡å‹åŠ¨ç”»æ’­æ”¾è¿›åº¦**çš„åŠŸèƒ½ï¼Œå³å½“æˆ‘ä»¬å‘ä¸‹æ»šåŠ¨é¡µé¢æ—¶ï¼Œæ¨¡å‹åŠ¨ç”»æ­£å‘æ’­æ”¾ï¼Œå¦åˆ™é€†å‘æ’­æ”¾ï¼Œæ»šåŠ¨é€Ÿåº¦è¶Šå¿«ï¼Œæ¨¡å‹åŠ¨ç”»æ’­æ”¾é€Ÿåº¦ä¹Ÿè¶Šå¿«ã€‚æˆ‘ä»¬å…ˆåœ¨ `useEffect` ä¸­å°†æ¨¡å‹åŠ¨ç”»åˆå§‹çŠ¶æ€è®¾ç½®ä¸º `pause` æš‚åœï¼Œç„¶ååœ¨ `useFrame` é¡µé¢é‡ç»˜åŠ¨ç”»é’©å­å‡½æ•°ä¸­æ‹¿åˆ°åŠ¨ç”»åŠ¨ä½œå’Œæ»šåŠ¨ç™¾åˆ†æ¯” `scroll.offset`ï¼Œè®¾ç½®åŠ¨ä½œæ’­æ”¾æ—¶é—´ `action.time`ï¼Œä½¿å…¶ä»åˆå§‹å€¼\*æ»‘è¿‡æ¸¡åˆ°ç›®æ ‡å€¼ï¼Œç›®æ ‡å€¼çš„ç¡®å®šå¯ä»¥é€šè¿‡æ•´ä¸ªåŠ¨ç”»æ’­æ”¾å‘¨æœŸæ—¶é—´ä»¥åŠé¡µé¢æ»šåŠ¨è·ç¦»çš„é•¿åº¦å»è®¡ç®—ï¼Œç¬¬ä¸‰ä¸ªå‚æ•° `lambda` ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„é¡µé¢è¿›è¡Œè°ƒæ•´ã€‚

    function ShubaDuck({ ...props }) {
      // ...
      useEffect(() => void (actions['LironShuba'].play().paused = true), [actions])
      useFrame((state, delta) => {
        const action = actions['LironShuba']
        const offset = scroll.offset
        action.time = THREE.MathUtils.damp(action.time, (action.getClip().duration / 2) * offset, 100, delta)
        state.camera.lookAt(0, 0, 0)
      })
      // ...
    }
    

åœ¨é¡µé¢ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ `<ScrollControls />` ç»„å°†å°†æ¨¡å‹ç»„ä»¶ `<ShubaDuck />` åŒ…è£¹èµ·æ¥ã€‚

    <Canvas camera={{ position: [0, 0, 0] }}>
      <Suspense fallback={null}>
        <ScrollControls pages={4}>
          <ShubaDuck scale={10} position={[0, -10, 0]} />
        </ScrollControls>
      </Suspense>
    </Canvas>
    

æ­¤æ—¶ä½¿ç”¨æ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»åŠŸèƒ½å°±å…¨éƒ¨å®Œæˆäº†ï¼Œé¡µé¢åˆå§‹åŠ è½½æ—¶æ¨¡å‹æ˜¯é™æ­¢çš„ï¼Œå½“æˆ‘ä»¬æ»šåŠ¨é¡µé¢æ—¶ï¼Œæ¨¡å‹æ ¹æ®æ»šåŠ¨é€Ÿåº¦å’Œæ»šåŠ¨è·ç¦»å°±ä¼šè‡ªåŠ¨æ’­æ”¾å¯¹åº”çš„åŠ¨ç”»äº†ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082623531-2046916089.gif)

> `ğŸ’¡` scroll.offset æ˜¯ä¸€ä¸ªå¤„äº \[0, 1\] ä¹‹é—´çš„æ•°ï¼Œè¡¨ç¤ºæ»šåŠ¨çš„ç™¾åˆ†æ¯”ï¼Œå½“é¡µé¢æœªæ»šåŠ¨æ—¶å€¼ä¸º 0ï¼Œå®Œå…¨æ»šåŠ¨åˆ°å°½å¤´æ—¶å€¼ä¸º 1.

### â‘¤ æ»šåŠ¨æ§åˆ¶ç›¸æœº

åœ¨ `useFrame` é’©å­å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åœ¨é¡µé¢æ»šåŠ¨æ—¶åŠ¨æ€ä¿®æ”¹ç›¸æœº `ğŸ“·` çš„ä½ç½®ï¼Œè¿™æ ·åœ¨è§†è§‰ä¸Šä¹Ÿèƒ½å½¢æˆæ¯”å¦‚æ¨¡å‹æ—‹è½¬ã€æ”¾å¤§ç¼©å°ã€æ˜¾ç¤ºéšè—ç­‰åŠ¨ç”»æ•ˆæœã€‚æœ¬æ¡ˆä¾‹ä¸­ä½¿ç”¨äº†å¦‚ä¸‹çš„è®¾ç½®ï¼Œå½“é¡µé¢ä»ä¸Šå¾€ä¸‹æ»šåŠ¨æ—¶ï¼Œç›¸æœºä»æ¨¡å‹æ­£é¢å˜æ¢åˆ°æ¨¡å‹ä¾§é¢æ›´è¿œçš„åœ°æ–¹ï¼Œåœ¨è§†è§‰ä¸Šå½¢æˆæ¨¡å‹è½¬èº«å¹¶å˜å°çš„æ•ˆæœ `âœ¨`ã€‚

    useFrame((state, delta) => {
      // ...
      state.camera.position.set(Math.sin(-offset) * 50, 1, Math.cos((offset * Math.PI) / 5) * 15)
    })
    

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082632396-1536925193.gif)

### â‘¥ é¡µé¢è£…é¥°

æ¨¡å‹éƒ¨åˆ†å·²ç»å…¨éƒ¨å®Œæˆäº†ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŸç†ä¸­ä»‹ç»çš„ `Html` ç»„ä»¶ï¼Œå°†å…¶æ·»åŠ åˆ°é¡µé¢ä¸­ï¼Œå¹¶ç›´æ¥ç”¨ `HTML` å’Œ `CSS` æ·»åŠ ä¸€äº›å¥½çœ‹çš„é¡µé¢ï¼Œä¸æ¨¡å‹ä¸»é¢˜å‘¼åº”ã€‚åƒä¸‹é¢è¿™æ ·ï¼Œæœ¬æ–‡ä¸­æ·»åŠ äº† `5` ä¸ªé¡µé¢ï¼Œæ¯ä¸ªé¡µé¢éƒ½æ·»åŠ äº†ä¸åŒçš„æ ·å¼ã€‚æœ‰æ—¶é—´çš„è¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ `gsap` ç­‰åŠ¨ç”»åº“ï¼Œç»™ `HTML` å…ƒç´ ä¹Ÿæ·»åŠ ä¸€äº›æ»šåŠ¨æ—¶çš„åŠ¨ç”»æ•ˆæœ `âœ¨`ã€‚

    <Canvas camera={{ position: [0, 0, 0] }}>
      <Suspense fallback={null}>
        <ScrollControls pages={4}>
          <Html wrapperClass='articles' occlude>
            <article className='page page1'></article>
            <article className='page page2'></article>
            <article className='page page3'></article>
            <article className='page page4'></article>
            <article className='page page5'></article>
          </Html>
          <ShubaDuck scale={10} position={[0, -10, 0]} />
        </ScrollControls>
      </Suspense>
    </Canvas>
    

#### ç¬¬ä¸€é¡µ

ç¬¬ä¸€é¡µæœ‰è¾ƒå¤šçš„é¡µé¢å…ƒç´ ï¼Œå…¶ä¸­åº•éƒ¨ç™½è‰²æ–‡å­—ä½¿ç”¨äº†ä¸€ç§ `woff2` æ ¼å¼çš„å¼€æºå¡é€šå­—ä½“ï¼Œæ—‹è½¬çš„é¹… `ğŸ¦¢` æ˜¯é€šè¿‡å¦‚ä¸‹ `CSS` åŠ¨ç”»å®ç°çš„ã€‚

    @keyframes rotateY
      from
        transform: perspective(400px) rotateY(0deg)
      to
        transform: perspective(400px) rotateY(360deg)
    

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082642215-1444520191.gif)

#### ç¬¬äºŒé¡µ

ç¬¬äºŒé¡µæ˜¯ `3` ä¸ªè‰²å— `ğŸŸ©` é€šè¿‡æ—‹è½¬åå½¢æˆçš„å›¾æ¡ˆï¼Œç»™å®ƒä»¬æ·»åŠ äº†æ˜æš—å˜åŒ–çš„åŠ¨ç”»æ•ˆæœã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082649291-1311585186.gif)

#### å…¶ä»–é¡µ

å‰©ä¸‹çš„é¡µé¢ä½¿ç”¨äº†ä¸€äº›ç®€å•çš„æ–‡æ¡ˆæˆ–å›¾ç‰‡å…ƒç´ ï¼Œç­‰æœ‰æ—¶é—´å†ä¼˜åŒ–å°å§ `ğŸ˜‚`ã€‚å…¶å®è¿˜æœ‰å¾ˆå¤šç»†èŠ‚æ ·å¼å’ŒåŠŸèƒ½ï¼Œå¦‚é¼ æ ‡çš„æ ·å¼æ˜¯ä¸€ä¸ª `ğŸŸ¡`ã€å‘ä¸‹æ»šåŠ¨çš„æç¤ºè¯­ã€é¡¶éƒ¨åŠé€æ˜çš„å¯¼èˆªèœå•ç­‰ï¼Œå…·ä½“å®ç°å¯æŸ¥çœ‹æºç ã€‚

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082657784-212615896.png)  
![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082704003-1780329350.png)  
![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082711168-907750120.png)

### â‘¦ ç‚¹å‡»èœå•æ é¡µé¢æ»‘åŠ¨åŠ¨ç”»

æœ€åï¼Œæˆ‘ä»¬æ¥ç»™é¡µé¢é¡¶éƒ¨çš„èœå•æ·»åŠ ä¸€ä¸‹ç‚¹å‡»æ“ä½œ `ğŸ–±` ã€‚ç‚¹å‡»é¡µé¢é¡¶éƒ¨å¯¼èˆªæ èœå•æ»‘åŠ¨åˆ°å¯¹åº”é¡µé¢åŠŸèƒ½å®ç°ä½¿ç”¨äº† `element.scrollIntoView` æ–¹æ³•ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å®ç°å¹¶ç»‘å®šåˆ°èœå•çš„ç‚¹å‡»äº‹ä»¶ä¸­ï¼Œæ­¤æ—¶ç‚¹å‡»èœå•é¡µé¢æ»šåŠ¨æ—¶ï¼Œæ¨¡å‹åŠ¨ç”»ä¹Ÿä¼šåŒæ—¶æ’­æ”¾ã€‚

    const handleMenuClick = (className) => {
      const page = document.querySelector(className);
      page.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });
    }
    
    <span className='menu' onClick={handleMenuClick.bind(this, '.page1')}></span>
    

![](https://img2023.cnblogs.com/blog/772544/202305/772544-20230525082721170-814564783.gif)

> `ğŸ”—` æºç åœ°å€ï¼š [https://github.com/dragonir/threejs-odessey](https://github.com/dragonir/threejs-odessey)

æ€»ç»“
--

æœ¬æ–‡ä¸­ä¸»è¦åŒ…å«çš„çŸ¥è¯†ç‚¹åŒ…æ‹¬ï¼š

*   `R3F` ç”Ÿæ€ä¸­çš„ `ScrollControls`ã€`Html`ã€`useScroll`ã€`useGLTF`ã€`useAnimations` ç­‰ç»„ä»¶å’Œæ–¹æ³•çš„åŸºæœ¬ç”¨æ³•ã€‚
*   å­¦ä¼šåœ¨ `R3F` ä¸­åŠ è½½æ¨¡å‹å¹¶æ’­æ”¾æ¨¡å‹éª¨éª¼åŠ¨ç”»ã€‚
*   é€šè¿‡æ»šåŠ¨æ§åˆ¶æ¨¡å‹åŠ¨ç”»æ’­æ”¾è¿›ç¨‹å’Œç›¸æœºå‚æ•°ã€‚
*   åœ¨æ»šåŠ¨é¡µé¢ä¸­å°†æ¨¡å‹å’Œ `HTML` å…ƒç´ ç»“åˆèµ·æ¥ã€‚
*   é¡µé¢å…ƒç´ çš„ä¸€äº› `CSS` åŠ¨ç”»åŠé¡µé¢æ•´ä½“ä¸æ»‘æ»šåŠ¨åŠ¨ç”»å®ç°ç­‰ã€‚

> æƒ³äº†è§£å…¶ä»–å‰ç«¯çŸ¥è¯†æˆ–å…¶ä»–æœªåœ¨æœ¬æ–‡ä¸­è¯¦ç»†æè¿°çš„**Web 3D**å¼€å‘æŠ€æœ¯ç›¸å…³çŸ¥è¯†ï¼Œå¯é˜…è¯»æˆ‘å¾€æœŸçš„æ–‡ç« ã€‚å¦‚æœæœ‰ç–‘é—®å¯ä»¥åœ¨è¯„è®ºä¸­**ç•™è¨€**ï¼Œå¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸è¦å¿˜äº†**ä¸€é”®ä¸‰è¿å“¦ ğŸ‘**ã€‚

é™„å½•
--

*   \[1\]. [ğŸŒ´ Three.js æ‰“é€ ç¼¤çº·å¤æ—¥3Dæ¢¦ä¸­æƒ…å²›](https://juejin.cn/post/7102215670477094925)
*   \[2\]. [ğŸ”¥ Three.js å®ç°ç‚«é…·çš„èµ›åšæœ‹å…‹é£æ ¼3Dæ•°å­—åœ°çƒå¤§å±](https://juejin.cn/post/7124116814937718797)
*   \[3\]. [ğŸ¼ Three.js å®ç°2022å†¬å¥¥ä¸»é¢˜3Dè¶£å‘³é¡µé¢ï¼Œå«å†°å¢©å¢©](https://juejin.cn/post/7060292943608807460)
*   \[4\]. [ğŸ¦Š Three.js å®ç°3Då¼€æ”¾ä¸–ç•Œå°æ¸¸æˆï¼šé˜¿ç‹¸çš„å¤šå…ƒå®‡å®™](https://juejin.cn/post/7081429595689320478)
*   \[5\]. [ğŸ¡ Three.js è¿›é˜¶ä¹‹æ—…ï¼šå…¨æ™¯æ¼«æ¸¸-é«˜é˜¶ç‰ˆåœ¨çº¿çœ‹æˆ¿](https://juejin.cn/post/7220075270664634428)
*   `...`
*   [ã€Three.js è¿›é˜¶ä¹‹æ—…ã€‘ç³»åˆ—ä¸“æ è®¿é—® ğŸ‘ˆ](https://juejin.cn/column/7140122697622618119)
*   [æ›´å¤šå¾€æœŸã€3Dã€‘ä¸“æ è®¿é—® ğŸ‘ˆ](https://juejin.cn/column/7049923956257587213)
*   [æ›´å¤šå¾€æœŸã€å‰ç«¯ã€‘ä¸“æ è®¿é—® ğŸ‘ˆ](https://juejin.cn/column/7021076460089638926)

å‚è€ƒ
--

*   \[1\]. [threejs.org](https://threejs.org)
*   \[2\]. [drei.pmnd.rs](https://drei.pmnd.rs/)

> æœ¬æ–‡ä½œè€…ï¼šdragonir æœ¬æ–‡åœ°å€ï¼š[https://www.cnblogs.com/dragonir/p/17430114.html](https://www.cnblogs.com/dragonir/p/17430114.html)