---
layout: post
title: "PB从入坑到放弃（一）第一个HelloWorld程序"
date: "2023-07-03T01:25:37.322Z"
---
PB从入坑到放弃（一）第一个HelloWorld程序
==========================

### 前言

网上关于`PowerBuilder`的资料确实是少之又少。

为了方便，后面我们都用`pb` 来代替`PowerBuilder`

说到这不得不来说说自己的`pb`入坑经历， 自己也不是计算机科班出生。

刚到公司面试，听到`pb`也是一脸懵逼，这啥东西，从来没听过。

然而，不知不觉已经干了好几年😔

也是有了这些踩坑的经历，才打算写《`pb`从入坑到放弃》系列文章。这篇呢也是这系列的第一篇。

扯得有点远了，还是回到正轨来，本篇文章我们主要就是用`pb` 创建第一个`helloworld` 程序。

并将程序编译发布成可执行文件(.exe结尾的文件)，有了可执行文件，我们还要将它制作成安装包。

### 一 、`PowerBuilder` 是什么？

*   `pb`是美国`Sybase`公司研制的快速开发工具
*   它包含一个直观的**图形界面**和**可扩展的面向对象的编程语言**`PowerScript`
*   `pb`的主要特色是`DataWindow`（**数据窗口**），通过`DataWindow`可以方便地对数据库进行各种操作，可以不用写`SQL`就能快速开发出各种简单或者复杂报表
*   可以直接与`Sybase`、`SQLServer`、`nformix`、`Oracle`等大型数据库连接

### 二、`PowerBuilder` 下载安装

有不少新来的小伙伴经常会问，我是刚学`pb` 应该安装哪个版本好呢。

小编这里推荐几个版本9、11.5、12.5 这几个版本算是用得比较多和比较稳定的，当然了最新的版本是2022

小编呢工作上由于要维护老项目，也是一直在用着9这个版本。

这里给大家找了各个版本的安装包，大家根据需要下载安装即可（**有的需要安装补丁包的，也都在里面的**），还有一些`pb`相关工具

链接：[https://pan.baidu.com/s/1WdGfYRw5jNLD70QXbaDmBg](https://pan.baidu.com/s/1WdGfYRw5jNLD70QXbaDmBg)  
提取码：8888

![image-20230626075127183](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636138-603828165.png)

### 三、创建第一个`HelloWorld`程序

小编安装的是`pb12.5`,这里就用这个版本来演示

#### 3.1 创建helloworld程序

① 新建工作空间

> 点击菜单：File--->New--->Workspace

\--

\--

![image-20230626080745169](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636047-1660266430.png)

![image-20230626080822166](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636130-1806907485.png)

② 选择路径保存工作空间

![image-20230626081056386](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081735853-1028792514.png)

③ 创建一个Application(应用程序实例)

> 菜单栏---->File---->New---->Target---->Application

![image-20230626081524446](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636228-1751363257.png)

给应用实例起名，我们还是用默认的`HelloWorld` 就可以了

![image-20230626081754527](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636250-804989028.png)

到此一个简单的项目架构就搭好了，是不是很easy呢

④ 创建窗口

> File--->new---->Pb Object---->Window

![创建窗口](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636085-913021259.png)

![窗口上放置控件](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636268-1998618900.png)

![命名窗口](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636268-111644396.png)

④ 写代码，打开窗口

> 我们要在Application对象的Open事件中书写代码，open事件可以看作是程序的入口

    open(w_helloworld)
    

![image-20230627220145431](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636081-959572482.png)

⑤ 运行程序

> 点击奔跑的小人即可运行程序

![点击运行程序](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636211-2039971015.png)

![程序运行起来了](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636215-937835005.png)

到此，我们第一个`pb`开发的`helloworld` 程序就跑起来了

#### 3.2 项目文件机构介绍

![image-20230626082809622](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636099-1211455184.png)

### 四、程序编译与发布

> 上面小节中我们的程序已经在编辑器中跑起来了，那么怎么才能将它编译成exe可执行文件直接运行呢？
> 
> 这小节，我们就来实现将我们开发好的程序编译成exe可执行文件

① 新建Application Wizard

\-- 1 新建Application Wizard

\-- 2下一步

![image-20230627221649034](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636266-617882260.png)

![image-20230627221727613](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636280-1328662483.png)

\-- 3 下一步

\-- 4 新建p\_helloworld\_exe

![image-20230627221801915](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636082-1050915774.png)

![image-20230627221834542](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636261-999195522.png)

\-- 5 选择exe可执行文件路径

\-- 6 选择全编译

![image-20230627222136300](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636231-1542720166.png)

![image-20230627222334414](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636126-928552901.png)

\-- 默认勾选

\--8 将pbl编译成pbd

![image-20230627222407722](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636243-1107157435.png)

![image-20230627222450963](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636270-966754838.png)

\-- 9 填写版本信息

\--完成

![image-20230627222526849](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636125-1596412075.png)

![image-20230627222549380](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636271-768588710.png)

② 编译程序生成exe可执行文件

\--

\--

![image-20230627223039728](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636138-1473695319.png)

![image-20230627223128417](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636119-1770997573.png)

\-- 版本信息

![image-20230627223328599](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636189-864798310.png)

以上检查都正确后，点击编译按钮进行编译

\--

\--

![image-20230627223439886](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636182-744420229.png)

![image-20230627223533440](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636102-1611226333.png)

③ 查看生成的exe,并运行exe文件

![exe可执行文件](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636163-436803401.png)

④ 双击helloworld.exe 运行程序

![运行程序](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636138-713180629.png)

### 五、安装包制作

> 无论你是软件开发、还是游戏开发，无论你用什么工具进行开发，我们都需要将我们开发好的程序打包发给客户。
> 
> 这一小节，我们就来看看怎么将我们上面开发好的程序制作成好看的安装包

#### 5.1 打包工具

我们这里推荐使用的是`Inno setup`软件制作Windows安装包

`Inno setup`是一个免费、开源、简单的打包软件。

这个软件足够简单，一分钟就完成打包。这个软件也足够强大，你想实现的功能，它几乎都能满足。

不仅功能强大，`Inno Setup`软件还可以实现类似于“QQ音乐安装包”、“搜狗输入法安装包”的界面效果

#### 5.2 软件下载

官网：[https://jrsoftware.org/isinfo.php](https://jrsoftware.org/isinfo.php)

界面汉化包地址：[https://jrsoftware.org/files/istrans/](https://jrsoftware.org/files/istrans/)

![下载页面](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636185-1309718256.png)

按照方式很简单，使用默认按照即可

\-- 下载的安装包

\-- 安装成功后图标

![下载的exe](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636171-1863303305.png)

![image-20230629203755229](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636214-1462254080.png)

#### 5.3 将我们开发好的程序制作成安装包

① 打开 `inno setup`安装包制作工具。新手用户建议和我一样使用向导来协助制作

![使用向导制作](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636118-1188815077.png)

② 默认下一步

![默认下一步](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636188-196406376.png)

③ 填写相关信息

![填写相关信息](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636191-710200541.png)

④ 配置安装路径

![配置安装路径](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636183-85334490.png)

⑤ 选择主启动程序

![选择主启动程序](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636216-1156500353.png)

⑥ 添加程序运行所需要的文件或文件夹

> 这里我们将之前有`pbl`文件编译得到的`bpd` 文件添加进去。

注意：我们这里编写的程序比较简单，所以只需要添加一个`pbd`文件。 后期随着程序功能的不断完善，程序需要的文件会非常多

建议选择跟目录文件夹，将所有文件都添加进去，再将不需要的文件`remove` 即可

![image-20230629210518964](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636199-1981238731.png)

⑦ 填写安装包信息

![安装包信息](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636220-1490394346.png)

⑧ 是否创建快捷方式

![image-20230629211330546](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636198-2044658985.png)

⑨ 添加版权信息

![版权信息](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636215-134349880.png)

⑩ 以管理员权限安装

![image-20230629211954423](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636150-1681293441.png)

⑪ 选择语言

![选择语言](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636260-254289589.png)

⑫ 编译器设置

![编译器设置](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636263-2107833582.png)

⑬ 下一步

\-- 下一步

\-- 完成

![image-20230629212929187](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636124-1352040521.png)

![image-20230629212943352](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636161-1465115483.png)

⑭ 生成编译脚本

![生成编译脚本](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636271-496531438.png)

⑮ 保存脚本

![保存脚本](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636077-76001371.png)

⑯ 编译成功

![image-20230629214428899](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636223-568897522.png)

⑰ 生成安装包，到这里安装包就制作完成了

![生成安装包信息](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636232-892680825.png)

#### 5.4 用制作好的安装包测试一下

① 双击安装包即可开始安装

> 首先展示出来的就是，我们之前填写的版权信息。但是中文会有乱码，后面文章中会写解决办法。

​ ![image-20230629215139904](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636102-415189116.png)

② 选择安装路径

![选择安装路径](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636214-51873870.png)

③ 创建桌面快捷方式

![image-20230629220448058](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636164-1213010255.png)

④ 下一步

![image-20230629220506652](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636124-1329625291.png)

⑤ 完成

![image-20230629220529657](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636266-784683979.png)

⑥ 桌面生成快捷方式

![生成快捷方式](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636209-1292347051.png)

⑦ 双击可运行

![双击运行](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636100-488358868.png)

⑧ 卸载程序

![卸载程序](https://img2023.cnblogs.com/blog/2381533/202307/2381533-20230703081636164-98569462.png)

### 六、小结

通过本篇文章，相信你已经对`pb` 开发`CS` 应用程序有了整体认识。公司开发应用程序也是这样的流程。

开发（编写代码）---> 编译发布程序---> 应用程序安装包制作

本期内容到此就结束了，这也是【`pb`从入坑到放弃】系列的开篇

希望对你有所帮助，我们下期再见。(●'◡'●)